import{n as e,t}from"./Stack-Yia4z9hu.js";import{n,t as r}from"./List-ClDpiA8c.js";import{a as i,c as a,d as o,i as s,l as c,n as l,o as u,r as d,s as f,t as p,u as m}from"./TextField-7eBCAcnM.js";import{a as h,i as g,n as _,r as v,t as y}from"./ExpandMore-C5i0TLrw.js";import{t as b}from"./Popper-D5GwGClX.js";import{t as x}from"./Chip-Cyw0-KQc.js";import{t as S}from"./MenuItem-Cl2OpX3w.js";import{a as C,i as w,n as T,o as E,r as D,t as O}from"./MusicNote-Cgb3qQ_p.js";import"./listItemTextClasses-DX5voEPr.js";import{$ as k,A,Bt as j,D as M,En as N,Et as P,Ft as ee,G as F,Gt as I,J as te,Jt as ne,Kt as L,Nt as re,O as R,Qt as z,Rt as B,Tt as ie,Ut as ae,_ as oe,_t as se,a as ce,b as le,cn as V,d as ue,en as de,et as fe,f as pe,gt as H,h as me,ht as he,it as ge,jt as _e,k as U,ln as W,lt as ve,nn as ye,nt as be,ot as G,p as xe,pn as Se,pt as Ce,q as we,s as Te,sn as Ee,st as K,tn as De,u as Oe,ut as q,v as ke,vn as J,vt as Y,wn as Ae,x as je,y as Me,yt as Ne,zt as X}from"./index-BcSftaEo.js";import{t as Pe}from"./useConfirmDialog-Bds3qU-_.js";import{t as Fe}from"./useNotification-B_lRTHle.js";import{t as Ie}from"./ServerFilePicker-DSnjNoK2.js";var Z=N(Se()),Le=B((0,Z.jsx)(`path`,{d:`M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z`}),`MoreHoriz`),Re=I(H,{name:`MuiBreadcrumbCollapsed`})(X(({theme:e})=>({display:`flex`,marginLeft:`calc(${e.spacing(1)} * 0.5)`,marginRight:`calc(${e.spacing(1)} * 0.5)`,...e.palette.mode===`light`?{backgroundColor:e.palette.grey[100],color:e.palette.grey[700]}:{backgroundColor:e.palette.grey[700],color:e.palette.grey[100]},borderRadius:2,"&:hover, &:focus":{...e.palette.mode===`light`?{backgroundColor:e.palette.grey[200]}:{backgroundColor:e.palette.grey[600]}},"&:active":{boxShadow:e.shadows[0],...e.palette.mode===`light`?{backgroundColor:ye(e.palette.grey[200],.12)}:{backgroundColor:ye(e.palette.grey[600],.12)}}}))),ze=I(Le)({width:24,height:16});function Be(e){let{slots:t={},slotProps:n={},...r}=e,i=e;return(0,Z.jsx)(`li`,{children:(0,Z.jsx)(Re,{focusRipple:!0,...r,ownerState:i,children:(0,Z.jsx)(ze,{as:t.CollapsedIcon,ownerState:i,...n.collapsedIcon})})})}var Ve=Be;function He(e){return V(`MuiBreadcrumbs`,e)}var Ue=Ee(`MuiBreadcrumbs`,[`root`,`ol`,`li`,`separator`]),Q=N(Ae()),We=e=>{let{classes:t}=e;return z({root:[`root`],li:[`li`],ol:[`ol`],separator:[`separator`]},He,t)},Ge=I(q,{name:`MuiBreadcrumbs`,slot:`Root`,overridesResolver:(e,t)=>[{[`& .${Ue.li}`]:t.li},t.root]})({}),Ke=I(`ol`,{name:`MuiBreadcrumbs`,slot:`Ol`})({display:`flex`,flexWrap:`wrap`,alignItems:`center`,padding:0,margin:0,listStyle:`none`}),qe=I(`li`,{name:`MuiBreadcrumbs`,slot:`Separator`})({display:`flex`,userSelect:`none`,marginLeft:8,marginRight:8});function Je(e,t,n,r){return e.reduce((i,a,o)=>(o<e.length-1?i=i.concat(a,(0,Z.jsx)(qe,{"aria-hidden":!0,className:t,ownerState:r,children:n},`separator-${o}`)):i.push(a),i),[])}var Ye=Q.forwardRef(function(t,n){let r=ae({props:t,name:`MuiBreadcrumbs`}),{children:i,className:a,component:o=`nav`,slots:s={},slotProps:c={},expandText:l=`Show path`,itemsAfterCollapse:u=1,itemsBeforeCollapse:d=1,maxItems:f=8,separator:p=`/`,...m}=r,[h,g]=Q.useState(!1),_={...r,component:o,expanded:h,expandText:l,itemsAfterCollapse:u,itemsBeforeCollapse:d,maxItems:f,separator:p},v=We(_),y=e({elementType:s.CollapsedIcon,externalSlotProps:c.collapsedIcon,ownerState:_}),b=Q.useRef(null),x=e=>{let t=()=>{g(!0);let e=b.current.querySelector(`a[href],button,[tabindex]`);e&&e.focus()};return d+u>=e.length?e:[...e.slice(0,d),(0,Z.jsx)(Ve,{"aria-label":l,slots:{CollapsedIcon:s.CollapsedIcon},slotProps:{collapsedIcon:y},onClick:t},`ellipsis`),...e.slice(e.length-u,e.length)]},S=Q.Children.toArray(i).filter(e=>Q.isValidElement(e)).map((e,t)=>(0,Z.jsx)(`li`,{className:v.li,children:e},`child-${t}`));return(0,Z.jsx)(Ge,{ref:n,component:o,color:`textSecondary`,className:W(v.root,a),ownerState:_,...m,children:(0,Z.jsx)(Ke,{className:v.ol,ref:b,ownerState:_,children:Je(h||f&&S.length<=f?S:x(S),v.separator,p,_)})})});function Xe(e){return V(`PrivateSwitchBase`,e)}Ee(`PrivateSwitchBase`,[`root`,`checked`,`disabled`,`input`,`edgeStart`,`edgeEnd`]);var Ze=e=>{let{classes:t,checked:n,disabled:r,edge:i}=e;return z({root:[`root`,n&&`checked`,r&&`disabled`,i&&`edge${j(i)}`],input:[`input`]},Xe,t)},Qe=I(H,{name:`MuiSwitchBase`})({padding:9,borderRadius:`50%`,variants:[{props:{edge:`start`,size:`small`},style:{marginLeft:-3}},{props:({edge:e,ownerState:t})=>e===`start`&&t.size!==`small`,style:{marginLeft:-12}},{props:{edge:`end`,size:`small`},style:{marginRight:-3}},{props:({edge:e,ownerState:t})=>e===`end`&&t.size!==`small`,style:{marginRight:-12}}]}),$e=I(`input`,{name:`MuiSwitchBase`,shouldForwardProp:L})({cursor:`inherit`,position:`absolute`,opacity:0,width:`100%`,height:`100%`,top:0,left:0,margin:0,padding:0,zIndex:1}),et=Q.forwardRef(function(e,t){let{autoFocus:n,checked:r,checkedIcon:a,defaultChecked:o,disabled:s,disableFocusRipple:c=!1,edge:l=!1,icon:u,id:d,inputProps:f,inputRef:p,name:m,onBlur:g,onChange:_,onFocus:v,readOnly:y,required:b=!1,tabIndex:x,type:S,value:C,slots:w={},slotProps:T={},...E}=e,[D,O]=h({controlled:r,default:!!o,name:`SwitchBase`,state:`checked`}),k=i(),A=e=>{v&&v(e),k&&k.onFocus&&k.onFocus(e)},j=e=>{g&&g(e),k&&k.onBlur&&k.onBlur(e)},M=e=>{if(e.nativeEvent.defaultPrevented||y)return;let t=e.target.checked;O(t),_&&_(e,t)},N=s;k&&N===void 0&&(N=k.disabled);let P=S===`checkbox`||S===`radio`,ee={...e,checked:D,disabled:N,disableFocusRipple:c,edge:l},F=Ze(ee),I={slots:w,slotProps:{input:f,...T}},[te,ne]=Ne(`root`,{ref:t,elementType:Qe,className:F.root,shouldForwardComponentProp:!0,externalForwardedProps:{...I,component:`span`,...E},getSlotProps:e=>({...e,onFocus:t=>{e.onFocus?.(t),A(t)},onBlur:t=>{e.onBlur?.(t),j(t)}}),ownerState:ee,additionalProps:{centerRipple:!0,focusRipple:!c,disabled:N,role:void 0,tabIndex:null}}),[L,re]=Ne(`input`,{ref:p,elementType:$e,className:F.input,externalForwardedProps:I,getSlotProps:e=>({...e,onChange:t=>{e.onChange?.(t),M(t)}}),ownerState:ee,additionalProps:{autoFocus:n,checked:r,defaultChecked:o,disabled:N,id:P?d:void 0,name:m,readOnly:y,required:b,tabIndex:x,type:S,...S===`checkbox`&&C===void 0?{}:{value:C}}});return(0,Z.jsxs)(te,{...ne,children:[(0,Z.jsx)(L,{...re}),D?a:u]})}),tt=B((0,Z.jsx)(`path`,{d:`M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z`}),`CheckBoxOutlineBlank`),nt=B((0,Z.jsx)(`path`,{d:`M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z`}),`CheckBox`),rt=B((0,Z.jsx)(`path`,{d:`M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z`}),`IndeterminateCheckBox`);function it(e){return V(`MuiCheckbox`,e)}var at=Ee(`MuiCheckbox`,[`root`,`checked`,`disabled`,`indeterminate`,`colorPrimary`,`colorSecondary`,`sizeSmall`,`sizeMedium`]),ot=e=>{let{classes:t,indeterminate:n,color:r,size:i}=e,a=z({root:[`root`,n&&`indeterminate`,`color${j(r)}`,`size${j(i)}`]},it,t);return{...t,...a}},st=I(et,{shouldForwardProp:e=>L(e)||e===`classes`,name:`MuiCheckbox`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.indeterminate&&t.indeterminate,t[`size${j(n.size)}`],n.color!==`default`&&t[`color${j(n.color)}`]]}})(X(({theme:e})=>({color:(e.vars||e).palette.text.secondary,variants:[{props:{color:`default`,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.action.active,(e.vars||e).palette.action.hoverOpacity)}}},...Object.entries(e.palette).filter(he()).map(([t])=>({props:{color:t,disableRipple:!1},style:{"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.hoverOpacity)}}})),...Object.entries(e.palette).filter(he()).map(([t])=>({props:{color:t},style:{[`&.${at.checked}, &.${at.indeterminate}`]:{color:(e.vars||e).palette[t].main},[`&.${at.disabled}`]:{color:(e.vars||e).palette.action.disabled}}})),{props:{disableRipple:!1},style:{"&:hover":{"@media (hover: none)":{backgroundColor:`transparent`}}}}]}))),ct=(0,Z.jsx)(nt,{}),lt=(0,Z.jsx)(tt,{}),ut=(0,Z.jsx)(rt,{}),dt=Q.forwardRef(function(e,t){let n=ae({props:e,name:`MuiCheckbox`}),{checkedIcon:r=ct,color:i=`primary`,icon:a=lt,indeterminate:o=!1,indeterminateIcon:s=ut,inputProps:c,size:l=`medium`,disableRipple:u=!1,className:d,slots:p={},slotProps:m={},...h}=n,g=o?s:a,_=o?s:r,v={...n,disableRipple:u,color:i,indeterminate:o,size:l},y=ot(v),b=m.input??c,[x,S]=Ne(`root`,{ref:t,elementType:st,className:W(y.root,d),shouldForwardComponentProp:!0,externalForwardedProps:{slots:p,slotProps:m,...h},ownerState:v,additionalProps:{type:`checkbox`,icon:Q.cloneElement(g,{fontSize:g.props.fontSize??l}),checkedIcon:Q.cloneElement(_,{fontSize:_.props.fontSize??l}),disableRipple:u,slots:p,slotProps:{input:f(typeof b==`function`?b(v):b,{"data-indeterminate":o})}}});return(0,Z.jsx)(x,{...S,classes:y})});function ft(e){return V(`MuiFormControlLabel`,e)}var pt=Ee(`MuiFormControlLabel`,[`root`,`labelPlacementStart`,`labelPlacementTop`,`labelPlacementBottom`,`disabled`,`label`,`error`,`required`,`asterisk`]),mt=e=>{let{classes:t,disabled:n,labelPlacement:r,error:i,required:a}=e;return z({root:[`root`,n&&`disabled`,`labelPlacement${j(r)}`,i&&`error`,a&&`required`],label:[`label`,n&&`disabled`],asterisk:[`asterisk`,i&&`error`]},ft,t)};const ht=I(`label`,{name:`MuiFormControlLabel`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${pt.label}`]:t.label},t.root,t[`labelPlacement${j(n.labelPlacement)}`]]}})(X(({theme:e})=>({display:`inline-flex`,alignItems:`center`,cursor:`pointer`,verticalAlign:`middle`,WebkitTapHighlightColor:`transparent`,marginLeft:-11,marginRight:16,[`&.${pt.disabled}`]:{cursor:`default`},[`& .${pt.label}`]:{[`&.${pt.disabled}`]:{color:(e.vars||e).palette.text.disabled}},variants:[{props:{labelPlacement:`start`},style:{flexDirection:`row-reverse`,marginRight:-11}},{props:{labelPlacement:`top`},style:{flexDirection:`column-reverse`}},{props:{labelPlacement:`bottom`},style:{flexDirection:`column`}},{props:({labelPlacement:e})=>e===`start`||e===`top`||e===`bottom`,style:{marginLeft:16}}]})));var gt=I(`span`,{name:`MuiFormControlLabel`,slot:`Asterisk`})(X(({theme:e})=>({[`&.${pt.error}`]:{color:(e.vars||e).palette.error.main}}))),_t=Q.forwardRef(function(e,t){let n=ae({props:e,name:`MuiFormControlLabel`}),{checked:r,className:a,componentsProps:o={},control:s,disabled:c,disableTypography:l,inputRef:d,label:f,labelPlacement:p=`end`,name:m,onChange:h,required:g,slots:_={},slotProps:v={},value:y,...b}=n,x=i(),S=c??s.props.disabled??x?.disabled,C=g??s.props.required,w={disabled:S,required:C};[`checked`,`name`,`onChange`,`value`,`inputRef`].forEach(e=>{s.props[e]===void 0&&n[e]!==void 0&&(w[e]=n[e])});let T=u({props:n,muiFormControl:x,states:[`error`]}),E={...n,disabled:S,labelPlacement:p,required:C,error:T.error},D=mt(E),[O,k]=Ne(`typography`,{elementType:q,externalForwardedProps:{slots:_,slotProps:{...o,...v}},ownerState:E}),A=f;return A!=null&&A.type!==q&&!l&&(A=(0,Z.jsx)(O,{component:`span`,...k,className:W(D.label,k?.className),children:A})),(0,Z.jsxs)(ht,{className:W(D.root,a),ownerState:E,ref:t,...b,children:[Q.cloneElement(s,w),C?(0,Z.jsxs)(`div`,{children:[A,(0,Z.jsxs)(gt,{ownerState:E,"aria-hidden":!0,className:D.asterisk,children:[`â€‰`,`*`]})]}):A]})});function vt(e){return V(`MuiLink`,e)}var yt=Ee(`MuiLink`,[`root`,`underlineNone`,`underlineHover`,`underlineAlways`,`button`,`focusVisible`]),bt=({theme:e,ownerState:t})=>{let n=t.color;if(`colorSpace`in e&&e.colorSpace){let r=J(e,`palette.${n}.main`)||J(e,`palette.${n}`)||t.color;return e.alpha(r,.4)}let r=J(e,`palette.${n}.main`,!1)||J(e,`palette.${n}`,!1)||t.color,i=J(e,`palette.${n}.mainChannel`)||J(e,`palette.${n}Channel`);return`vars`in e&&i?`rgba(${i} / 0.4)`:De(r,.4)},xt={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},St=e=>{let{classes:t,component:n,focusVisible:r,underline:i}=e;return z({root:[`root`,`underline${j(i)}`,n===`button`&&`button`,r&&`focusVisible`]},vt,t)},Ct=I(q,{name:`MuiLink`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`underline${j(n.underline)}`],n.component===`button`&&t.button]}})(X(({theme:e})=>({variants:[{props:{underline:`none`},style:{textDecoration:`none`}},{props:{underline:`hover`},style:{textDecoration:`none`,"&:hover":{textDecoration:`underline`}}},{props:{underline:`always`},style:{textDecoration:`underline`,"&:hover":{textDecorationColor:`inherit`}}},{props:({underline:e,ownerState:t})=>e===`always`&&t.color!==`inherit`,style:{textDecorationColor:`var(--Link-underlineColor)`}},{props:({underline:e,ownerState:t})=>e===`always`&&t.color===`inherit`,style:e.colorSpace?{textDecorationColor:e.alpha(`currentColor`,.4)}:null},...Object.entries(e.palette).filter(he()).map(([t])=>({props:{underline:`always`,color:t},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette[t].main,.4)}})),{props:{underline:`always`,color:`textPrimary`},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.primary,.4)}},{props:{underline:`always`,color:`textSecondary`},style:{"--Link-underlineColor":e.alpha((e.vars||e).palette.text.secondary,.4)}},{props:{underline:`always`,color:`textDisabled`},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:`button`},style:{position:`relative`,WebkitTapHighlightColor:`transparent`,backgroundColor:`transparent`,outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:`pointer`,userSelect:`none`,verticalAlign:`middle`,MozAppearance:`none`,WebkitAppearance:`none`,"&::-moz-focus-inner":{borderStyle:`none`},[`&.${yt.focusVisible}`]:{outline:`auto`}}}]}))),wt=Q.forwardRef(function(e,t){let n=ae({props:e,name:`MuiLink`}),r=ne(),{className:i,color:a=`primary`,component:o=`a`,onBlur:s,onFocus:c,TypographyClasses:l,underline:u=`always`,variant:d=`inherit`,sx:f,...p}=n,[m,h]=Q.useState(!1),g=e=>{se(e.target)||h(!1),s&&s(e)},_=e=>{se(e.target)&&h(!0),c&&c(e)},v={...n,color:a,component:o,focusVisible:m,underline:u,variant:d};return(0,Z.jsx)(Ct,{color:a,className:W(St(v).root,i),classes:l,component:o,onBlur:g,onFocus:_,ref:t,ownerState:v,variant:d,...p,sx:[...xt[a]===void 0?[{color:a}]:[],...Array.isArray(f)?f:[f]],style:{...p.style,...u===`always`&&a!==`inherit`&&!xt[a]&&{"--Link-underlineColor":bt({theme:r,ownerState:v})}}})});const Tt=(e,t)=>{let{ownerState:n}=e;return[t.root,n.dense&&t.dense,n.alignItems===`flex-start`&&t.alignItemsFlexStart,n.divider&&t.divider,!n.disableGutters&&t.gutters]};var Et=e=>{let{alignItems:t,classes:n,dense:r,disabled:i,disableGutters:a,divider:o,selected:s}=e,c=z({root:[`root`,r&&`dense`,!a&&`gutters`,o&&`divider`,i&&`disabled`,t===`flex-start`&&`alignItemsFlexStart`,s&&`selected`]},C,n);return{...n,...c}},Dt=I(H,{shouldForwardProp:e=>L(e)||e===`classes`,name:`MuiListItemButton`,slot:`Root`,overridesResolver:Tt})(X(({theme:e})=>({display:`flex`,flexGrow:1,justifyContent:`flex-start`,alignItems:`center`,position:`relative`,textDecoration:`none`,minWidth:0,boxSizing:`border-box`,textAlign:`left`,paddingTop:8,paddingBottom:8,transition:e.transitions.create(`background-color`,{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:`none`,backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},[`&.${E.selected}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${E.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}},[`&.${E.selected}:hover`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity)}},[`&.${E.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${E.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity},variants:[{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:`padding-box`}},{props:{alignItems:`flex-start`},style:{alignItems:`flex-start`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.dense,style:{paddingTop:4,paddingBottom:4}}]}))),Ot=Q.forwardRef(function(e,t){let r=ae({props:e,name:`MuiListItemButton`}),{alignItems:i=`center`,autoFocus:o=!1,component:s=`div`,children:c,dense:l=!1,disableGutters:u=!1,divider:d=!1,focusVisibleClassName:f,selected:p=!1,className:m,...h}=r,g=Q.useContext(n),_=Q.useMemo(()=>({dense:l||g.dense||!1,alignItems:i,disableGutters:u}),[i,g.dense,l,u]),v=Q.useRef(null);a(()=>{o&&v.current&&v.current.focus()},[o]);let y={...r,alignItems:i,dense:_.dense,disableGutters:u,divider:d,selected:p},b=Et(y),x=_e(v,t);return(0,Z.jsx)(n.Provider,{value:_,children:(0,Z.jsx)(Dt,{ref:x,href:h.href||h.to,component:(h.href||h.to)&&s===`div`?`button`:s,focusVisibleClassName:W(b.focusVisible,f),ownerState:y,className:W(b.root,m),...h,classes:b,children:c})})});function kt(e){return V(`MuiTooltip`,e)}var $=Ee(`MuiTooltip`,[`popper`,`popperInteractive`,`popperArrow`,`popperClose`,`tooltip`,`tooltipArrow`,`touch`,`tooltipPlacementLeft`,`tooltipPlacementRight`,`tooltipPlacementTop`,`tooltipPlacementBottom`,`arrow`]);function At(e){return Math.round(e*1e5)/1e5}var jt=e=>{let{classes:t,disableInteractive:n,arrow:r,touch:i,placement:a}=e;return z({popper:[`popper`,!n&&`popperInteractive`,r&&`popperArrow`],tooltip:[`tooltip`,r&&`tooltipArrow`,i&&`touch`,`tooltipPlacement${j(a.split(`-`)[0])}`],arrow:[`arrow`]},kt,t)},Mt=I(b,{name:`MuiTooltip`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popper,!n.disableInteractive&&t.popperInteractive,n.arrow&&t.popperArrow,!n.open&&t.popperClose]}})(X(({theme:e})=>({zIndex:(e.vars||e).zIndex.tooltip,pointerEvents:`none`,variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:`auto`}},{props:({open:e})=>!e,style:{pointerEvents:`none`}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${$.arrow}`]:{top:0,marginTop:`-0.71em`,"&::before":{transformOrigin:`0 100%`}},[`&[data-popper-placement*="top"] .${$.arrow}`]:{bottom:0,marginBottom:`-0.71em`,"&::before":{transformOrigin:`100% 0`}},[`&[data-popper-placement*="right"] .${$.arrow}`]:{height:`1em`,width:`0.71em`,"&::before":{transformOrigin:`100% 100%`}},[`&[data-popper-placement*="left"] .${$.arrow}`]:{height:`1em`,width:`0.71em`,"&::before":{transformOrigin:`0 0`}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${$.arrow}`]:{left:0,marginLeft:`-0.71em`}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${$.arrow}`]:{right:0,marginRight:`-0.71em`}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${$.arrow}`]:{right:0,marginRight:`-0.71em`}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${$.arrow}`]:{left:0,marginLeft:`-0.71em`}}}]}))),Nt=I(`div`,{name:`MuiTooltip`,slot:`Tooltip`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.tooltip,n.touch&&t.touch,n.arrow&&t.tooltipArrow,t[`tooltipPlacement${j(n.placement.split(`-`)[0])}`]]}})(X(({theme:e})=>({backgroundColor:e.vars?e.vars.palette.Tooltip.bg:e.alpha(e.palette.grey[700],.92),borderRadius:(e.vars||e).shape.borderRadius,color:(e.vars||e).palette.common.white,fontFamily:e.typography.fontFamily,padding:`4px 8px`,fontSize:e.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:`break-word`,fontWeight:e.typography.fontWeightMedium,[`.${$.popper}[data-popper-placement*="left"] &`]:{transformOrigin:`right center`},[`.${$.popper}[data-popper-placement*="right"] &`]:{transformOrigin:`left center`},[`.${$.popper}[data-popper-placement*="top"] &`]:{transformOrigin:`center bottom`,marginBottom:`14px`},[`.${$.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:`center top`,marginTop:`14px`},variants:[{props:({ownerState:e})=>e.arrow,style:{position:`relative`,margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:`8px 16px`,fontSize:e.typography.pxToRem(14),lineHeight:`${At(16/14)}em`,fontWeight:e.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${$.popper}[data-popper-placement*="left"] &`]:{marginRight:`14px`},[`.${$.popper}[data-popper-placement*="right"] &`]:{marginLeft:`14px`}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${$.popper}[data-popper-placement*="left"] &`]:{marginRight:`24px`},[`.${$.popper}[data-popper-placement*="right"] &`]:{marginLeft:`24px`}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${$.popper}[data-popper-placement*="left"] &`]:{marginLeft:`14px`},[`.${$.popper}[data-popper-placement*="right"] &`]:{marginRight:`14px`}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${$.popper}[data-popper-placement*="left"] &`]:{marginLeft:`24px`},[`.${$.popper}[data-popper-placement*="right"] &`]:{marginRight:`24px`}}},{props:({ownerState:e})=>e.touch,style:{[`.${$.popper}[data-popper-placement*="top"] &`]:{marginBottom:`24px`}}},{props:({ownerState:e})=>e.touch,style:{[`.${$.popper}[data-popper-placement*="bottom"] &`]:{marginTop:`24px`}}}]}))),Pt=I(`span`,{name:`MuiTooltip`,slot:`Arrow`})(X(({theme:e})=>({overflow:`hidden`,position:`absolute`,width:`1em`,height:`0.71em`,boxSizing:`border-box`,color:e.vars?e.vars.palette.Tooltip.bg:e.alpha(e.palette.grey[700],.9),"&::before":{content:`""`,margin:`auto`,display:`block`,width:`100%`,height:`100%`,backgroundColor:`currentColor`,transform:`rotate(45deg)`}}))),Ft=!1,It=new ie,Lt={x:0,y:0};function Rt(e,t){return(n,...r)=>{t&&t(n,...r),e(n,...r)}}var zt=Q.forwardRef(function(e,t){let n=ae({props:e,name:`MuiTooltip`}),{arrow:r=!1,children:i,classes:a,components:o={},componentsProps:s={},describeChild:c=!1,disableFocusListener:l=!1,disableHoverListener:u=!1,disableInteractive:d=!1,disableTouchListener:f=!1,enterDelay:p=100,enterNextDelay:m=0,enterTouchDelay:g=700,followCursor:_=!1,id:v,leaveDelay:y=0,leaveTouchDelay:x=1500,onClose:S,onOpen:C,open:w,placement:T=`bottom`,PopperComponent:E,PopperProps:D={},slotProps:O={},slots:k={},title:A,TransitionComponent:j,TransitionProps:M,...N}=n,F=Q.isValidElement(i)?i:(0,Z.jsx)(`span`,{children:i}),I=ne(),te=de(),[L,R]=Q.useState(),[z,B]=Q.useState(null),ie=Q.useRef(!1),oe=d||_,ce=P(),le=P(),V=P(),ue=P(),[fe,pe]=h({controlled:w,default:!1,name:`Tooltip`,state:`open`}),H=fe,me=ee(v),he=Q.useRef(),ge=re(()=>{he.current!==void 0&&(document.body.style.WebkitUserSelect=he.current,he.current=void 0),ue.clear()});Q.useEffect(()=>ge,[ge]);let U=e=>{It.clear(),Ft=!0,pe(!0),C&&!H&&C(e)},ye=re(e=>{It.start(800+y,()=>{Ft=!1}),pe(!1),S&&H&&S(e),ce.start(I.transitions.duration.shortest,()=>{ie.current=!1})}),G=e=>{ie.current&&e.type!==`touchstart`||(L&&L.removeAttribute(`title`),le.clear(),V.clear(),p||Ft&&m?le.start(Ft?m:p,()=>{U(e)}):U(e))},xe=e=>{le.clear(),V.start(y,()=>{ye(e)})},[,Se]=Q.useState(!1),Ce=e=>{se(e.target)||(Se(!1),xe(e))},we=e=>{L||R(e.currentTarget),se(e.target)&&(Se(!0),G(e))},Te=e=>{ie.current=!0;let t=F.props;t.onTouchStart&&t.onTouchStart(e)},Ee=e=>{Te(e),V.clear(),ce.clear(),ge(),he.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect=`none`,ue.start(g,()=>{document.body.style.WebkitUserSelect=he.current,G(e)})},K=e=>{F.props.onTouchEnd&&F.props.onTouchEnd(e),ge(),V.start(x,()=>{ye(e)})};Q.useEffect(()=>{if(!H)return;function e(e){e.key===`Escape`&&ye(e)}return document.addEventListener(`keydown`,e),()=>{document.removeEventListener(`keydown`,e)}},[ye,H]);let De=_e(ve(F),R,t);!A&&A!==0&&(H=!1);let Oe=Q.useRef(),q=e=>{let t=F.props;t.onMouseMove&&t.onMouseMove(e),Lt={x:e.clientX,y:e.clientY},Oe.current&&Oe.current.update()},ke={},J=typeof A==`string`;c?(ke.title=!H&&J&&!u?A:null,ke[`aria-describedby`]=H?me:null):(ke[`aria-label`]=J?A:null,ke[`aria-labelledby`]=H&&!J?me:null);let Y={...ke,...N,...F.props,className:W(N.className,F.props.className),onTouchStart:Te,ref:De,..._?{onMouseMove:q}:{}},Ae={};f||(Y.onTouchStart=Ee,Y.onTouchEnd=K),u||(Y.onMouseOver=Rt(G,Y.onMouseOver),Y.onMouseLeave=Rt(xe,Y.onMouseLeave),oe||(Ae.onMouseOver=G,Ae.onMouseLeave=xe)),l||(Y.onFocus=Rt(we,Y.onFocus),Y.onBlur=Rt(Ce,Y.onBlur),oe||(Ae.onFocus=we,Ae.onBlur=Ce));let je={...n,isRtl:te,arrow:r,disableInteractive:oe,placement:T,PopperComponentProp:E,touch:ie.current},Me=typeof O.popper==`function`?O.popper(je):O.popper,X=Q.useMemo(()=>{let e=[{name:`arrow`,enabled:!!z,options:{element:z,padding:4}}];return D.popperOptions?.modifiers&&(e=e.concat(D.popperOptions.modifiers)),Me?.popperOptions?.modifiers&&(e=e.concat(Me.popperOptions.modifiers)),{...D.popperOptions,...Me?.popperOptions,modifiers:e}},[z,D.popperOptions,Me?.popperOptions]),Pe=jt(je),Fe=typeof O.transition==`function`?O.transition(je):O.transition,Ie={slots:{popper:o.Popper,transition:o.Transition??j,tooltip:o.Tooltip,arrow:o.Arrow,...k},slotProps:{arrow:O.arrow??s.arrow,popper:{...D,...Me??s.popper},tooltip:O.tooltip??s.tooltip,transition:{...M,...Fe??s.transition}}},[Le,Re]=Ne(`popper`,{elementType:Mt,externalForwardedProps:Ie,ownerState:je,className:W(Pe.popper,D?.className)}),[ze,Be]=Ne(`transition`,{elementType:be,externalForwardedProps:Ie,ownerState:je}),[Ve,He]=Ne(`tooltip`,{elementType:Nt,className:Pe.tooltip,externalForwardedProps:Ie,ownerState:je}),[Ue,We]=Ne(`arrow`,{elementType:Pt,className:Pe.arrow,externalForwardedProps:Ie,ownerState:je,ref:B});return(0,Z.jsxs)(Q.Fragment,{children:[Q.cloneElement(F,Y),(0,Z.jsx)(Le,{as:E??b,placement:T,anchorEl:_?{getBoundingClientRect:()=>({top:Lt.y,left:Lt.x,right:Lt.x,bottom:Lt.y,width:0,height:0})}:L,popperRef:Oe,open:L?H:!1,id:me,transition:!0,...Ae,...Re,popperOptions:X,children:({TransitionProps:e})=>(0,Z.jsx)(ze,{timeout:I.transitions.duration.shorter,...e,...Be,children:(0,Z.jsxs)(Ve,{...He,children:[A,r?(0,Z.jsx)(Ue,{...We}):null]})})})]})});function Bt(e){return V(`MuiTab`,e)}var Vt=Ee(`MuiTab`,[`root`,`labelIcon`,`textColorInherit`,`textColorPrimary`,`textColorSecondary`,`selected`,`disabled`,`fullWidth`,`wrapped`,`iconWrapper`,`icon`]),Ht=e=>{let{classes:t,textColor:n,fullWidth:r,wrapped:i,icon:a,label:o,selected:s,disabled:c}=e;return z({root:[`root`,a&&o&&`labelIcon`,`textColor${j(n)}`,r&&`fullWidth`,i&&`wrapped`,s&&`selected`,c&&`disabled`],icon:[`iconWrapper`,`icon`]},Bt,t)},Ut=I(H,{name:`MuiTab`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.label&&n.icon&&t.labelIcon,t[`textColor${j(n.textColor)}`],n.fullWidth&&t.fullWidth,n.wrapped&&t.wrapped,{[`& .${Vt.iconWrapper}`]:t.iconWrapper},{[`& .${Vt.icon}`]:t.icon}]}})(X(({theme:e})=>({...e.typography.button,maxWidth:360,minWidth:90,position:`relative`,minHeight:48,flexShrink:0,padding:`12px 16px`,overflow:`hidden`,whiteSpace:`normal`,textAlign:`center`,lineHeight:1.25,variants:[{props:({ownerState:e})=>e.label&&(e.iconPosition===`top`||e.iconPosition===`bottom`),style:{flexDirection:`column`}},{props:({ownerState:e})=>e.label&&e.iconPosition!==`top`&&e.iconPosition!==`bottom`,style:{flexDirection:`row`}},{props:({ownerState:e})=>e.icon&&e.label,style:{minHeight:72,paddingTop:9,paddingBottom:9}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t===`top`,style:{[`& > .${Vt.icon}`]:{marginBottom:6}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t===`bottom`,style:{[`& > .${Vt.icon}`]:{marginTop:6}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t===`start`,style:{[`& > .${Vt.icon}`]:{marginRight:e.spacing(1)}}},{props:({ownerState:e,iconPosition:t})=>e.icon&&e.label&&t===`end`,style:{[`& > .${Vt.icon}`]:{marginLeft:e.spacing(1)}}},{props:{textColor:`inherit`},style:{color:`inherit`,opacity:.6,[`&.${Vt.selected}`]:{opacity:1},[`&.${Vt.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}}},{props:{textColor:`primary`},style:{color:(e.vars||e).palette.text.secondary,[`&.${Vt.selected}`]:{color:(e.vars||e).palette.primary.main},[`&.${Vt.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:{textColor:`secondary`},style:{color:(e.vars||e).palette.text.secondary,[`&.${Vt.selected}`]:{color:(e.vars||e).palette.secondary.main},[`&.${Vt.disabled}`]:{color:(e.vars||e).palette.text.disabled}}},{props:({ownerState:e})=>e.fullWidth,style:{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:`none`}},{props:({ownerState:e})=>e.wrapped,style:{fontSize:e.typography.pxToRem(12)}}]}))),Wt=Q.forwardRef(function(e,t){let n=ae({props:e,name:`MuiTab`}),{className:r,disabled:i=!1,disableFocusRipple:a=!1,fullWidth:o,icon:s,iconPosition:c=`top`,indicator:l,label:u,onChange:d,onClick:f,onFocus:p,selected:m,selectionFollowsFocus:h,textColor:g=`inherit`,value:_,wrapped:v=!1,...y}=n,b={...n,disabled:i,disableFocusRipple:a,selected:m,icon:!!s,iconPosition:c,label:!!u,fullWidth:o,textColor:g,wrapped:v},x=Ht(b),S=s&&u&&Q.isValidElement(s)?Q.cloneElement(s,{className:W(x.icon,s.props.className)}):s,C=e=>{!m&&d&&d(e,_),f&&f(e)},w=e=>{h&&!m&&d&&d(e,_),p&&p(e)};return(0,Z.jsxs)(Ut,{focusRipple:!a,className:W(x.root,r),ref:t,role:`tab`,"aria-selected":m,disabled:i,onClick:C,onFocus:w,ownerState:b,tabIndex:m?0:-1,...y,children:[c===`top`||c===`start`?(0,Z.jsxs)(Q.Fragment,{children:[S,u]}):(0,Z.jsxs)(Q.Fragment,{children:[u,S]}),l]})}),Gt=B((0,Z.jsx)(`path`,{d:`M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z`}),`KeyboardArrowLeft`),Kt=B((0,Z.jsx)(`path`,{d:`M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z`}),`KeyboardArrowRight`);function qt(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function Jt(e,t,n,r={},i=()=>{}){let{ease:a=qt,duration:o=300}=r,s=null,c=t[e],l=!1,u=()=>{l=!0},d=r=>{if(l){i(Error(`Animation cancelled`));return}s===null&&(s=r);let u=Math.min(1,(r-s)/o);if(t[e]=a(u)*(n-c)+c,u>=1){requestAnimationFrame(()=>{i(null)});return}requestAnimationFrame(d)};return c===n?(i(Error(`Element already at target position`)),u):(requestAnimationFrame(d),u)}var Yt={width:99,height:99,position:`absolute`,top:-9999,overflow:`scroll`};function Xt(e){let{onChange:t,...n}=e,r=Q.useRef(),i=Q.useRef(null),s=()=>{r.current=i.current.offsetHeight-i.current.clientHeight};return a(()=>{let e=o(()=>{let e=r.current;s(),e!==r.current&&t(r.current)}),n=c(i.current);return n.addEventListener(`resize`,e),()=>{e.clear(),n.removeEventListener(`resize`,e)}},[t]),Q.useEffect(()=>{s(),t(r.current)},[t]),(0,Z.jsx)(`div`,{style:Yt,...n,ref:i})}function Zt(e){return V(`MuiTabScrollButton`,e)}var Qt=Ee(`MuiTabScrollButton`,[`root`,`vertical`,`horizontal`,`disabled`]),$t=e=>{let{classes:t,orientation:n,disabled:r}=e;return z({root:[`root`,n,r&&`disabled`]},Zt,t)},en=I(H,{name:`MuiTabScrollButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.orientation&&t[n.orientation]]}})({width:40,flexShrink:0,opacity:.8,[`&.${Qt.disabled}`]:{opacity:0},variants:[{props:{orientation:`vertical`},style:{width:`100%`,height:40,"& svg":{transform:`var(--TabScrollButton-svgRotate)`}}}]}),tn=Q.forwardRef(function(t,n){let r=ae({props:t,name:`MuiTabScrollButton`}),{className:i,slots:a={},slotProps:o={},direction:s,orientation:c,disabled:l,...u}=r,d=de(),f={isRtl:d,...r},p=$t(f),m=a.StartScrollButtonIcon??Gt,h=a.EndScrollButtonIcon??Kt,g=e({elementType:m,externalSlotProps:o.startScrollButtonIcon,additionalProps:{fontSize:`small`},ownerState:f}),_=e({elementType:h,externalSlotProps:o.endScrollButtonIcon,additionalProps:{fontSize:`small`},ownerState:f});return(0,Z.jsx)(en,{component:`div`,className:W(p.root,i),ref:n,role:null,ownerState:f,tabIndex:null,...u,style:{...u.style,...c===`vertical`&&{"--TabScrollButton-svgRotate":`rotate(${d?-90:90}deg)`}},children:s===`left`?(0,Z.jsx)(m,{...g}):(0,Z.jsx)(h,{..._})})});function nn(e){return V(`MuiTabs`,e)}var rn=Ee(`MuiTabs`,[`root`,`vertical`,`list`,`flexContainer`,`flexContainerVertical`,`centered`,`scroller`,`fixed`,`scrollableX`,`scrollableY`,`hideScrollbar`,`scrollButtons`,`scrollButtonsHideMobile`,`indicator`]),an=(e,t)=>e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild,on=(e,t)=>e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild,sn=(e,t,n)=>{let r=!1,i=n(e,t);for(;i;){if(i===e.firstChild){if(r)return;r=!0}let t=i.disabled||i.getAttribute(`aria-disabled`)===`true`;if(!i.hasAttribute(`tabindex`)||t)i=n(e,i);else{i.focus();return}}},cn=e=>{let{vertical:t,fixed:n,hideScrollbar:r,scrollableX:i,scrollableY:a,centered:o,scrollButtonsHideMobile:s,classes:c}=e;return z({root:[`root`,t&&`vertical`],scroller:[`scroller`,n&&`fixed`,r&&`hideScrollbar`,i&&`scrollableX`,a&&`scrollableY`],list:[`list`,`flexContainer`,t&&`flexContainerVertical`,t&&`vertical`,o&&`centered`],indicator:[`indicator`],scrollButtons:[`scrollButtons`,s&&`scrollButtonsHideMobile`],scrollableX:[i&&`scrollableX`],hideScrollbar:[r&&`hideScrollbar`]},nn,c)},ln=I(`div`,{name:`MuiTabs`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${rn.scrollButtons}`]:t.scrollButtons},{[`& .${rn.scrollButtons}`]:n.scrollButtonsHideMobile&&t.scrollButtonsHideMobile},t.root,n.vertical&&t.vertical]}})(X(({theme:e})=>({overflow:`hidden`,minHeight:48,WebkitOverflowScrolling:`touch`,display:`flex`,variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:`column`}},{props:({ownerState:e})=>e.scrollButtonsHideMobile,style:{[`& .${rn.scrollButtons}`]:{[e.breakpoints.down(`sm`)]:{display:`none`}}}}]}))),un=I(`div`,{name:`MuiTabs`,slot:`Scroller`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.scroller,n.fixed&&t.fixed,n.hideScrollbar&&t.hideScrollbar,n.scrollableX&&t.scrollableX,n.scrollableY&&t.scrollableY]}})({position:`relative`,display:`inline-block`,flex:`1 1 auto`,whiteSpace:`nowrap`,variants:[{props:({ownerState:e})=>e.fixed,style:{overflowX:`hidden`,width:`100%`}},{props:({ownerState:e})=>e.hideScrollbar,style:{scrollbarWidth:`none`,"&::-webkit-scrollbar":{display:`none`}}},{props:({ownerState:e})=>e.scrollableX,style:{overflowX:`auto`,overflowY:`hidden`}},{props:({ownerState:e})=>e.scrollableY,style:{overflowY:`auto`,overflowX:`hidden`}}]}),dn=I(`div`,{name:`MuiTabs`,slot:`List`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.list,t.flexContainer,n.vertical&&t.flexContainerVertical,n.centered&&t.centered]}})({display:`flex`,variants:[{props:({ownerState:e})=>e.vertical,style:{flexDirection:`column`}},{props:({ownerState:e})=>e.centered,style:{justifyContent:`center`}}]}),fn=I(`span`,{name:`MuiTabs`,slot:`Indicator`})(X(({theme:e})=>({position:`absolute`,height:2,bottom:0,width:`100%`,transition:e.transitions.create(),variants:[{props:{indicatorColor:`primary`},style:{backgroundColor:(e.vars||e).palette.primary.main}},{props:{indicatorColor:`secondary`},style:{backgroundColor:(e.vars||e).palette.secondary.main}},{props:({ownerState:e})=>e.vertical,style:{height:`100%`,width:2,right:0}}]}))),pn=I(Xt)({overflowX:`auto`,overflowY:`hidden`,scrollbarWidth:`none`,"&::-webkit-scrollbar":{display:`none`}}),mn={},hn=Q.forwardRef(function(t,n){let r=ae({props:t,name:`MuiTabs`}),i=ne(),a=de(),{"aria-label":s,"aria-labelledby":l,action:u,centered:d=!1,children:f,className:p,component:h=`div`,allowScrollButtonsMobile:g=!1,indicatorColor:_=`primary`,onChange:v,orientation:y=`horizontal`,ScrollButtonComponent:b,scrollButtons:x=`auto`,selectionFollowsFocus:S,slots:C={},slotProps:w={},TabIndicatorProps:T={},TabScrollButtonProps:E={},textColor:D=`primary`,value:O,variant:k=`standard`,visibleScrollbar:A=!1,...j}=r,M=k===`scrollable`,N=y===`vertical`,P=N?`scrollTop`:`scrollLeft`,ee=N?`top`:`left`,F=N?`bottom`:`right`,I=N?`clientHeight`:`clientWidth`,te=N?`height`:`width`,L={...r,component:h,allowScrollButtonsMobile:g,indicatorColor:_,orientation:y,vertical:N,scrollButtons:x,textColor:D,variant:k,visibleScrollbar:A,fixed:!M,hideScrollbar:M&&!A,scrollableX:M&&!N,scrollableY:M&&N,centered:d&&!M,scrollButtonsHideMobile:!g},R=cn(L),z=e({elementType:C.StartScrollButtonIcon,externalSlotProps:w.startScrollButtonIcon,ownerState:L}),B=e({elementType:C.EndScrollButtonIcon,externalSlotProps:w.endScrollButtonIcon,ownerState:L}),[ie,oe]=Q.useState(!1),[se,ce]=Q.useState(mn),[le,V]=Q.useState(!1),[ue,fe]=Q.useState(!1),[pe,H]=Q.useState(!1),[me,he]=Q.useState({overflow:`hidden`,scrollbarWidth:0}),_e=new Map,U=Q.useRef(null),ve=Q.useRef(null),ye={slots:C,slotProps:{indicator:T,scrollButtons:E,...w}},be=()=>{let e=U.current,t;if(e){let n=e.getBoundingClientRect();t={clientWidth:e.clientWidth,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollWidth:e.scrollWidth,top:n.top,bottom:n.bottom,left:n.left,right:n.right}}let n;if(e&&O!==!1){let e=ve.current.children;if(e.length>0){let t=e[_e.get(O)];n=t?t.getBoundingClientRect():null}}return{tabsMeta:t,tabMeta:n}},G=re(()=>{let{tabsMeta:e,tabMeta:t}=be(),n=0,r;N?(r=`top`,t&&e&&(n=t.top-e.top+e.scrollTop)):(r=a?`right`:`left`,t&&e&&(n=(a?-1:1)*(t[r]-e[r]+e.scrollLeft)));let i={[r]:n,[te]:t?t[te]:0};if(typeof se[r]!=`number`||typeof se[te]!=`number`)ce(i);else{let e=Math.abs(se[r]-i[r]),t=Math.abs(se[te]-i[te]);(e>=1||t>=1)&&ce(i)}}),xe=(e,{animation:t=!0}={})=>{t?Jt(P,U.current,e,{duration:i.transitions.duration.standard}):U.current[P]=e},Se=e=>{let t=U.current[P];N?t+=e:t+=e*(a?-1:1),xe(t)},Ce=()=>{let e=U.current[I],t=0,n=Array.from(ve.current.children);for(let r=0;r<n.length;r+=1){let i=n[r];if(t+i[I]>e){r===0&&(t=e);break}t+=i[I]}return t},we=()=>{Se(-1*Ce())},Te=()=>{Se(Ce())},[Ee,{onChange:K,...De}]=Ne(`scrollbar`,{className:W(R.scrollableX,R.hideScrollbar),elementType:pn,shouldForwardComponentProp:!0,externalForwardedProps:ye,ownerState:L}),Oe=Q.useCallback(e=>{K?.(e),he({overflow:null,scrollbarWidth:e})},[K]),[q,ke]=Ne(`scrollButtons`,{className:W(R.scrollButtons,E.className),elementType:tn,externalForwardedProps:ye,ownerState:L,additionalProps:{orientation:y,slots:{StartScrollButtonIcon:C.startScrollButtonIcon||C.StartScrollButtonIcon,EndScrollButtonIcon:C.endScrollButtonIcon||C.EndScrollButtonIcon},slotProps:{startScrollButtonIcon:z,endScrollButtonIcon:B}}}),J=()=>{let e={};e.scrollbarSizeListener=M?(0,Z.jsx)(Ee,{...De,onChange:Oe}):null;let t=M&&(x===`auto`&&(le||ue)||x===!0);return e.scrollButtonStart=t?(0,Z.jsx)(q,{direction:a?`right`:`left`,onClick:we,disabled:!le,...ke}):null,e.scrollButtonEnd=t?(0,Z.jsx)(q,{direction:a?`left`:`right`,onClick:Te,disabled:!ue,...ke}):null,e},Y=re(e=>{let{tabsMeta:t,tabMeta:n}=be();!n||!t||(n[ee]<t[ee]?xe(t[P]+(n[ee]-t[ee]),{animation:e}):n[F]>t[F]&&xe(t[P]+(n[F]-t[F]),{animation:e}))}),Ae=re(()=>{M&&x!==!1&&H(!pe)});Q.useEffect(()=>{let e=o(()=>{U.current&&G()}),t,n=n=>{n.forEach(e=>{e.removedNodes.forEach(e=>{t?.unobserve(e)}),e.addedNodes.forEach(e=>{t?.observe(e)})}),e(),Ae()},r=c(U.current);r.addEventListener(`resize`,e);let i;return typeof ResizeObserver<`u`&&(t=new ResizeObserver(e),Array.from(ve.current.children).forEach(e=>{t.observe(e)})),typeof MutationObserver<`u`&&(i=new MutationObserver(n),i.observe(ve.current,{childList:!0})),()=>{e.clear(),r.removeEventListener(`resize`,e),i?.disconnect(),t?.disconnect()}},[G,Ae]),Q.useEffect(()=>{let e=Array.from(ve.current.children),t=e.length;if(typeof IntersectionObserver<`u`&&t>0&&M&&x!==!1){let n=e[0],r=e[t-1],i={root:U.current,threshold:.99},a=new IntersectionObserver(e=>{V(!e[0].isIntersecting)},i);a.observe(n);let o=new IntersectionObserver(e=>{fe(!e[0].isIntersecting)},i);return o.observe(r),()=>{a.disconnect(),o.disconnect()}}},[M,x,pe,f?.length]),Q.useEffect(()=>{oe(!0)},[]),Q.useEffect(()=>{G()}),Q.useEffect(()=>{Y(mn!==se)},[Y,se]),Q.useImperativeHandle(u,()=>({updateIndicator:G,updateScrollButtons:Ae}),[G,Ae]);let[je,Me]=Ne(`indicator`,{className:W(R.indicator,T.className),elementType:fn,externalForwardedProps:ye,ownerState:L,additionalProps:{style:se}}),X=(0,Z.jsx)(je,{...Me}),Pe=0,Fe=Q.Children.map(f,e=>{if(!Q.isValidElement(e))return null;let t=e.props.value===void 0?Pe:e.props.value;_e.set(t,Pe);let n=t===O;return Pe+=1,Q.cloneElement(e,{fullWidth:k===`fullWidth`,indicator:n&&!ie&&X,selected:n,selectionFollowsFocus:S,onChange:v,textColor:D,value:t,...Pe===1&&O===!1&&!e.props.tabIndex?{tabIndex:0}:{}})}),Ie=e=>{if(e.altKey||e.shiftKey||e.ctrlKey||e.metaKey)return;let t=ve.current,n=ge(m(t));if(n?.getAttribute(`role`)!==`tab`)return;let r=y===`horizontal`?`ArrowLeft`:`ArrowUp`,i=y===`horizontal`?`ArrowRight`:`ArrowDown`;switch(y===`horizontal`&&a&&(r=`ArrowRight`,i=`ArrowLeft`),e.key){case r:e.preventDefault(),sn(t,n,on);break;case i:e.preventDefault(),sn(t,n,an);break;case`Home`:e.preventDefault(),sn(t,null,an);break;case`End`:e.preventDefault(),sn(t,null,on);break;default:break}},Le=J(),[Re,ze]=Ne(`root`,{ref:n,className:W(R.root,p),elementType:ln,externalForwardedProps:{...ye,...j,component:h},ownerState:L}),[Be,Ve]=Ne(`scroller`,{ref:U,className:R.scroller,elementType:un,externalForwardedProps:ye,ownerState:L,additionalProps:{style:{overflow:me.overflow,[N?`margin${a?`Left`:`Right`}`:`marginBottom`]:A?void 0:-me.scrollbarWidth}}}),[He,Ue]=Ne(`list`,{ref:ve,className:W(R.list,R.flexContainer),elementType:dn,externalForwardedProps:ye,ownerState:L,getSlotProps:e=>({...e,onKeyDown:t=>{Ie(t),e.onKeyDown?.(t)}})});return(0,Z.jsxs)(Re,{...ze,children:[Le.scrollButtonStart,Le.scrollbarSizeListener,(0,Z.jsxs)(Be,{...Ve,children:[(0,Z.jsx)(He,{"aria-label":s,"aria-labelledby":l,"aria-orientation":y===`vertical`?`vertical`:null,role:`tablist`,...Ue,children:Fe}),ie&&X]}),Le.scrollButtonEnd]})}),gn=B((0,Z.jsx)(`path`,{d:`m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z`}),`ArrowForward`),_n=B((0,Z.jsx)(`path`,{d:`M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 11h-3v3.75c0 1.24-1.01 2.25-2.25 2.25S8.5 17.99 8.5 16.75s1.01-2.25 2.25-2.25c.46 0 .89.14 1.25.38V11h4zm-3-4V3.5L18.5 9z`}),`AudioFile`),vn=B((0,Z.jsx)(`path`,{d:`M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z`}),`ChevronRight`),yn=B((0,Z.jsx)(`path`,{d:`M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z`}),`Label`),bn=B((0,Z.jsx)(`path`,{d:`M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4`}),`Person`),xn=B((0,Z.jsx)(`path`,{d:`M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14`}),`Search`);function Sn(){let{showSuccess:e}=Fe(),{confirm:n,isOpen:r,options:i,handleConfirm:a,handleCancel:o}=Pe(),[c,u]=(0,Q.useState)([]),[f,m]=(0,Q.useState)(!0),[h,g]=(0,Q.useState)(null),[_,v]=(0,Q.useState)(!1),[y,b]=(0,Q.useState)(null),[C,w]=(0,Q.useState)(null),[T,E]=(0,Q.useState)(null),[D,O]=(0,Q.useState)(``),[A,j]=(0,Q.useState)(``),[N,P]=(0,Q.useState)(!0),[ee,I]=(0,Q.useState)(`off`),[te,ne]=(0,Q.useState)(`full`),[L,re]=(0,Q.useState)(!1),[R,z]=(0,Q.useState)(null),[B,ie]=(0,Q.useState)({}),[ae,se]=(0,Q.useState)(`full`),V=(0,Q.useCallback)(async()=>{try{m(!0),g(null),u(await oe())}catch(e){g(e instanceof Error?e.message:`Failed to load libraries`),console.error(`[LibraryManagement] Load error:`,e)}finally{m(!1)}},[]),ue=(0,Q.useCallback)(async()=>{try{let e=await oe();u(t=>{if(t.length!==e.length)return e;let n=new Map(e.map(e=>[e.library_id,e])),r=!1;for(let e of t){let t=n.get(e.library_id);if(!t){r=!0;break}if(e.scanStatus!==t.scanStatus||e.scanProgress!==t.scanProgress||e.scanTotal!==t.scanTotal||e.scanError!==t.scanError||e.scannedAt!==t.scannedAt||e.fileCount!==t.fileCount||e.folderCount!==t.folderCount){r=!0;break}}return r?t.map(e=>{let t=n.get(e.library_id);return!t||e.scanStatus===t.scanStatus&&e.scanProgress===t.scanProgress&&e.scanTotal===t.scanTotal&&e.scanError===t.scanError&&e.scannedAt===t.scannedAt&&e.fileCount===t.fileCount&&e.folderCount===t.folderCount?e:t}):t})}catch(e){console.error(`[LibraryManagement] Refresh error:`,e)}},[]),de=async()=>{try{E((await ce()).library_root||null)}catch(e){console.error(`[LibraryManagement] Failed to load config:`,e)}};(0,Q.useEffect)(()=>{V(),de()},[V]),(0,Q.useEffect)(()=>{let e=!0,t=null,n=async()=>{try{let n=await M();if(!e)return;n.is_busy?t||=setInterval(()=>{ue()},500):t&&(clearInterval(t),t=null,ue())}catch(e){console.error(`[LibraryManagement] Failed to check work status:`,e)}};n();let r=setInterval(n,5e3);return()=>{e=!1,t&&clearInterval(t),clearInterval(r)}},[ue]);let H=e=>{if(!T)return!1;let t=T.replace(/\/+$/,``);return!e.replace(/\/+$/,``).startsWith(t)},he=()=>{O(``),j(``),P(!0),I(`off`),ne(`full`),se(`full`),re(!1),v(!1),b(null)},ge=()=>{he(),v(!0)},_e=e=>{O(e.name),j(e.rootPath),P(e.isEnabled),I(e.watchMode),ne(e.fileWriteMode),se(e.fileWriteMode),b(e.library_id),v(!1)},U=async()=>{if(!A.trim()){g(`Path is required`);return}try{g(null),await pe({name:D.trim()||null,rootPath:A,isEnabled:N,watchMode:ee,fileWriteMode:te}),await V(),he()}catch(e){g(e instanceof Error?e.message:`Failed to create library`)}},W=async()=>{if(y===null)return;if(!A.trim()){g(`Path is required`);return}let e=te!==ae;try{if(g(null),await le(y,{name:D.trim()||void 0,rootPath:A,isEnabled:N,watchMode:ee,...e?{}:{fileWriteMode:te}}),e){let e=await je(y,te);e.requires_reconciliation&&e.affected_file_count>0&&await n({title:`Reconcile Tags?`,message:`${e.affected_file_count} files need to be rewritten with the new tag format. Reconcile now?`,severity:`info`})&&await De(y)}await V(),he()}catch(e){g(e instanceof Error?e.message:`Failed to update library`)}},ve=async(t,n)=>{try{g(null),w(t);let r=await Me(t,n);e(r.message||`Library scan started (${r.stats?.files_queued??0} files)`),await V()}catch(e){g(e instanceof Error?e.message:`Failed to scan library`)}finally{w(null)}},ye=async(e,t)=>{if(await n({title:`Delete Library?`,message:`Delete library "${t}"?\n\nThis will remove the library entry but will NOT delete files on disk.`,severity:`warning`}))try{g(null),await xe(e),await V()}catch(e){g(e instanceof Error?e.message:`Failed to delete library`)}},be=async(t,n)=>{try{g(null),await le(t,{watchMode:n}),await V(),e(`File watching mode changed to ${n}`)}catch(e){g(e instanceof Error?e.message:`Failed to change watch mode`)}},Se=e=>{switch(e){case`event`:return`Event`;case`poll`:return`Poll`;default:return`Off`}},Ce=e=>{switch(e){case`event`:return`success`;case`poll`:return`warning`;default:return`default`}},Te=e=>{switch(e){case`none`:return`None`;case`minimal`:return`Minimal`;case`full`:return`Full`}},Ee=e=>{switch(e){case`none`:return`default`;case`minimal`:return`secondary`;case`full`:return`primary`}},De=async t=>{try{g(null),z(t);let n=await ke(t);e(`Reconciled ${n.processed} files (${n.remaining} remaining, ${n.failed} failed)`);let r=await me(t);ie(e=>({...e,[t]:{pending:r.pending_count,inProgress:r.in_progress}}))}catch(e){g(e instanceof Error?e.message:`Failed to reconcile tags`)}finally{z(null)}},Oe=async e=>{try{let t=await me(e);ie(n=>({...n,[e]:{pending:t.pending_count,inProgress:t.in_progress}}))}catch{}},J=_||y!==null;return(0,Z.jsxs)(t,{spacing:2.5,children:[(0,Z.jsxs)(t,{direction:`row`,justifyContent:`space-between`,alignItems:`center`,children:[(0,Z.jsx)(q,{variant:`h5`,children:`Libraries`}),!J&&(0,Z.jsx)(G,{variant:`contained`,onClick:ge,children:`+ Add Library`})]}),h&&(0,Z.jsx)(we,{children:h}),J&&(0,Z.jsxs)(fe,{children:[(0,Z.jsx)(k,{title:_?`Create Library`:`Edit Library`}),(0,Z.jsxs)(t,{spacing:2,children:[(0,Z.jsxs)(K,{children:[(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,sx:{mb:.5},children:`Name (optional)`}),(0,Z.jsx)(p,{value:D,onChange:e=>O(e.target.value),placeholder:`Auto-generated from path if left empty`,fullWidth:!0})]}),(0,Z.jsxs)(K,{children:[(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,sx:{mb:.5},children:`Root Path`}),(0,Z.jsxs)(t,{direction:`row`,spacing:1.25,children:[(0,Z.jsx)(p,{value:A,onChange:e=>j(e.target.value),placeholder:`/music`,fullWidth:!0}),(0,Z.jsx)(G,{variant:`outlined`,onClick:()=>re(!L),sx:{minWidth:120},children:L?`Hide Picker`:`Browse...`})]}),L&&(0,Z.jsx)(K,{sx:{mt:1.25,p:2,bgcolor:`background.default`,borderRadius:1,border:1,borderColor:`divider`},children:(0,Z.jsx)(Ie,{value:A,onChange:e=>{j(e),re(!1)},mode:`directory`,label:`Select Library Root Directory`})})]}),(0,Z.jsx)(_t,{control:(0,Z.jsx)(dt,{checked:N,onChange:e=>P(e.target.checked)}),label:`Enabled`}),(0,Z.jsx)(K,{children:(0,Z.jsxs)(s,{fullWidth:!0,children:[(0,Z.jsx)(d,{id:`watch-mode-label`,children:`File Watching`}),(0,Z.jsxs)(l,{labelId:`watch-mode-label`,value:ee,label:`File Watching`,onChange:e=>I(e.target.value),children:[(0,Z.jsx)(S,{value:`off`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`Off`}),` - No automatic scanning`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Manual scans only`})]})}),(0,Z.jsx)(S,{value:`event`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`Event`}),` - Real-time file watching`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Fast (2-5s response), local filesystems only`})]})}),(0,Z.jsx)(S,{value:`poll`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`Poll`}),` - Periodic scanning`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Slower (60s interval), network-mount-safe`})]})})]})]})}),(0,Z.jsx)(K,{children:(0,Z.jsxs)(s,{fullWidth:!0,children:[(0,Z.jsx)(d,{id:`write-mode-label`,children:`Tag Writing Mode`}),(0,Z.jsxs)(l,{labelId:`write-mode-label`,value:te,label:`Tag Writing Mode`,onChange:e=>ne(e.target.value),children:[(0,Z.jsx)(S,{value:`none`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`None`}),` - Don't write tags to files`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`DB is source of truth; clears existing nomarr tags`})]})}),(0,Z.jsx)(S,{value:`minimal`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`Minimal`}),` - Mood tags only`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Write mood-strict, mood-regular, mood-loose`})]})}),(0,Z.jsx)(S,{value:`full`,children:(0,Z.jsxs)(t,{children:[(0,Z.jsxs)(q,{children:[(0,Z.jsx)(`strong`,{children:`Full`}),` - All tags`]}),(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Write all ML-derived tags to audio files`})]})})]})]})}),(0,Z.jsxs)(t,{direction:`row`,spacing:1.25,children:[(0,Z.jsx)(G,{variant:`contained`,onClick:_?U:W,children:_?`Create`:`Update`}),(0,Z.jsx)(G,{variant:`outlined`,onClick:he,children:`Cancel`})]})]})]}),f&&(0,Z.jsx)(q,{children:`Loading libraries...`}),!f&&!J&&c.length===0&&(0,Z.jsx)(fe,{children:(0,Z.jsx)(q,{color:`text.secondary`,textAlign:`center`,fontStyle:`italic`,children:`No libraries configured. Click "Add Library" to get started.`})}),!f&&!J&&c.length>0&&(0,Z.jsx)(t,{spacing:2,children:c.map(e=>(0,Z.jsxs)(fe,{children:[(0,Z.jsxs)(t,{direction:`row`,justifyContent:`space-between`,alignItems:`flex-start`,sx:{mb:2},children:[(0,Z.jsxs)(K,{children:[(0,Z.jsxs)(t,{direction:`row`,alignItems:`center`,spacing:1.25,sx:{mb:.5},children:[(0,Z.jsx)(q,{variant:`h6`,children:e.name}),H(e.rootPath)&&(0,Z.jsx)(x,{label:`Outside library_root`,color:`warning`,size:`small`})]}),(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,sx:{fontFamily:`monospace`},children:e.rootPath}),(0,Z.jsxs)(t,{direction:`row`,spacing:2,sx:{mt:.5},children:[(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[(0,Z.jsx)(`strong`,{children:e.fileCount.toLocaleString()}),` files`]}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[(0,Z.jsx)(`strong`,{children:e.folderCount.toLocaleString()}),` folders`]})]}),e.scanStatus===`scanning`&&(0,Z.jsxs)(t,{direction:`row`,alignItems:`center`,spacing:1,sx:{mt:.5},children:[(0,Z.jsx)(x,{label:`Scanning...`,color:`info`,size:`small`,sx:{animation:`pulse 1.5s infinite`}}),e.scanProgress!=null&&e.scanTotal!=null&&e.scanTotal>0&&(0,Z.jsxs)(q,{variant:`body2`,color:`info.main`,children:[e.scanProgress.toLocaleString(),` / `,e.scanTotal.toLocaleString(),` files`,` `,`(`,Math.round(e.scanProgress/e.scanTotal*100),`%)`]})]}),e.scanStatus===`error`&&e.scanError&&(0,Z.jsxs)(q,{variant:`caption`,color:`error.main`,sx:{mt:.5},children:[`âš  Scan error: `,e.scanError]}),H(e.rootPath)&&(0,Z.jsxs)(q,{variant:`caption`,color:`warning.main`,sx:{mt:.5},children:[`âš  This library is outside the configured library_root (`,T,`)`]}),(0,Z.jsxs)(t,{direction:`row`,alignItems:`center`,spacing:1,sx:{mt:1},children:[(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`File Watching:`}),(0,Z.jsx)(s,{size:`small`,sx:{minWidth:120},children:(0,Z.jsxs)(l,{value:e.watchMode,onChange:t=>be(e.library_id,t.target.value),size:`small`,sx:{fontSize:`0.75rem`},disabled:C===e.library_id,children:[(0,Z.jsx)(S,{value:`off`,children:`Off`}),(0,Z.jsx)(S,{value:`event`,children:`Event`}),(0,Z.jsx)(S,{value:`poll`,children:`Poll`})]})}),(0,Z.jsx)(zt,{title:e.watchMode===`event`?`Real-time file watching (local filesystems)`:e.watchMode===`poll`?`Periodic scanning (network-mount-safe)`:`No automatic file watching`,children:(0,Z.jsx)(x,{label:Se(e.watchMode),color:Ce(e.watchMode),size:`small`})})]}),(0,Z.jsxs)(t,{direction:`row`,alignItems:`center`,spacing:1,sx:{mt:.5},children:[(0,Z.jsx)(q,{variant:`caption`,color:`text.secondary`,children:`Tag Writing:`}),(0,Z.jsx)(zt,{title:e.fileWriteMode===`full`?`All ML-derived tags written to audio files`:e.fileWriteMode===`minimal`?`Only mood tags written to audio files`:`No tags written to audio files (DB only)`,children:(0,Z.jsx)(x,{label:Te(e.fileWriteMode),color:Ee(e.fileWriteMode),size:`small`})}),B[e.library_id]?.pending>0&&(0,Z.jsx)(x,{label:`${B[e.library_id].pending} pending`,color:`warning`,size:`small`})]})]}),(0,Z.jsxs)(t,{direction:`row`,alignItems:`center`,spacing:1,children:[(0,Z.jsx)(K,{sx:{width:8,height:8,borderRadius:`50%`,bgcolor:e.isEnabled?`success.main`:`text.disabled`}}),(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,children:e.isEnabled?`Enabled`:`Disabled`})]})]}),(0,Z.jsxs)(t,{direction:`row`,spacing:1.25,flexWrap:`wrap`,children:[(0,Z.jsx)(G,{variant:`outlined`,size:`small`,onClick:()=>_e(e),disabled:C===e.library_id,children:`Edit`}),(0,Z.jsx)(G,{variant:`outlined`,color:`success`,size:`small`,onClick:()=>ve(e.library_id,`quick`),disabled:!e.isEnabled||C===e.library_id||e.scanStatus===`scanning`||H(e.rootPath)||!e.scannedAt,title:e.scannedAt?e.scanStatus===`scanning`?`Scan already in progress`:H(e.rootPath)?`Cannot scan: library is outside library_root`:`Scan only new and modified files`:`Run a Full Scan first before using Quick Scan`,children:C===e.library_id||e.scanStatus===`scanning`?`Scanning...`:`Quick Scan`}),(0,Z.jsx)(G,{variant:`contained`,color:`success`,size:`small`,onClick:()=>ve(e.library_id,`full`),disabled:!e.isEnabled||C===e.library_id||e.scanStatus===`scanning`||H(e.rootPath),title:e.scanStatus===`scanning`?`Scan already in progress`:H(e.rootPath)?`Cannot scan: library is outside library_root`:`Rescan all files in the library`,children:C===e.library_id||e.scanStatus===`scanning`?`Scanning...`:`Full Scan`}),(0,Z.jsx)(G,{variant:`outlined`,color:`secondary`,size:`small`,onClick:()=>De(e.library_id),disabled:!e.isEnabled||R===e.library_id||e.scanStatus===`scanning`,title:R===e.library_id?`Reconciling tags...`:`Write tags from database to audio files`,onMouseEnter:()=>Oe(e.library_id),children:R===e.library_id?`Reconciling...`:`Reconcile Tags`}),(0,Z.jsx)(G,{variant:`contained`,color:`error`,size:`small`,onClick:()=>ye(e.library_id,e.name),disabled:C===e.library_id,children:`Delete`})]})]},e.library_id))}),(0,Z.jsx)(F,{open:r,title:i.title,message:i.message,confirmLabel:i.confirmLabel,cancelLabel:i.cancelLabel,severity:i.severity,onConfirm:a,onCancel:o})]})}function Cn({tag:e,currentTrackId:n,isNumeric:r}){let[i,a]=(0,Q.useState)([]),[o,s]=(0,Q.useState)(!1),[c,u]=(0,Q.useState)(null),[d,f]=(0,Q.useState)(``),[m,h]=(0,Q.useState)(`title`),[g,_]=(0,Q.useState)(0),v=(0,Q.useCallback)(async()=>{try{if(s(!0),u(null),_(0),r){let t=await Oe({tagKey:e.key,limit:500}),r=parseFloat(e.value);a(t.files.filter(e=>e.file_id!==n).map(t=>{let n=t.tags?.find(t=>t.key===e.key),i=n?parseFloat(n.value):null;return{track:t,value:i,diff:i===null?1/0:Math.abs(i-r)}}).filter(e=>e.value!==null).sort((e,t)=>{if(e.diff!==t.diff)return e.diff-t.diff;let n=(e.track.title||``).localeCompare(t.track.title||``);if(n!==0)return n;let r=(e.track.artist||``).localeCompare(t.track.artist||``);return r===0?e.track.file_id.localeCompare(t.track.file_id):r}))}else a((await Oe({tagKey:e.key,tagValue:e.value,limit:500})).files.filter(e=>e.file_id!==n).map(e=>({track:e,diff:0})))}catch(e){u(e instanceof Error?e.message:`Failed to load similar tracks`),console.error(`[SimilarTracks] Load error:`,e)}finally{s(!1)}},[e.key,e.value,n,r]);(0,Q.useEffect)(()=>{v()},[v]);let y=e=>!e||e<=0?`-`:`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,`0`)}`,b=t=>t.tags?.find(t=>t.key===e.key)?.value||null,{paginatedTracks:C,totalFiltered:w,totalPages:T}=(0,Q.useMemo)(()=>{let e=i;if(d.trim()){let t=d.toLowerCase();e=e.filter(({track:e})=>e.title?.toLowerCase().includes(t)||e.artist?.toLowerCase().includes(t)||e.album?.toLowerCase().includes(t))}r||(e=[...e].sort((e,t)=>{switch(m){case`title`:return(e.track.title||``).localeCompare(t.track.title||``);case`artist`:return(e.track.artist||``).localeCompare(t.track.artist||``);case`album`:return(e.track.album||``).localeCompare(t.track.album||``);default:return 0}}));let t=e.length,n=Math.ceil(t/25),a=g*25;return{paginatedTracks:e.slice(a,a+25).map(e=>e.track),totalFiltered:t,totalPages:n}},[i,d,r,m,g]);return(0,Q.useEffect)(()=>{_(0)},[d]),(0,Z.jsxs)(K,{children:[(0,Z.jsxs)(q,{variant:`subtitle2`,gutterBottom:!0,children:[`Similar tracks with `,e.key,r?` (by distance to ${e.value})`:` = "${e.value}"`]}),i.length>0&&(0,Z.jsxs)(K,{sx:{mb:2},children:[(0,Z.jsxs)(t,{direction:`row`,spacing:1,children:[(0,Z.jsx)(p,{placeholder:`Filter similar tracks...`,value:d,onChange:e=>f(e.target.value),size:`small`,fullWidth:!0,InputProps:{endAdornment:(0,Z.jsx)(Ce,{size:`small`,edge:`end`,children:(0,Z.jsx)(xn,{fontSize:`small`})})}}),!r&&(0,Z.jsxs)(l,{value:m,onChange:e=>h(e.target.value),size:`small`,sx:{minWidth:130},children:[(0,Z.jsx)(S,{value:`title`,children:`Sort by Title`}),(0,Z.jsx)(S,{value:`artist`,children:`Sort by Artist`}),(0,Z.jsx)(S,{value:`album`,children:`Sort by Album`})]})]}),(0,Z.jsxs)(q,{variant:`caption`,color:`text.secondary`,sx:{mt:.5,display:`block`},children:[`Showing `,C.length,` of `,w,` matches`,w!==i.length&&` (${i.length} total)`]})]}),o&&(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,children:`Loading...`}),c&&(0,Z.jsx)(we,{children:c}),!o&&i.length===0&&(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,children:`No similar tracks found.`}),!o&&i.length>0&&C.length===0&&(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[`No tracks matching "`,d,`".`]}),!o&&i.length>0&&C.length>0&&(0,Z.jsx)(t,{spacing:1,sx:{mt:2},children:C.map(e=>{let n=b(e);return(0,Z.jsx)(K,{sx:{p:1.5,bgcolor:`background.default`,border:1,borderColor:`divider`,borderRadius:1},children:(0,Z.jsxs)(t,{direction:`row`,justifyContent:`space-between`,alignItems:`center`,spacing:2,children:[(0,Z.jsxs)(K,{sx:{flex:1,minWidth:0},children:[(0,Z.jsx)(q,{variant:`body2`,sx:{fontWeight:500},noWrap:!0,children:e.title||`Unknown Title`}),(0,Z.jsxs)(q,{variant:`caption`,color:`text.secondary`,noWrap:!0,children:[e.artist&&(0,Z.jsx)(`span`,{children:e.artist}),e.album&&(0,Z.jsxs)(`span`,{children:[` â€¢ `,e.album]}),e.tags?.find(e=>e.key===`genre`)&&(0,Z.jsxs)(`span`,{children:[` `,`â€¢`,` `,e.tags.find(e=>e.key===`genre`)?.value]})]})]}),(0,Z.jsxs)(t,{direction:`row`,spacing:1,alignItems:`center`,children:[r&&n&&(0,Z.jsx)(x,{label:n,size:`small`,sx:{fontSize:`0.7rem`}}),(0,Z.jsx)(q,{variant:`caption`,color:`text.disabled`,sx:{minWidth:40,textAlign:`right`},children:y(e.duration_seconds)})]})]})},e.file_id)})}),T>1&&(0,Z.jsxs)(t,{direction:`row`,justifyContent:`center`,alignItems:`center`,spacing:2,sx:{mt:2},children:[(0,Z.jsx)(G,{size:`small`,variant:`outlined`,onClick:()=>_(Math.max(0,g-1)),disabled:g===0,children:`Previous`}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[`Page `,g+1,` of `,T]}),(0,Z.jsx)(G,{size:`small`,variant:`outlined`,onClick:()=>_(Math.min(T-1,g+1)),disabled:g>=T-1,children:`Next`})]})]})}function wn({track:e}){let[n,i]=(0,Q.useState)(null),[a,o]=(0,Q.useState)(``),[s,c]=(0,Q.useState)(`key`),u=e.tags||[],d=u.filter(e=>e.is_nomarr),f=u.filter(e=>!e.is_nomarr),m=(0,Q.useMemo)(()=>{let e=d;if(a.trim()){let t=a.toLowerCase();e=e.filter(e=>e.key.toLowerCase().includes(t)||e.value.toLowerCase().includes(t))}return[...e].sort((e,t)=>s===`key`?e.key.localeCompare(t.key):e.value.localeCompare(t.value))},[d,a,s]),h=(0,Q.useMemo)(()=>{let e=f;if(a.trim()){let t=a.toLowerCase();e=e.filter(e=>e.key.toLowerCase().includes(t)||e.value.toLowerCase().includes(t))}return[...e].sort((e,t)=>s===`key`?e.key.localeCompare(t.key):e.value.localeCompare(t.value))},[f,a,s]),g=e=>{i(n?.key===e.key?null:e)},_=e=>e.type===`float`||!isNaN(parseFloat(e.value));return(0,Z.jsxs)(K,{children:[(0,Z.jsxs)(K,{sx:{mb:2},children:[(0,Z.jsx)(q,{variant:`body2`,fontWeight:`bold`,component:`span`,children:`Path:`}),(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,sx:{mt:.5,fontFamily:`monospace`,wordBreak:`break-all`},children:e.path})]}),u.length>0&&(0,Z.jsxs)(t,{direction:`row`,spacing:1,sx:{mb:2},children:[(0,Z.jsx)(p,{placeholder:`Filter tags...`,value:a,onChange:e=>o(e.target.value),size:`small`,fullWidth:!0}),(0,Z.jsxs)(l,{value:s,onChange:e=>c(e.target.value),size:`small`,sx:{minWidth:130},children:[(0,Z.jsx)(S,{value:`key`,children:`Sort by Key`}),(0,Z.jsx)(S,{value:`value`,children:`Sort by Value`})]})]}),u.length>0&&(0,Z.jsxs)(t,{direction:`row`,spacing:1,sx:{mb:2},children:[(0,Z.jsx)(p,{placeholder:`Filter tags...`,value:a,onChange:e=>o(e.target.value),size:`small`,fullWidth:!0}),(0,Z.jsxs)(l,{value:s,onChange:e=>c(e.target.value),size:`small`,sx:{minWidth:130},children:[(0,Z.jsx)(S,{value:`key`,children:`Sort by Key`}),(0,Z.jsx)(S,{value:`value`,children:`Sort by Value`})]})]}),u.length===0&&(0,Z.jsx)(q,{variant:`body2`,color:`text.secondary`,children:`No tags available for this track.`}),m.length>0&&(0,Z.jsxs)(K,{sx:{mb:2},children:[(0,Z.jsx)(q,{variant:`subtitle2`,gutterBottom:!0,children:`Nomarr Tags (Click to explore similar)`}),(0,Z.jsx)(r,{dense:!0,children:m.map(e=>(0,Z.jsx)(w,{onClick:()=>g(e),sx:{cursor:`pointer`,borderRadius:1,"&:hover":{bgcolor:`action.hover`},bgcolor:n?.key===e.key?`action.selected`:`transparent`},children:(0,Z.jsx)(T,{primary:(0,Z.jsxs)(t,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,Z.jsxs)(q,{variant:`body2`,component:`span`,sx:{fontWeight:500},children:[e.key,`:`]}),(0,Z.jsx)(q,{variant:`body2`,component:`span`,children:e.value}),_(e)&&(0,Z.jsx)(x,{label:`numeric`,size:`small`,sx:{height:18,fontSize:`0.65rem`}})]})})},e.key))})]}),h.length>0&&(0,Z.jsxs)(K,{sx:{mb:2},children:[(0,Z.jsx)(q,{variant:`subtitle2`,gutterBottom:!0,children:`Other Tags`}),(0,Z.jsx)(r,{dense:!0,children:h.map(e=>(0,Z.jsx)(w,{sx:{pl:0},children:(0,Z.jsx)(T,{primary:(0,Z.jsxs)(q,{variant:`body2`,children:[(0,Z.jsxs)(q,{component:`span`,sx:{fontWeight:500,color:`text.secondary`},children:[e.key,`:`]}),` `,e.value]})})},e.key))})]}),n&&(0,Z.jsx)(fe,{sx:{mt:2},children:(0,Z.jsx)(Cn,{tag:n,currentTrackId:e.file_id,isNumeric:_(n)})})]})}function Tn({entityId:e,entityName:n,collection:r,relationType:i}){let[a,o]=(0,Q.useState)([]),[s,c]=(0,Q.useState)(!1),[u,d]=(0,Q.useState)(null),[f,m]=(0,Q.useState)(null),[h,g]=(0,Q.useState)(``),[_,v]=(0,Q.useState)(`title`),y=(0,Q.useCallback)(async()=>{try{c(!0),d(null);let t=await A(r,e,i,{limit:500});if(t.song_ids.length===0){o([]);return}let n=await Te(t.song_ids),a=new Map(n.files.map(e=>[e.file_id,e]));o(t.song_ids.map(e=>a.get(e)).filter(e=>e!==void 0))}catch(e){d(e instanceof Error?e.message:`Failed to load tracks`),console.error(`[TrackList] Load error:`,e)}finally{c(!1)}},[e,r,i]);(0,Q.useEffect)(()=>{y()},[y]);let b=(0,Q.useMemo)(()=>{let e=a;if(h.trim()){let t=h.toLowerCase();e=e.filter(e=>e.title?.toLowerCase().includes(t)||e.artist?.toLowerCase().includes(t)||e.album?.toLowerCase().includes(t))}return[...e].sort((e,t)=>{switch(_){case`title`:return(e.title||``).localeCompare(t.title||``);case`artist`:return(e.artist||``).localeCompare(t.artist||``);case`album`:return(e.album||``).localeCompare(t.album||``);case`duration`:return(e.duration_seconds||0)-(t.duration_seconds||0);default:return 0}})},[a,h,_]),C=e=>{m(f===e?null:e)},w=e=>!e||e<=0?`-`:`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,`0`)}`;return(0,Z.jsxs)(K,{children:[(0,Z.jsxs)(fe,{sx:{mb:2},children:[(0,Z.jsx)(q,{variant:`h6`,gutterBottom:!0,children:n}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,sx:{mb:1.5},children:[s?`Loading tracks...`:`${a.length} track${a.length===1?``:`s`}`,h&&` (${b.length} matching)`]}),(0,Z.jsxs)(t,{direction:`row`,spacing:1,children:[(0,Z.jsx)(p,{placeholder:`Filter tracks by title, artist, or album...`,value:h,onChange:e=>g(e.target.value),size:`small`,fullWidth:!0,InputProps:{endAdornment:(0,Z.jsx)(Ce,{size:`small`,edge:`end`,children:(0,Z.jsx)(xn,{fontSize:`small`})})}}),(0,Z.jsxs)(l,{value:_,onChange:e=>v(e.target.value),size:`small`,sx:{minWidth:150},children:[(0,Z.jsx)(S,{value:`title`,children:`Sort by Title`}),(0,Z.jsx)(S,{value:`artist`,children:`Sort by Artist`}),(0,Z.jsx)(S,{value:`album`,children:`Sort by Album`}),(0,Z.jsx)(S,{value:`duration`,children:`Sort by Duration`})]})]})]}),u&&(0,Z.jsx)(we,{children:u}),!s&&b.length===0&&(0,Z.jsx)(fe,{children:(0,Z.jsx)(q,{color:`text.secondary`,textAlign:`center`,children:h?`No tracks matching "${h}".`:`No tracks found for this ${r.slice(0,-1)}.`})}),(0,Z.jsx)(t,{spacing:1,children:b.map((e,t)=>(0,Z.jsxs)(K,{sx:{bgcolor:`background.paper`,border:1,borderColor:`divider`,borderRadius:1,overflow:`hidden`},children:[(0,Z.jsxs)(K,{onClick:()=>C(e.file_id),sx:{display:`flex`,justifyContent:`space-between`,alignItems:`center`,p:1.5,cursor:`pointer`,"&:hover":{bgcolor:`action.hover`}},children:[(0,Z.jsxs)(K,{sx:{flex:1,display:`flex`,alignItems:`center`,gap:2},children:[(0,Z.jsx)(q,{variant:`body2`,color:`text.disabled`,sx:{minWidth:30,textAlign:`right`},children:t+1}),(0,Z.jsxs)(K,{sx:{flex:1},children:[(0,Z.jsx)(q,{variant:`body1`,sx:{fontWeight:500},children:e.title||`Unknown Title`}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[e.artist&&(0,Z.jsx)(`span`,{children:e.artist}),e.album&&(0,Z.jsxs)(`span`,{children:[` â€¢ `,e.album]})]})]}),(0,Z.jsx)(q,{variant:`body2`,color:`text.disabled`,children:w(e.duration_seconds)}),e.tagged&&(0,Z.jsx)(x,{label:`${e.tags?.length||0} tags`,size:`small`,color:`primary`})]}),(0,Z.jsx)(q,{color:`text.disabled`,sx:{ml:1},children:f===e.file_id?`â–¼`:`â–¶`})]}),f===e.file_id&&(0,Z.jsx)(K,{sx:{p:2,borderTop:1,borderColor:`divider`,bgcolor:`background.default`},children:(0,Z.jsx)(wn,{track:e})})]},e.file_id))})]})}function En({collection:e}){let[n,i]=(0,Q.useState)([]),[a,o]=(0,Q.useState)(0),[s,c]=(0,Q.useState)(!1),[u,d]=(0,Q.useState)(null),[f,m]=(0,Q.useState)(``),[h,g]=(0,Q.useState)(null),[_,v]=(0,Q.useState)(0),[y,b]=(0,Q.useState)(`name`),x=(0,Q.useCallback)(async()=>{try{c(!0),d(null);let t=await U(e,{limit:100,offset:_,search:f||void 0});i([...t.entities].sort((e,t)=>y===`name`?e.display_name.localeCompare(t.display_name):(t.song_count||0)-(e.song_count||0))),o(t.total)}catch(e){d(e instanceof Error?e.message:`Failed to load entities`),console.error(`[EntityBrowser] Load error:`,e)}finally{c(!1)}},[e,_,f,y]);(0,Q.useEffect)(()=>{v(0),g(null),m(``)},[e]),(0,Q.useEffect)(()=>{x()},[x]);let C=()=>{v(0),g(null),x()},w=e=>{g(e)},E=()=>{v(Math.max(0,_-100))},D=()=>{_+100<a&&v(_+100)},O=Math.floor(_/100)+1,k=Math.ceil(a/100);return(0,Z.jsxs)(K,{sx:{display:`flex`,gap:2,height:`calc(100vh - 250px)`},children:[(0,Z.jsxs)(K,{sx:{width:350,display:`flex`,flexDirection:`column`},children:[(0,Z.jsxs)(fe,{sx:{mb:2},children:[(0,Z.jsxs)(t,{direction:`row`,spacing:1,sx:{mb:1},children:[(0,Z.jsx)(p,{placeholder:`Search ${e}...`,value:f,onChange:e=>m(e.target.value),onKeyDown:e=>e.key===`Enter`&&C(),size:`small`,fullWidth:!0}),(0,Z.jsx)(G,{variant:`contained`,onClick:C,sx:{minWidth:`auto`},children:(0,Z.jsx)(xn,{})})]}),(0,Z.jsxs)(l,{value:y,onChange:e=>b(e.target.value),size:`small`,fullWidth:!0,children:[(0,Z.jsx)(S,{value:`name`,children:`Sort by Name`}),(0,Z.jsx)(S,{value:`count`,children:`Sort by Song Count`})]}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,sx:{mt:1},children:[s?`Loading...`:`${a.toLocaleString()} total`,a>100&&` (Page ${O} of ${k})`]})]}),u&&(0,Z.jsx)(we,{children:u}),(0,Z.jsxs)(fe,{sx:{flex:1,overflow:`auto`,p:0},children:[n.length===0&&!s&&(0,Z.jsx)(K,{sx:{p:2,textAlign:`center`},children:(0,Z.jsxs)(q,{color:`text.secondary`,children:[`No `,e,` found.`]})}),(0,Z.jsx)(r,{dense:!0,children:n.map(e=>(0,Z.jsx)(Ot,{selected:h?.entity_id===e.entity_id,onClick:()=>w(e),children:(0,Z.jsx)(T,{primary:e.display_name,secondary:e.song_count===void 0?void 0:`${e.song_count} songs`})},e.entity_id))})]}),a>100&&(0,Z.jsxs)(K,{sx:{mt:1,display:`flex`,justifyContent:`center`,gap:1},children:[(0,Z.jsx)(G,{size:`small`,onClick:E,disabled:_===0,children:`Previous`}),(0,Z.jsx)(G,{size:`small`,onClick:D,disabled:_+100>=a,children:`Next`})]})]}),(0,Z.jsx)(K,{sx:{flex:1},children:h?(0,Z.jsx)(Tn,{entityId:h.entity_id,entityName:h.display_name,collection:e,relationType:(()=>{switch(e){case`artists`:return`artist`;case`albums`:return`album`;case`genres`:return`genres`;case`years`:return`year`;default:return e}})()}):(0,Z.jsx)(fe,{children:(0,Z.jsxs)(q,{color:`text.secondary`,textAlign:`center`,children:[`Select `,e===`artists`?`an`:`a`,` `,e.slice(0,-1),` to view tracks`]})})})]})}function Dn({items:e}){return e.length===0?null:(0,Z.jsx)(K,{sx:{py:1},children:(0,Z.jsx)(Ye,{separator:(0,Z.jsx)(vn,{fontSize:`small`}),maxItems:7,"aria-label":`library navigation`,children:e.map((t,n)=>n===e.length-1?(0,Z.jsx)(q,{color:`text.primary`,variant:`body2`,children:t.label},n):(0,Z.jsx)(wt,{component:`button`,variant:`body2`,onClick:t.onClick,underline:`hover`,color:`inherit`,sx:{cursor:`pointer`},children:t.label},n))})})}function On(e){switch(e.type){case`artists`:return`Artists`;case`albums`:return e.artist.display_name;case`tracks`:return e.album.display_name;case`tags`:return e.track.title??e.track.path.split(`/`).pop()??`Track`;case`tag-search`:return e.label}}function kn({initialStep:e}){let[n,i]=(0,Q.useState)(e?[{type:`artists`},e]:[{type:`artists`}]),a=n[n.length-1],[o,s]=(0,Q.useState)([]),[c,l]=(0,Q.useState)([]),[u,d]=(0,Q.useState)([]),[f,p]=(0,Q.useState)(!1),[m,h]=(0,Q.useState)(null),[g,_]=(0,Q.useState)(0),[v,y]=(0,Q.useState)(0),b=(0,Q.useCallback)(async(e=0)=>{try{p(!0),h(null);let t=await U(`artists`,{limit:50,offset:e});s(t.entities.sort((e,t)=>e.display_name.localeCompare(t.display_name))),_(t.total),y(e)}catch(e){h(e instanceof Error?e.message:`Failed to load artists`)}finally{p(!1)}},[]),S=(0,Q.useCallback)(async e=>{try{p(!0),h(null),l((await R(e)).sort((e,t)=>e.display_name.localeCompare(t.display_name)))}catch(e){h(e instanceof Error?e.message:`Failed to load albums`)}finally{p(!1)}},[]),C=(0,Q.useCallback)(async e=>{try{p(!0),h(null);let t=await A(`albums`,e,`album`,{limit:500});t.song_ids.length>0?d((await Te(t.song_ids)).files):d([])}catch(e){h(e instanceof Error?e.message:`Failed to load tracks`)}finally{p(!1)}},[]),w=(0,Q.useCallback)(async(e,t)=>{try{p(!0),h(null),d((await ue({tag_key:e,target_value:t,limit:100})).files)}catch(e){h(e instanceof Error?e.message:`Failed to search by tag`)}finally{p(!1)}},[]);(0,Q.useEffect)(()=>{switch(a.type){case`artists`:b(0);break;case`albums`:S(a.artist.entity_id);break;case`tracks`:C(a.album.entity_id);break;case`tags`:break;case`tag-search`:w(a.tagKey,a.targetValue);break}},[a,b,S,C,w]);let E=(0,Q.useCallback)(e=>{i(t=>[...t,e])},[]),k=(0,Q.useCallback)(e=>{i(t=>t.slice(0,e+1))},[]),j=e=>{E({type:`albums`,artist:e})},M=e=>{a.type===`albums`&&E({type:`tracks`,artist:a.artist,album:e})},N=e=>{if(a.type===`tracks`)E({type:`tags`,artist:a.artist,album:a.album,track:e});else if(a.type===`tag-search`){let t=e.artist??`Unknown Artist`,n=e.album??`Unknown Album`;E({type:`tags`,artist:{entity_id:``,key:``,display_name:t},album:{entity_id:``,display_name:n},track:e})}},P=e=>{let t=e.value;try{let n=JSON.parse(e.value);Array.isArray(n)&&n.length===1?t=n[0]:(typeof n==`number`||typeof n==`string`)&&(t=n)}catch{}let n=`${e.key}: ${typeof t==`number`?t.toFixed(2):t}`;E({type:`tag-search`,tagKey:e.key,targetValue:t,label:n})},ee=(0,Q.useMemo)(()=>{let e=[];if(e.push({label:`Artists`,onClick:()=>k(0)}),n.length<=5)for(let t=1;t<n.length;t++){let r=n[t],i=t;e.push({label:On(r),onClick:i===n.length-1?()=>{}:()=>k(i)})}else{e.push({label:`...`,onClick:()=>{}});let t=n.length-3;for(let r=t;r<n.length;r++){let t=n[r],i=r;e.push({label:On(t),onClick:i===n.length-1?()=>{}:()=>k(i)})}}return e},[n,k]);return(0,Z.jsxs)(K,{sx:{height:`100%`,display:`flex`,flexDirection:`column`},children:[(0,Z.jsx)(Dn,{items:ee}),(0,Z.jsx)(Y,{sx:{flex:1,overflow:`auto`,mt:1},children:(()=>{if(f)return(0,Z.jsx)(K,{sx:{p:3,textAlign:`center`},children:(0,Z.jsx)(q,{color:`text.secondary`,children:`Loading...`})});if(m)return(0,Z.jsx)(K,{sx:{p:3,textAlign:`center`},children:(0,Z.jsx)(q,{color:`error`,children:m})});switch(a.type){case`artists`:{let e=Math.floor(v/50)+1,t=Math.ceil(g/50),n=v>0,i=v+50<g;return(0,Z.jsxs)(K,{sx:{display:`flex`,flexDirection:`column`,height:`100%`},children:[(0,Z.jsx)(r,{dense:!0,sx:{flex:1,overflow:`auto`},children:o.map(e=>(0,Z.jsxs)(Ot,{onClick:()=>j(e),children:[(0,Z.jsx)(D,{children:(0,Z.jsx)(bn,{})}),(0,Z.jsx)(T,{primary:e.display_name,secondary:e.song_count===void 0?void 0:`${e.song_count} songs`}),(0,Z.jsx)(gn,{color:`action`})]},e.entity_id))}),t>1&&(0,Z.jsxs)(K,{sx:{display:`flex`,justifyContent:`center`,alignItems:`center`,gap:2,p:1,borderTop:1,borderColor:`divider`},children:[(0,Z.jsx)(G,{size:`small`,disabled:!n,onClick:()=>b(v-50),children:`Previous`}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,children:[`Page `,e,` of `,t]}),(0,Z.jsx)(G,{size:`small`,disabled:!i,onClick:()=>b(v+50),children:`Next`})]})]})}case`albums`:return(0,Z.jsxs)(r,{dense:!0,children:[c.map(e=>(0,Z.jsxs)(Ot,{onClick:()=>M(e),children:[(0,Z.jsx)(D,{children:(0,Z.jsx)(_n,{})}),(0,Z.jsx)(T,{primary:e.display_name,secondary:e.song_count===void 0?void 0:`${e.song_count} tracks`}),(0,Z.jsx)(gn,{color:`action`})]},e.entity_id)),c.length===0&&(0,Z.jsx)(K,{sx:{p:2,textAlign:`center`},children:(0,Z.jsx)(q,{color:`text.secondary`,children:`No albums found`})})]});case`tracks`:case`tag-search`:return(0,Z.jsxs)(r,{dense:!0,children:[u.map(e=>(0,Z.jsxs)(Ot,{onClick:()=>N(e),children:[(0,Z.jsx)(D,{children:(0,Z.jsx)(O,{})}),(0,Z.jsx)(T,{primary:e.title??e.path.split(`/`).pop(),secondary:`${e.artist??`Unknown`} - ${e.album??`Unknown`}`}),(0,Z.jsx)(gn,{color:`action`})]},e.file_id)),u.length===0&&(0,Z.jsx)(K,{sx:{p:2,textAlign:`center`},children:(0,Z.jsx)(q,{color:`text.secondary`,children:a.type===`tag-search`?`No matching tracks found`:`No tracks found`})})]});case`tags`:{let e=a.track.tags?.filter(e=>e.is_nomarr)??[],n=a.track.tags?.filter(e=>!e.is_nomarr)??[];return(0,Z.jsxs)(K,{sx:{p:2},children:[(0,Z.jsx)(q,{variant:`h6`,gutterBottom:!0,children:a.track.title??a.track.path.split(`/`).pop()}),(0,Z.jsxs)(q,{variant:`body2`,color:`text.secondary`,gutterBottom:!0,children:[a.track.artist,` - `,a.track.album]}),e.length>0&&(0,Z.jsxs)(K,{sx:{mt:2},children:[(0,Z.jsx)(q,{variant:`subtitle2`,gutterBottom:!0,children:`Nomarr Tags (click to find similar)`}),(0,Z.jsx)(t,{direction:`row`,flexWrap:`wrap`,gap:1,children:e.map((e,t)=>{let n=e.value;try{let t=JSON.parse(e.value);n=Array.isArray(t)&&t.length===1?typeof t[0]==`number`?t[0].toFixed(2):String(t[0]):typeof t==`number`?t.toFixed(2):String(t)}catch{}return(0,Z.jsx)(x,{icon:(0,Z.jsx)(yn,{}),label:`${e.key}: ${n}`,onClick:()=>P(e),variant:`outlined`,color:`primary`,size:`small`,sx:{cursor:`pointer`}},t)})})]}),n.length>0&&(0,Z.jsxs)(K,{sx:{mt:2},children:[(0,Z.jsx)(q,{variant:`subtitle2`,gutterBottom:!0,children:`Metadata Tags`}),(0,Z.jsx)(t,{direction:`row`,flexWrap:`wrap`,gap:1,children:n.slice(0,20).map((e,t)=>{let n=e.value;try{let t=JSON.parse(e.value);Array.isArray(t)&&t.length===1&&(n=String(t[0]))}catch{}return(0,Z.jsx)(x,{label:`${e.key}: ${n}`,onClick:()=>P(e),variant:`outlined`,size:`small`,sx:{cursor:`pointer`}},t)})})]})]})}}})()})]})}function An(){let[e,t]=(0,Q.useState)(`library`);return(0,Z.jsxs)(te,{title:`Library`,children:[(0,Z.jsxs)(g,{defaultExpanded:!0,disableGutters:!0,children:[(0,Z.jsx)(_,{expandIcon:(0,Z.jsx)(y,{}),children:(0,Z.jsx)(q,{variant:`h6`,sx:{fontWeight:600},children:`Library Management`})}),(0,Z.jsx)(v,{children:(0,Z.jsx)(Sn,{})})]}),(0,Z.jsx)(K,{sx:{borderBottom:1,borderColor:`divider`,mb:2,mt:3},children:(0,Z.jsxs)(hn,{value:e,onChange:(e,n)=>t(n),children:[(0,Z.jsx)(Wt,{label:`Library`,value:`library`}),(0,Z.jsx)(Wt,{label:`Artists`,value:`artists`}),(0,Z.jsx)(Wt,{label:`Albums`,value:`albums`}),(0,Z.jsx)(Wt,{label:`Genres`,value:`genres`}),(0,Z.jsx)(Wt,{label:`Years`,value:`years`})]})}),e===`library`?(0,Z.jsx)(K,{sx:{height:`calc(100vh - 200px)`},children:(0,Z.jsx)(kn,{})}):(0,Z.jsx)(En,{collection:e})]})}export{An as BrowsePage};