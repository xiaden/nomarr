import{t as e}from"./Stack-T04yclWk.js";import"./listItemTextClasses-CouBwO02.js";import{a as t,c as n,i as r,l as i,n as a,o,r as s,s as c,t as l,u}from"./TextField-B8Rfe9MI.js";import{n as d}from"./useControlled-eA17I6yq.js";import{i as f,n as p,r as m,t as h}from"./ExpandMore-DaafQ7_v.js";import{t as g}from"./Popper-DlX5m2sr.js";import{t as _}from"./Chip-DM4jfjFG.js";import{t as v}from"./Tooltip-BVuq8oYR.js";import{a as y,i as b,n as x,r as S,t as C}from"./TableRow-BwM4JDFI.js";import{t as w}from"./TableContainer-DDyNrnBW.js";import{Ct as ee,Et as te,Fn as ne,Kt as re,Ln as ie,Ot as T,Q as ae,St as oe,Tt as se,Wt as ce,Xt as E,Yt as le,Z as ue,Zt as de,a as fe,bn as D,ct as O,dt as pe,en as me,gt as k,hn as A,ht as j,i as he,it as M,kt as N,ln as ge,lt as _e,n as P,nn as F,o as ve,r as I,rt as ye,st as L,t as be,un as xe,ut as R,vn as z,wn as Se,wt as Ce,yn as B,yt as V}from"./index-D1CJpQaN.js";import{t as we}from"./Close-X20wBD8w.js";import{t as Te}from"./useNotification-DZLb0zra.js";var H=ie(ne());function Ee(e){let t=H.useRef({});return H.useEffect(()=>{t.current=e}),t.current}var De=Ee;function Oe({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function ke(e){return e.normalize(`NFD`).replace(/[\u0300-\u036f]/g,``)}function U(e={}){let{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i=`any`,stringify:a,trim:o=!1}=e;return(e,{inputValue:s,getOptionLabel:c})=>{let l=o?s.trim():s;n&&(l=l.toLowerCase()),t&&(l=ke(l));let u=l?e.filter(e=>{let r=(a||c)(e);return n&&(r=r.toLowerCase()),t&&(r=ke(r)),i===`start`?r.startsWith(l):r.includes(l)}):e;return typeof r==`number`?u.slice(0,r):u}}var Ae=U(),je=5,Me=e=>e.current!==null&&e.current.parentElement?.contains(document.activeElement),Ne=[];function Pe(e,t,n,r){if(t||e==null||r)return``;let i=n(e);return typeof i==`string`?i:``}function W(e){let{unstable_isActiveElementInListbox:t=Me,unstable_classNamePrefix:n=`Mui`,autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:o=!1,clearOnBlur:s=!e.freeSolo,clearOnEscape:c=!1,componentName:l=`useAutocomplete`,defaultValue:u=e.multiple?Ne:null,disableClearable:f=!1,disableCloseOnSelect:p=!1,disabled:m,disabledItemsFocusable:h=!1,disableListWrap:g=!1,filterOptions:_=Ae,filterSelectedOptions:v=!1,freeSolo:y=!1,getOptionDisabled:b,getOptionKey:x,getOptionLabel:S=e=>e.label??e,groupBy:C,handleHomeEndKeys:w=!e.freeSolo,id:ee,includeInputInList:te=!1,inputValue:ne,isOptionEqualToValue:ie=(e,t)=>e===t,multiple:T=!1,onChange:ae,onClose:oe,onHighlightChange:se,onInputChange:E,onOpen:le,open:ue,openOnFocus:de=!1,options:fe,readOnly:D=!1,renderValue:O,selectOnFocus:pe=!e.freeSolo,value:me}=e,k=xe(ee),A=S;A=e=>{let t=S(e);return typeof t==`string`?t:String(t)};let j=H.useRef(!1),he=H.useRef(!0),M=H.useRef(null),N=H.useRef(null),[ge,_e]=H.useState(null),[P,F]=H.useState(-1),ve=i?0:-1,I=H.useRef(ve),ye=H.useRef(Pe(u??me,T,A)).current,[L,be]=d({controlled:me,default:u,name:l}),[R,z]=d({controlled:ne,default:ye,name:l,state:`inputValue`}),[Se,Ce]=H.useState(!1),B=H.useCallback((e,t,n)=>{if(!(T?L.length<t.length:t!==null)&&!s)return;let r=Pe(t,T,A,O);R!==r&&(z(r),E&&E(e,r,n))},[A,R,T,E,z,s,L,O]),[V,we]=d({controlled:ue,default:!1,name:l,state:`open`}),[Te,Ee]=H.useState(!0),ke=!T&&L!=null&&R===A(L),U=V&&!D,W=U?_(fe.filter(e=>!(v&&(T?L:[L]).some(t=>t!==null&&ie(e,t)))),{inputValue:ke&&Te?``:R,getOptionLabel:A}):[],G=De({filteredOptions:W,value:L,inputValue:R});H.useEffect(()=>{let e=L!==G.value;Se&&!e||y&&!e||B(null,L,`reset`)},[L,B,Se,G.value,y]);let Fe=V&&W.length>0&&!D,K=ce(e=>{if(e===-1)M.current.focus();else{let t=O?`data-item-index`:`data-tag-index`;ge.querySelector(`[${t}="${e}"]`).focus()}});H.useEffect(()=>{T&&P>L.length-1&&(F(-1),K(-1))},[L,T,P,K]);function Ie(e,t){if(!N.current||e<0||e>=W.length)return-1;let n=e;for(;;){let r=N.current.querySelector(`[data-option-index="${n}"]`),i=h?!1:!r||r.disabled||r.getAttribute(`aria-disabled`)===`true`;if(r&&r.hasAttribute(`tabindex`)&&!i)return n;if(n=t===`next`?(n+1)%W.length:(n-1+W.length)%W.length,n===e)return-1}}let Le=ce(({event:e,index:t,reason:r})=>{if(I.current=t,t===-1?M.current.removeAttribute(`aria-activedescendant`):M.current.setAttribute(`aria-activedescendant`,`${k}-option-${t}`),se&&[`mouse`,`keyboard`,`touch`].includes(r)&&se(e,t===-1?null:W[t],r),!N.current)return;let i=N.current.querySelector(`[role="option"].${n}-focused`);i&&(i.classList.remove(`${n}-focused`),i.classList.remove(`${n}-focusVisible`));let a=N.current;if(N.current.getAttribute(`role`)!==`listbox`&&(a=N.current.parentElement.querySelector(`[role="listbox"]`)),!a)return;if(t===-1){a.scrollTop=0;return}let o=N.current.querySelector(`[data-option-index="${t}"]`);if(o&&(o.classList.add(`${n}-focused`),r===`keyboard`&&o.classList.add(`${n}-focusVisible`),a.scrollHeight>a.clientHeight&&r!==`mouse`&&r!==`touch`)){let e=o,t=a.clientHeight+a.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?a.scrollTop=n-a.clientHeight:e.offsetTop-e.offsetHeight*(C?1.3:0)<a.scrollTop&&(a.scrollTop=e.offsetTop-e.offsetHeight*(C?1.3:0))}}),q=ce(({event:e,diff:t,direction:n=`next`,reason:i})=>{if(!U)return;let a=Ie((()=>{let e=W.length-1;if(t===`reset`)return ve;if(t===`start`)return 0;if(t===`end`)return e;let n=I.current+t;return n<0?n===-1&&te?-1:g&&I.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&te?-1:g||Math.abs(t)>1?e:0:n})(),n);if(Le({index:a,reason:i,event:e}),r&&t!==`reset`)if(a===-1)M.current.value=R;else{let e=A(W[a]);M.current.value=e,e.toLowerCase().indexOf(R.toLowerCase())===0&&R.length>0&&M.current.setSelectionRange(R.length,e.length)}}),Re=!Oe({array1:G.filteredOptions,array2:W,parser:A}),ze=()=>{if(I.current!==-1&&!Oe({array1:G.filteredOptions,array2:W,parser:A})&&G.inputValue===R&&(T?L.length===G.value.length&&G.value.every((e,t)=>A(L[t])===A(e)):((e,t)=>(e?A(e):``)===(t?A(t):``))(G.value,L))){let e=G.filteredOptions[I.current];if(e)return W.findIndex(t=>A(t)===A(e))}return-1},J=H.useCallback(()=>{if(!U)return;let e=ze();if(e!==-1){I.current=e;return}let t=T?L[0]:L;if(W.length===0||t==null){q({diff:`reset`});return}if(N.current){if(t!=null){let e=W[I.current];if(T&&e&&L.findIndex(t=>ie(e,t))!==-1)return;let n=W.findIndex(e=>ie(e,t));n===-1?q({diff:`reset`}):Le({index:n});return}if(I.current>=W.length-1){Le({index:W.length-1});return}Le({index:I.current})}},[W.length,T?!1:L,q,Le,U,R,T]),Be=ce(e=>{re(N,e),e&&J()});H.useEffect(()=>{(Re||U)&&J()},[J,Re,U]);let Ve=e=>{V||(we(!0),Ee(!0),le&&le(e))},He=(e,t)=>{V&&(we(!1),oe&&oe(e,t))},Y=(e,t,n,r)=>{if(T){if(L.length===t.length&&L.every((e,n)=>e===t[n]))return}else if(L===t)return;ae&&ae(e,t,n,r),be(t)},Ue=H.useRef(!1),We=(e,t,n=`selectOption`,r=`options`)=>{let i=n,a=t;if(T){a=Array.isArray(L)?L.slice():[];let e=a.findIndex(e=>ie(t,e));e===-1?a.push(t):r!==`freeSolo`&&(a.splice(e,1),i=`removeOption`)}B(e,a,i),Y(e,a,i,{option:t}),!p&&(!e||!e.ctrlKey&&!e.metaKey)&&He(e,i),(o===!0||o===`touch`&&Ue.current||o===`mouse`&&!Ue.current)&&M.current.blur()};function Ge(e,t){if(e===-1)return-1;let n=e;for(;;){if(t===`next`&&n===L.length||t===`previous`&&n===-1)return-1;let e=O?`data-item-index`:`data-tag-index`,r=ge.querySelector(`[${e}="${n}"]`);if(!r||!r.hasAttribute(`tabindex`)||r.disabled||r.getAttribute(`aria-disabled`)===`true`)n+=t===`next`?1:-1;else return n}}let Ke=(e,t)=>{if(!T)return;R===``&&He(e,`toggleInput`);let n=P;P===-1&&t===`previous`?(n=L.length-1,y&&R!==``&&(z(``),E&&E(e,``,`reset`))):(n+=t===`next`?1:-1,n<0&&(n=0),n===L.length&&(n=-1)),n=Ge(n,t),F(n),K(n)},qe=e=>{j.current=!0,z(``),E&&E(e,``,`clear`),Y(e,T?[]:null,`clear`)},Je=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(P!==-1&&![`ArrowLeft`,`ArrowRight`].includes(t.key)&&(F(-1),K(-1)),t.which!==229))switch(t.key){case`Home`:U&&w&&(t.preventDefault(),q({diff:`start`,direction:`next`,reason:`keyboard`,event:t}));break;case`End`:U&&w&&(t.preventDefault(),q({diff:`end`,direction:`previous`,reason:`keyboard`,event:t}));break;case`PageUp`:t.preventDefault(),q({diff:-je,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`PageDown`:t.preventDefault(),q({diff:je,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowDown`:t.preventDefault(),q({diff:1,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowUp`:t.preventDefault(),q({diff:-1,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowLeft`:{let e=M.current;if(!(e&&e.selectionStart===0&&e.selectionEnd===0))return;!T&&O&&L!=null?(y&&R!==``&&(z(``),E&&E(t,``,`reset`)),F(0),K(0)):Ke(t,`previous`);break}case`ArrowRight`:!T&&O?(F(-1),K(-1)):Ke(t,`next`);break;case`Enter`:if(I.current!==-1&&U){let e=W[I.current],n=b?b(e):!1;if(t.preventDefault(),n)return;We(t,e,`selectOption`),r&&M.current.setSelectionRange(M.current.value.length,M.current.value.length)}else y&&R!==``&&ke===!1&&(T&&t.preventDefault(),We(t,R,`createOption`,`freeSolo`));break;case`Escape`:U?(t.preventDefault(),t.stopPropagation(),He(t,`escape`)):c&&(R!==``||T&&L.length>0||O)&&(t.preventDefault(),t.stopPropagation(),qe(t));break;case`Backspace`:if(T&&!D&&R===``&&L.length>0){let e=P===-1?L.length-1:P,n=L.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:L[e]})}!T&&O&&!D&&R===``&&Y(t,null,`removeOption`,{option:L});break;case`Delete`:if(T&&!D&&R===``&&L.length>0&&P!==-1){let e=P,n=L.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:L[e]})}!T&&O&&!D&&R===``&&Y(t,null,`removeOption`,{option:L});break;default:}},Ye=e=>{Ce(!0),P!==-1&&(F(-1),K(-1)),de&&!j.current&&Ve(e)},Xe=e=>{if(t(N)){M.current.focus();return}Ce(!1),he.current=!0,j.current=!1,a&&I.current!==-1&&U?We(e,W[I.current],`blur`):a&&y&&R!==``?We(e,R,`blur`,`freeSolo`):s&&B(e,L,`blur`),He(e,`blur`)},Ze=e=>{let t=e.target.value;R!==t&&(z(t),Ee(!1),E&&E(e,t,`input`)),t===``?!f&&!T&&!O&&Y(e,null,`clear`):Ve(e)},Qe=e=>{let t=Number(e.currentTarget.getAttribute(`data-option-index`));I.current!==t&&Le({event:e,index:t,reason:`mouse`})},$e=e=>{Le({event:e,index:Number(e.currentTarget.getAttribute(`data-option-index`)),reason:`touch`}),Ue.current=!0},et=e=>{We(e,W[Number(e.currentTarget.getAttribute(`data-option-index`))],`selectOption`),Ue.current=!1},tt=e=>t=>{let n=L.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:L[e]})},X=e=>{Y(e,null,`removeOption`,{option:L})},nt=e=>{V?He(e,`toggleInput`):Ve(e)},rt=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute(`id`)!==k&&e.preventDefault()},it=e=>{e.currentTarget.contains(e.target)&&(M.current.focus(),pe&&he.current&&M.current.selectionEnd-M.current.selectionStart===0&&M.current.select(),he.current=!1)},at=e=>{!m&&(R===``||!V)&&nt(e)},ot=y&&R.length>0;ot||=T?L.length>0:L!==null;let st=W;return C&&(st=W.reduce((e,t,n)=>{let r=C(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),m&&Se&&Xe(),{getRootProps:(e={})=>({...e,onKeyDown:Je(e),onMouseDown:rt,onClick:it}),getInputLabelProps:()=>({id:`${k}-label`,htmlFor:k}),getInputProps:()=>({id:k,value:R,onBlur:Xe,onFocus:Ye,onChange:Ze,onMouseDown:at,"aria-activedescendant":U?``:null,"aria-autocomplete":r?`both`:`list`,"aria-controls":Fe?`${k}-listbox`:void 0,"aria-expanded":Fe,autoComplete:`off`,ref:M,autoCapitalize:`none`,spellCheck:`false`,role:`combobox`,disabled:m}),getClearProps:()=>({tabIndex:-1,type:`button`,onClick:qe}),getItemProps:({index:e=0}={})=>({...T&&{key:e},...O?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!D&&{onDelete:T?tt(e):X}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:`button`,onClick:nt}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!D&&{onDelete:tt(e)}}),getListboxProps:()=>({role:`listbox`,id:`${k}-listbox`,"aria-labelledby":`${k}-label`,ref:Be,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{let n=(T?L:[L]).some(e=>e!=null&&ie(t,e)),r=b?b(t):!1;return{key:x?.(t)??A(t),tabIndex:-1,role:`option`,id:`${k}-option-${e}`,onMouseMove:Qe,onClick:et,onTouchStart:$e,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:k,inputValue:R,value:L,dirty:ot,expanded:U&&ge,popupOpen:U,focused:Se||P!==-1,anchorEl:ge,setAnchorEl:_e,focusedItem:P,focusedTag:P,groupedOptions:st}}var G=W;function Fe(e){return B(`MuiListSubheader`,e)}z(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var K=ie(Se()),Ie=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return ge({root:[`root`,n!==`default`&&`color${de(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},Fe,t)},Le=F(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${de(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(E(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),q=H.forwardRef(function(e,t){let n=me({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,K.jsx)(Le,{as:a,className:D(Ie(u).root,r),ref:t,ownerState:u,...l})});q&&(q.muiSkipListHighlight=!0);var Re=q;function ze(e){return B(`MuiAutocomplete`,e)}var J=z(`MuiAutocomplete`,`root.expanded.fullWidth.focused.focusVisible.tag.tagSizeSmall.tagSizeMedium.hasPopupIcon.hasClearIcon.inputRoot.input.inputFocused.endAdornment.clearIndicator.popupIndicator.popupIndicatorOpen.popper.popperDisablePortal.paper.listbox.loading.noOptions.option.groupLabel.groupUl`.split(`.`)),Be,Ve,He=e=>{let{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:a,hasClearIcon:o,hasPopupIcon:s,inputFocused:c,popupOpen:l,size:u}=e;return ge({root:[`root`,r&&`expanded`,i&&`focused`,a&&`fullWidth`,o&&`hasClearIcon`,s&&`hasPopupIcon`],inputRoot:[`inputRoot`],input:[`input`,c&&`inputFocused`],tag:[`tag`,`tagSize${de(u)}`],endAdornment:[`endAdornment`],clearIndicator:[`clearIndicator`],popupIndicator:[`popupIndicator`,l&&`popupIndicatorOpen`],popper:[`popper`,n&&`popperDisablePortal`],paper:[`paper`],listbox:[`listbox`],loading:[`loading`],noOptions:[`noOptions`],option:[`option`],groupLabel:[`groupLabel`],groupUl:[`groupUl`]},ze,t)},Y=F(`div`,{name:`MuiAutocomplete`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:a,inputFocused:o,size:s}=n;return[{[`& .${J.tag}`]:t.tag},{[`& .${J.tag}`]:t[`tagSize${de(s)}`]},{[`& .${J.inputRoot}`]:t.inputRoot},{[`& .${J.input}`]:t.input},{[`& .${J.input}`]:o&&t.inputFocused},t.root,r&&t.fullWidth,a&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${J.focused} .${J.clearIndicator}`]:{visibility:`visible`},"@media (pointer: fine)":{[`&:hover .${J.clearIndicator}`]:{visibility:`visible`}},[`& .${J.tag}`]:{margin:3,maxWidth:`calc(100% - 6px)`},[`& .${J.inputRoot}`]:{[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:30},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:56},[`& .${J.input}`]:{width:0,minWidth:30}},[`& .${i.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:`4px 4px 4px 0px`}},[`& .${i.root}.${u.sizeSmall}`]:{[`& .${i.input}`]:{padding:`2px 4px 3px 0`}},[`& .${n.root}`]:{padding:9,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${J.input}`]:{padding:`7.5px 4px 7.5px 5px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${n.root}.${u.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${J.input}`]:{padding:`2.5px 4px 2.5px 8px`}},[`& .${c.root}`]:{paddingTop:19,paddingLeft:8,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${c.input}`]:{padding:`7px 4px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${c.root}.${u.sizeSmall}`]:{paddingBottom:1,[`& .${c.input}`]:{padding:`2.5px 4px`}},[`& .${u.hiddenLabel}`]:{paddingTop:8},[`& .${c.root}.${u.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${J.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${c.root}.${u.hiddenLabel}.${u.sizeSmall}`]:{[`& .${J.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${J.input}`]:{flexGrow:1,textOverflow:`ellipsis`,opacity:0},variants:[{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{[`& .${J.tag}`]:{margin:2,maxWidth:`calc(100% - 4px)`}}},{props:{inputFocused:!0},style:{[`& .${J.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${J.inputRoot}`]:{flexWrap:`wrap`}}}]}),Ue=F(`div`,{name:`MuiAutocomplete`,slot:`EndAdornment`})({position:`absolute`,right:0,top:`50%`,transform:`translate(0, -50%)`}),We=F(ee,{name:`MuiAutocomplete`,slot:`ClearIndicator`})({marginRight:-2,padding:4,visibility:`hidden`}),Ge=F(ee,{name:`MuiAutocomplete`,slot:`PopupIndicator`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:`rotate(180deg)`}}]}),Ke=F(g,{name:`MuiAutocomplete`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${J.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(E(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:`absolute`}}]}))),qe=F(T,{name:`MuiAutocomplete`,slot:`Paper`})(E(({theme:e})=>({...e.typography.body1,overflow:`auto`}))),Je=F(`div`,{name:`MuiAutocomplete`,slot:`Loading`})(E(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Ye=F(`div`,{name:`MuiAutocomplete`,slot:`NoOptions`})(E(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Xe=F(`ul`,{name:`MuiAutocomplete`,slot:`Listbox`})(E(({theme:e})=>({listStyle:`none`,margin:0,padding:`8px 0`,maxHeight:`40vh`,overflow:`auto`,position:`relative`,[`& .${J.option}`]:{minHeight:48,display:`flex`,overflow:`hidden`,justifyContent:`flex-start`,alignItems:`center`,cursor:`pointer`,paddingTop:6,boxSizing:`border-box`,outline:`0`,WebkitTapHighlightColor:`transparent`,paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up(`sm`)]:{minHeight:`auto`},[`&.${J.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:`none`},[`&.${J.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${J.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${J.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Ze=F(Re,{name:`MuiAutocomplete`,slot:`GroupLabel`})(E(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),Qe=F(`ul`,{name:`MuiAutocomplete`,slot:`GroupUl`})({padding:0,[`& .${J.option}`]:{paddingLeft:24}}),$e=H.forwardRef(function(e,t){let n=me({props:e,name:`MuiAutocomplete`}),{autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:s=!1,ChipProps:c,className:l,clearIcon:u=Be||=(0,K.jsx)(oe,{fontSize:`small`}),clearOnBlur:d=!n.freeSolo,clearOnEscape:f=!1,clearText:p=`Clear`,closeText:m=`Close`,componentsProps:h,defaultValue:v=n.multiple?[]:null,disableClearable:y=!1,disableCloseOnSelect:b=!1,disabled:x=!1,disabledItemsFocusable:S=!1,disableListWrap:C=!1,disablePortal:w=!1,filterOptions:ee,filterSelectedOptions:te=!1,forcePopupIcon:ne=`auto`,freeSolo:re=!1,fullWidth:ie=!1,getLimitTagsText:ae=e=>`+${e}`,getOptionDisabled:se,getOptionKey:ce,getOptionLabel:E,isOptionEqualToValue:le,groupBy:ue,handleHomeEndKeys:de=!n.freeSolo,id:fe,includeInputInList:O=!1,inputValue:pe,limitTags:k=-1,ListboxComponent:A,ListboxProps:j,loading:he=!1,loadingText:M=`Loading…`,multiple:ge=!1,noOptionsText:_e=`No options`,onChange:P,onClose:F,onHighlightChange:ve,onInputChange:I,onOpen:ye,open:L,openOnFocus:be=!1,openText:xe=`Open`,options:R,PaperComponent:z,PopperComponent:Se,popupIcon:Ce=Ve||=(0,K.jsx)(o,{}),readOnly:B=!1,renderGroup:V,renderInput:we,renderOption:Te,renderTags:Ee,renderValue:De,selectOnFocus:Oe=!n.freeSolo,size:ke=`medium`,slots:U={},slotProps:Ae={},value:je,...Me}=n,{getRootProps:Ne,getInputProps:Pe,getInputLabelProps:W,getPopupIndicatorProps:Fe,getClearProps:Ie,getItemProps:Le,getListboxProps:q,getOptionProps:Re,value:ze,dirty:J,expanded:$e,id:et,popupOpen:tt,focused:X,focusedItem:nt,anchorEl:rt,setAnchorEl:it,inputValue:at,groupedOptions:ot}=G({...n,componentName:`Autocomplete`}),st=!y&&!x&&J&&!B,ct=(!re||ne===!0)&&ne!==!1,{onMouseDown:Z}=Pe(),{ref:lt,...ut}=q(),dt=E||(e=>e.label??e),Q={...n,disablePortal:w,expanded:$e,focused:X,fullWidth:ie,getOptionLabel:dt,hasClearIcon:st,hasPopupIcon:ct,inputFocused:nt===-1,popupOpen:tt,size:ke},$=He(Q),ft={slots:{paper:z,popper:Se,...U},slotProps:{chip:c,listbox:j,...h,...Ae}},[pt,mt]=N(`listbox`,{elementType:Xe,externalForwardedProps:ft,ownerState:Q,className:$.listbox,additionalProps:ut,ref:lt}),[ht,gt]=N(`paper`,{elementType:T,externalForwardedProps:ft,ownerState:Q,className:$.paper}),[_t,vt]=N(`popper`,{elementType:g,externalForwardedProps:ft,ownerState:Q,className:$.popper,additionalProps:{disablePortal:w,style:{width:rt?rt.clientWidth:null},role:`presentation`,anchorEl:rt,open:tt}}),yt,bt=e=>({className:$.tag,disabled:x,...Le(e)});if(ge?ze.length>0&&(yt=Ee?Ee(ze,bt,Q):De?De(ze,bt,Q):ze.map((e,t)=>{let{key:n,...r}=bt({index:t});return(0,K.jsx)(_,{label:dt(e),size:ke,...r,...ft.slotProps.chip},n)})):De&&ze!=null&&(yt=De(ze,bt,Q)),k>-1&&Array.isArray(yt)){let e=yt.length-k;!X&&e>0&&(yt=yt.splice(0,k),yt.push((0,K.jsx)(`span`,{className:$.tag,children:ae(e)},yt.length)))}let xt=V||(e=>(0,K.jsxs)(`li`,{children:[(0,K.jsx)(Ze,{className:$.groupLabel,ownerState:Q,component:`div`,children:e.group}),(0,K.jsx)(Qe,{className:$.groupUl,ownerState:Q,children:e.children})]},e.key)),St=Te||((e,t)=>{let{key:n,...r}=e;return(0,K.jsx)(`li`,{...r,children:dt(t)},n)}),Ct=(e,t)=>{let n=Re({option:e,index:t});return St({...n,className:$.option},e,{selected:n[`aria-selected`],index:t,inputValue:at},Q)},wt=ft.slotProps.clearIndicator,Tt=ft.slotProps.popupIndicator;return(0,K.jsxs)(H.Fragment,{children:[(0,K.jsx)(Y,{ref:t,className:D($.root,l),ownerState:Q,...Ne(Me),children:we({id:et,disabled:x,fullWidth:!0,size:ke===`small`?`small`:void 0,InputLabelProps:W(),InputProps:{ref:it,className:$.inputRoot,startAdornment:yt,onMouseDown:e=>{e.target===e.currentTarget&&Z(e)},...(st||ct)&&{endAdornment:(0,K.jsxs)(Ue,{className:$.endAdornment,ownerState:Q,children:[st?(0,K.jsx)(We,{...Ie(),"aria-label":p,title:p,ownerState:Q,...wt,className:D($.clearIndicator,wt?.className),children:u}):null,ct?(0,K.jsx)(Ge,{...Fe(),disabled:x,"aria-label":tt?m:xe,title:tt?m:xe,ownerState:Q,...Tt,className:D($.popupIndicator,Tt?.className),children:Ce}):null]})}},inputProps:{className:$.input,disabled:x,readOnly:B,...Pe()}})}),rt?(0,K.jsx)(Ke,{as:_t,...vt,children:(0,K.jsxs)(qe,{as:ht,...gt,children:[he&&ot.length===0?(0,K.jsx)(Je,{className:$.loading,ownerState:Q,children:M}):null,ot.length===0&&!re&&!he?(0,K.jsx)(Ye,{className:$.noOptions,ownerState:Q,role:`presentation`,onMouseDown:e=>{e.preventDefault()},children:_e}):null,ot.length>0?(0,K.jsx)(pt,{as:A,...mt,children:ot.map((e,t)=>ue?xt({key:e.key,group:e.group,children:e.options.map((t,n)=>Ct(t,e.index+n))}):Ct(e,t))}):null]})}):null]})});function et(e){return H.Children.toArray(e).filter(e=>H.isValidElement(e))}function tt(e){return B(`MuiToggleButton`,e)}var X=z(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),nt=H.createContext({}),rt=H.createContext(void 0);function it(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var at=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return ge({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${de(a)}`,o]},tt,t)},ot=F(te,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${de(n.size)}`]]}})(E(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${X.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${X.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(se()).map(([t])=>({props:{color:t},style:{[`&.${X.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),st=H.forwardRef(function(e,t){let{value:n,...r}=H.useContext(nt),i=H.useContext(rt),a=me({props:A({...r,selected:it(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,v={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},y=at(v),b=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},x=i||``;return(0,K.jsx)(ot,{className:D(r.className,y.root,s,x),disabled:l,focusRipple:!u,ref:t,onClick:b,onChange:f,value:g,ownerState:v,"aria-pressed":m,..._,children:o})});function ct(e){return B(`MuiToggleButtonGroup`,e)}var Z=z(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),lt=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return ge({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${de(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},ct,t)},ut=F(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${Z.grouped}`]:t.grouped},{[`& .${Z.grouped}`]:t[`grouped${de(n.orientation)}`]},{[`& .${Z.firstButton}`]:t.firstButton},{[`& .${Z.lastButton}`]:t.lastButton},{[`& .${Z.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(E(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${Z.grouped}`]:{[`&.${Z.selected} + .${Z.grouped}.${Z.selected}`]:{borderTop:0,marginTop:0}},[`& .${Z.firstButton},& .${Z.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${Z.lastButton},& .${Z.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${Z.lastButton}.${X.disabled},& .${Z.middleButton}.${X.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${Z.grouped}`]:{[`&.${Z.selected} + .${Z.grouped}.${Z.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${Z.firstButton},& .${Z.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${Z.lastButton},& .${Z.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${Z.lastButton}.${X.disabled},& .${Z.middleButton}.${X.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),dt=H.forwardRef(function(e,t){let n=me({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=lt(m),g=H.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=H.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=H.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=et(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,K.jsx)(ut,{role:`group`,className:D(h.root,i),ref:t,ownerState:m,...p,children:(0,K.jsx)(nt.Provider,{value:v,children:y.map((e,t)=>(0,K.jsx)(rt.Provider,{value:x(t),children:e},t))})})}),Q=le((0,K.jsx)(`path`,{d:`M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z`}),`Add`),$=le((0,K.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),ft=le((0,K.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`),pt=le((0,K.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z`}),`Delete`);function mt({preview:t,configText:n,loading:r,error:i,onLoadPreview:a,onGenerateConfig:o}){let{showSuccess:s}=Te();return(0,K.jsxs)(e,{spacing:2.5,children:[(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Navidrome TOML Configuration`}),(0,K.jsxs)(e,{spacing:1.25,children:[(0,K.jsx)(j,{onClick:a,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,K.jsx)(j,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,K.jsxs)(ue,{children:[`Error: `,i]})]}),t&&(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Tag Preview`}),(0,K.jsx)(k,{sx:{overflowX:`auto`},children:(0,K.jsxs)(y,{children:[(0,K.jsx)(x,{children:(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,K.jsx)(b,{children:t.map(e=>(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.tag_key}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.type}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.total_count}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Generated Config`}),(0,K.jsx)(l,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,K.jsx)(j,{onClick:()=>{n&&(navigator.clipboard.writeText(n),s(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}var ht=new Set([`artist`,`artists`,`album`,`album_artist`,`genre`,`year`,`date`,`bpm`,`composer`,`label`,`publisher`,`title`,`lyricist`]),gt=new Set([`year`,`bpm`]),_t={artist:`Artist`,artists:`Artists`,album:`Album`,album_artist:`Album Artist`,genre:`Genre`,year:`Year`,date:`Date`,bpm:`BPM`,composer:`Composer`,label:`Label`,publisher:`Publisher`,title:`Title`,lyricist:`Lyricist`,"nom:mood-loose":`Mood (Loose)`,"nom:mood-regular":`Mood (Regular)`,"nom:mood-strict":`Mood (Strict)`};function vt(e){return ht.has(e)||e.startsWith(`nom:mood-`)}function yt(){let[e,t]=(0,H.useState)([]),[n,r]=(0,H.useState)(!1),[i,a]=(0,H.useState)(null),o=(0,H.useCallback)(async()=>{try{r(!0),a(null),t(await he())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);(0,H.useEffect)(()=>{o()},[o]);let s=(0,H.useMemo)(()=>e.filter(e=>vt(e.key)).map(e=>({...e,type:gt.has(e.key)?`integer`:e.type,label:_t[e.key]??e.key})).sort((e,t)=>e.label.localeCompare(t.label)),[e]);return{tags:s,numericTags:(0,H.useMemo)(()=>s.filter(e=>e.type===`float`||e.type===`integer`),[s]),stringTags:(0,H.useMemo)(()=>s.filter(e=>e.type===`string`),[s]),loading:n,error:i,reload:o}}function bt({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,K.jsxs)(e,{spacing:1.5,children:[(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,K.jsx)(_,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,K.jsx)(w,{children:(0,K.jsxs)(y,{size:`small`,children:[(0,K.jsx)(x,{children:(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{children:`Title`}),(0,K.jsx)(S,{children:`Artist`}),(0,K.jsx)(S,{children:`Album`})]})}),(0,K.jsx)(b,{children:r.map((e,t)=>(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{children:e.title??`—`}),(0,K.jsx)(S,{children:e.artist??`—`}),(0,K.jsx)(S,{children:e.album??`—`})]},t))})]})}):(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,K.jsxs)(V,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var xt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`}],St=[{value:`contains`,label:`contains`},{value:`notcontains`,label:`not contains`},{value:`=`,label:`=`},{value:`!=`,label:`≠`}];function Ct({rule:n,numericTags:i,stringTags:o,onChange:c,onRemove:u}){let d=[...i,...o],f=d.find(e=>e.key===n.tagKey),p=f?.type===`float`||f?.type===`integer`,m=p?xt:St,[h,g]=(0,H.useState)([]),[_,y]=(0,H.useState)(!1),b=(0,H.useCallback)(async e=>{if(!e){g([]);return}try{y(!0),g(await fe(e))}catch{g([])}finally{y(!1)}},[]);return(0,H.useEffect)(()=>{b(n.tagKey)},[n.tagKey,b]),(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsxs)(t,{size:`small`,sx:{minWidth:180,flex:2},children:[(0,K.jsx)(r,{children:`Tag`}),(0,K.jsxs)(a,{value:n.tagKey,label:`Tag`,onChange:e=>{let t=e.target.value,r=d.find(e=>e.key===t),i=p,a=r?.type===`float`||r?.type===`integer`,o=i===a&&m.some(e=>e.value===n.operator),s=a?`=`:`contains`;c({...n,tagKey:t,operator:o?n.operator:s,value:i===a?n.value:``})},children:[i.length>0&&(0,K.jsx)(Re,{children:`Numeric`}),i.map(e=>(0,K.jsx)(s,{value:e.key,children:e.label},e.key)),o.length>0&&(0,K.jsx)(Re,{children:`Text`}),o.map(e=>(0,K.jsx)(s,{value:e.key,children:e.label},e.key))]})]}),(0,K.jsxs)(t,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,K.jsx)(r,{children:`Op`}),(0,K.jsx)(a,{value:n.operator,label:`Op`,onChange:e=>{c({...n,operator:e.target.value})},children:m.map(e=>(0,K.jsx)(s,{value:e.value,children:e.label},e.value))})]}),(0,K.jsx)($e,{size:`small`,freeSolo:!0,options:h,loading:_,value:n.value||null,inputValue:n.value,onInputChange:(e,t)=>{c({...n,value:t})},onChange:(e,t)=>{c({...n,value:t??``})},renderInput:e=>(0,K.jsx)(l,{...e,label:`Value`,type:p?`number`:`text`,inputProps:{...e.inputProps,...p?{step:`any`}:{}}}),sx:{flex:2,minWidth:160}}),(0,K.jsx)(v,{title:`Remove rule`,children:(0,K.jsx)(ee,{size:`small`,onClick:u,color:`error`,children:(0,K.jsx)(we,{fontSize:`small`})})})]})}var wt=1;function Tt(){return{id:String(wt++),tagKey:``,operator:`=`,value:``}}function Et(e=`all`){return{id:String(wt++),logic:e,rules:[],groups:[]}}function Dt(e){let t=[],n=e.rules.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`);t.push(...n);for(let n of e.groups){let e=Dt(n);e&&t.push(`(${e})`)}let r=e.logic===`all`?` AND `:` OR `;return t.join(r)}function Ot({group:t,numericTags:n,stringTags:r,depth:i=0,onGroupChange:a,onRemove:o}){let s=i===0,[c,l]=(0,H.useState)(!1),u=t.rules.length>0||t.groups.length>0,d=()=>{a({...t,rules:[...t.rules,Tt()]})},f=(e,n)=>{a({...t,rules:t.rules.map((t,r)=>r===e?n:t)})},p=e=>{a({...t,rules:t.rules.filter((t,n)=>n!==e)})},m=(e,n)=>{n&&a({...t,logic:n})},h=(e,n)=>{a({...t,groups:t.groups.map((t,r)=>r===e?n:t)})},g=e=>{a({...t,groups:t.groups.filter((t,n)=>n!==e)})},_=()=>{let e=Et(t.logic);a({...t,groups:[...t.groups,e]})},y=()=>{u?l(!0):o&&o()},b=()=>{l(!1),o&&o()},x=()=>{l(!1)};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(k,{sx:s?{}:{border:1,borderColor:`divider`,borderRadius:1,p:2,ml:2},children:(0,K.jsxs)(e,{spacing:1.5,children:[(0,K.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,children:s?`Match`:`Group match`}),(0,K.jsxs)(dt,{value:t.logic,exclusive:!0,onChange:m,size:`small`,children:[(0,K.jsx)(st,{value:`all`,children:`ALL`}),(0,K.jsx)(st,{value:`any`,children:`ANY`})]}),!s&&o&&(0,K.jsx)(v,{title:`Remove group`,children:(0,K.jsx)(ee,{size:`small`,onClick:y,color:`error`,sx:{ml:`auto`},children:(0,K.jsx)(pt,{fontSize:`small`})})})]}),t.rules.map((e,t)=>(0,K.jsx)(Ct,{rule:e,numericTags:n,stringTags:r,onChange:e=>f(t,e),onRemove:()=>p(t)},e.id)),t.groups.map((e,t)=>(0,K.jsx)(Ot,{group:e,numericTags:n,stringTags:r,depth:i+1,onGroupChange:e=>h(t,e),onRemove:()=>g(t)},e.id)),(0,K.jsxs)(e,{direction:`row`,spacing:1,children:[(0,K.jsx)(j,{startIcon:(0,K.jsx)(Q,{}),onClick:d,variant:`outlined`,size:`small`,children:`Add Rule`}),(0,K.jsx)(j,{startIcon:(0,K.jsx)(Q,{}),onClick:_,variant:`outlined`,size:`small`,children:`Add Group`})]})]})}),(0,K.jsxs)(pe,{open:c,onClose:x,children:[(0,K.jsx)(L,{children:`Remove Group?`}),(0,K.jsx)(_e,{children:(0,K.jsxs)(O,{children:[`This group contains `,t.rules.length,` rule(s) and`,` `,t.groups.length,` nested group(s). Are you sure you want to remove it?`]})}),(0,K.jsxs)(R,{children:[(0,K.jsx)(j,{onClick:x,children:`Cancel`}),(0,K.jsx)(j,{onClick:b,color:`error`,autoFocus:!0,children:`Remove`})]})]})]})}function kt({rootGroup:t,numericTags:n,stringTags:r,onGroupChange:i}){return(0,K.jsx)(e,{spacing:1.5,children:(0,K.jsx)(Ot,{group:t,numericTags:n,stringTags:r,depth:0,onGroupChange:i})})}var At=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function jt(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function Mt({value:n,onChange:i}){let{column:o,descending:c}=jt(n);return(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsxs)(t,{size:`small`,sx:{minWidth:140},children:[(0,K.jsx)(r,{children:`Sort by`}),(0,K.jsx)(a,{value:o,label:`Sort by`,onChange:e=>{let t=e.target.value;i(c?`-${t}`:t)},children:At.map(e=>(0,K.jsx)(s,{value:e.value,children:e.label},e.value))})]}),o!==`random`&&(0,K.jsx)(v,{title:c?`Descending`:`Ascending`,children:(0,K.jsx)(ee,{size:`small`,onClick:()=>{i(c?o:`-${o}`)},children:c?(0,K.jsx)($,{}):(0,K.jsx)(ft,{})})})]})}function Nt({rootGroup:t,name:n,comment:r,limit:i,sort:a,preview:o,content:s,loading:c,error:u,onGroupChange:d,onNameChange:f,onCommentChange:p,onLimitChange:m,onSortChange:h,onPreview:g,onGenerate:_}){let{numericTags:v,stringTags:y,loading:b}=yt(),x=Dt(t),S=x.length>0;return(0,K.jsxs)(e,{spacing:2.5,children:[(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Smart Playlist Generator`}),(0,K.jsxs)(e,{spacing:2,children:[b?(0,K.jsxs)(k,{sx:{display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,py:4,gap:2},children:[(0,K.jsx)(Ce,{size:40}),(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,children:`Loading tag metadata…`})]}):(0,K.jsx)(kt,{rootGroup:t,numericTags:v,stringTags:y,onGroupChange:d}),x&&(0,K.jsx)(l,{value:x,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,K.jsxs)(k,{children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,K.jsx)(l,{value:n,onChange:e=>f(e.target.value),disabled:c,required:!0,fullWidth:!0,size:`small`})]}),(0,K.jsxs)(k,{children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,K.jsx)(l,{value:r,onChange:e=>p(e.target.value),disabled:c,fullWidth:!0,size:`small`})]}),(0,K.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,K.jsxs)(k,{children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,K.jsx)(Mt,{value:a,onChange:h})]}),(0,K.jsxs)(k,{children:[(0,K.jsx)(V,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,K.jsx)(l,{type:`number`,value:i??``,onChange:e=>m(e.target.value?parseInt(e.target.value):void 0),disabled:c,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,K.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,K.jsx)(j,{variant:`contained`,disabled:c||!S,onClick:g,fullWidth:!0,children:c?`Loading…`:`Preview Query`}),(0,K.jsx)(j,{variant:`contained`,disabled:c||!S,onClick:_,fullWidth:!0,children:c?`Generating…`:`Generate .nsp`})]})]}),u&&(0,K.jsxs)(ue,{children:[`Error: `,u]})]}),o&&(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Query Preview`}),(0,K.jsx)(bt,{data:o})]}),s&&(0,K.jsxs)(M,{children:[(0,K.jsx)(ye,{title:`Generated Playlist (.nsp)`}),(0,K.jsx)(l,{multiline:!0,rows:15,value:s,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,K.jsx)(j,{onClick:()=>{if(s){let e=new Blob([s],{type:`text/plain`}),t=URL.createObjectURL(e),r=document.createElement(`a`);r.href=t,r.download=`${n}.nsp`,r.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Pt(){let{showError:e}=Te(),[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(null),[a,o]=(0,H.useState)(!1),[s,c]=(0,H.useState)(null),[l,u]=(0,H.useState)(()=>{let e=Et(`all`);return e.rules=[Tt()],e}),[d,f]=(0,H.useState)(`My Playlist`),[p,m]=(0,H.useState)(``),[h,g]=(0,H.useState)(void 0),[_,v]=(0,H.useState)(``),[y,b]=(0,H.useState)(null),[x,S]=(0,H.useState)(null),[C,w]=(0,H.useState)(!1),[ee,te]=(0,H.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRootGroup:l,playlistName:d,playlistComment:p,playlistLimit:h,playlistSort:_,playlistPreview:y,playlistContent:x,playlistLoading:C,playlistError:ee,loadConfigPreview:async()=>{try{o(!0),c(null),n((await I()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await P()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}try{w(!0),te(null),b(await ve(t,10))}catch(e){te(e instanceof Error?e.message:`Failed to preview playlist`)}finally{w(!1)}},generatePlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}if(!d.trim()){e(`Playlist name is required`);return}try{w(!0),te(null),S((await be({query:t,playlist_name:d,comment:p,limit:h,sort:_||void 0})).content)}catch(e){te(e instanceof Error?e.message:`Failed to generate playlist`)}finally{w(!1)}},setPlaylistRootGroup:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:g,setPlaylistSort:v}}function Ft(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRootGroup:a,playlistName:o,playlistComment:s,playlistLimit:c,playlistSort:l,playlistPreview:u,playlistContent:d,playlistLoading:g,playlistError:_,loadConfigPreview:v,generateConfig:y,previewPlaylist:b,generatePlaylist:x,setPlaylistRootGroup:S,setPlaylistName:C,setPlaylistComment:w,setPlaylistLimit:ee,setPlaylistSort:te}=Pt();return(0,K.jsx)(ae,{title:`Navidrome`,children:(0,K.jsxs)(e,{spacing:2,children:[(0,K.jsxs)(f,{defaultExpanded:!0,disableGutters:!0,children:[(0,K.jsx)(p,{expandIcon:(0,K.jsx)(h,{}),children:(0,K.jsx)(V,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,K.jsx)(m,{children:(0,K.jsx)(mt,{preview:t,configText:n,loading:r,error:i,onLoadPreview:v,onGenerateConfig:y})})]}),(0,K.jsxs)(f,{disableGutters:!0,children:[(0,K.jsx)(p,{expandIcon:(0,K.jsx)(h,{}),children:(0,K.jsx)(V,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,K.jsx)(m,{children:(0,K.jsx)(Nt,{rootGroup:a,name:o,comment:s,limit:c,sort:l,preview:u,content:d,loading:g,error:_,onGroupChange:S,onNameChange:C,onCommentChange:w,onLimitChange:ee,onSortChange:te,onPreview:b,onGenerate:x})})]})]})})}export{Ft as NavidromePage};