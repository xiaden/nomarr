import{t as e}from"./Stack-w1xYDcum.js";import"./listItemTextClasses-CgipUtFw.js";import{a as t,c as n,i as r,l as i,n as a,o,r as s,s as c,t as l,u}from"./TextField-65tSb973.js";import{i as d,t as f}from"./ExpandMore-Cq3ctwFm.js";import{n as p,r as m,t as h}from"./AccordionSummary-D3vtyIPR.js";import{t as g}from"./Popper-Cfpqlo-9.js";import{t as _}from"./Chip-SdAcBgo3.js";import{t as v}from"./Tooltip-B9JkGwoa.js";import{a as y,i as b,n as x,r as S,t as C}from"./TableRow-dYf_5cAZ.js";import{t as ee}from"./TableContainer-D8OJGtFj.js";import{Ct as te,Et as ne,Fn as re,Kt as ie,Ln as ae,Ot as w,Q as oe,St as se,Tt as ce,Wt as le,Xt as T,Yt as ue,Z as de,Zt as fe,a as pe,bn as E,ct as D,dt as me,en as he,gt as O,hn as k,ht as A,i as ge,it as j,kt as M,ln as _e,lt as ve,n as N,nn as P,o as ye,r as F,rt as be,st as I,t as xe,un as Se,ut as L,vn as R,wn as Ce,wt as we,yn as z,yt as B}from"./index-DivvbpKW.js";import{t as Te}from"./Add-BwGVPmd9.js";import{t as Ee}from"./Close-BeLE-mnl.js";import{t as De}from"./useNotification-BBwliify.js";var V=ae(re());function Oe(e){let t=V.useRef({});return V.useEffect(()=>{t.current=e}),t.current}var ke=Oe;function Ae({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function H(e){return e.normalize(`NFD`).replace(/[\u0300-\u036f]/g,``)}function U(e={}){let{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i=`any`,stringify:a,trim:o=!1}=e;return(e,{inputValue:s,getOptionLabel:c})=>{let l=o?s.trim():s;n&&(l=l.toLowerCase()),t&&(l=H(l));let u=l?e.filter(e=>{let r=(a||c)(e);return n&&(r=r.toLowerCase()),t&&(r=H(r)),i===`start`?r.startsWith(l):r.includes(l)}):e;return typeof r==`number`?u.slice(0,r):u}}var je=U(),Me=5,Ne=e=>e.current!==null&&e.current.parentElement?.contains(document.activeElement),Pe=[];function Fe(e,t,n,r){if(t||e==null||r)return``;let i=n(e);return typeof i==`string`?i:``}function W(e){let{unstable_isActiveElementInListbox:t=Ne,unstable_classNamePrefix:n=`Mui`,autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:o=!1,clearOnBlur:s=!e.freeSolo,clearOnEscape:c=!1,componentName:l=`useAutocomplete`,defaultValue:u=e.multiple?Pe:null,disableClearable:f=!1,disableCloseOnSelect:p=!1,disabled:m,disabledItemsFocusable:h=!1,disableListWrap:g=!1,filterOptions:_=je,filterSelectedOptions:v=!1,freeSolo:y=!1,getOptionDisabled:b,getOptionKey:x,getOptionLabel:S=e=>e.label??e,groupBy:C,handleHomeEndKeys:ee=!e.freeSolo,id:te,includeInputInList:ne=!1,inputValue:re,isOptionEqualToValue:ae=(e,t)=>e===t,multiple:w=!1,onChange:oe,onClose:se,onHighlightChange:ce,onInputChange:T,onOpen:ue,open:de,openOnFocus:fe=!1,options:pe,readOnly:E=!1,renderValue:D,selectOnFocus:me=!e.freeSolo,value:he}=e,O=Se(te),k=S;k=e=>{let t=S(e);return typeof t==`string`?t:String(t)};let A=V.useRef(!1),ge=V.useRef(!0),j=V.useRef(null),M=V.useRef(null),[_e,ve]=V.useState(null),[N,P]=V.useState(-1),ye=i?0:-1,F=V.useRef(ye),be=V.useRef(Fe(u??he,w,k)).current,[I,xe]=d({controlled:he,default:u,name:l}),[L,R]=d({controlled:re,default:be,name:l,state:`inputValue`}),[Ce,we]=V.useState(!1),z=V.useCallback((e,t,n)=>{if(!(w?I.length<t.length:t!==null)&&!s)return;let r=Fe(t,w,k,D);L!==r&&(R(r),T&&T(e,r,n))},[k,L,w,T,R,s,I,D]),[B,Te]=d({controlled:de,default:!1,name:l,state:`open`}),[Ee,De]=V.useState(!0),Oe=!w&&I!=null&&L===k(I),H=B&&!E,U=H?_(pe.filter(e=>!(v&&(w?I:[I]).some(t=>t!==null&&ae(e,t)))),{inputValue:Oe&&Ee?``:L,getOptionLabel:k}):[],W=ke({filteredOptions:U,value:I,inputValue:L});V.useEffect(()=>{let e=I!==W.value;Ce&&!e||y&&!e||z(null,I,`reset`)},[I,z,Ce,W.value,y]);let Ie=B&&U.length>0&&!E,Le=le(e=>{if(e===-1)j.current.focus();else{let t=D?`data-item-index`:`data-tag-index`;_e.querySelector(`[${t}="${e}"]`).focus()}});V.useEffect(()=>{w&&N>I.length-1&&(P(-1),Le(-1))},[I,w,N,Le]);function G(e,t){if(!M.current||e<0||e>=U.length)return-1;let n=e;for(;;){let r=M.current.querySelector(`[data-option-index="${n}"]`),i=h?!1:!r||r.disabled||r.getAttribute(`aria-disabled`)===`true`;if(r&&r.hasAttribute(`tabindex`)&&!i)return n;if(n=t===`next`?(n+1)%U.length:(n-1+U.length)%U.length,n===e)return-1}}let Re=le(({event:e,index:t,reason:r})=>{if(F.current=t,t===-1?j.current.removeAttribute(`aria-activedescendant`):j.current.setAttribute(`aria-activedescendant`,`${O}-option-${t}`),ce&&[`mouse`,`keyboard`,`touch`].includes(r)&&ce(e,t===-1?null:U[t],r),!M.current)return;let i=M.current.querySelector(`[role="option"].${n}-focused`);i&&(i.classList.remove(`${n}-focused`),i.classList.remove(`${n}-focusVisible`));let a=M.current;if(M.current.getAttribute(`role`)!==`listbox`&&(a=M.current.parentElement.querySelector(`[role="listbox"]`)),!a)return;if(t===-1){a.scrollTop=0;return}let o=M.current.querySelector(`[data-option-index="${t}"]`);if(o&&(o.classList.add(`${n}-focused`),r===`keyboard`&&o.classList.add(`${n}-focusVisible`),a.scrollHeight>a.clientHeight&&r!==`mouse`&&r!==`touch`)){let e=o,t=a.clientHeight+a.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?a.scrollTop=n-a.clientHeight:e.offsetTop-e.offsetHeight*(C?1.3:0)<a.scrollTop&&(a.scrollTop=e.offsetTop-e.offsetHeight*(C?1.3:0))}}),K=le(({event:e,diff:t,direction:n=`next`,reason:i})=>{if(!H)return;let a=G((()=>{let e=U.length-1;if(t===`reset`)return ye;if(t===`start`)return 0;if(t===`end`)return e;let n=F.current+t;return n<0?n===-1&&ne?-1:g&&F.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&ne?-1:g||Math.abs(t)>1?e:0:n})(),n);if(Re({index:a,reason:i,event:e}),r&&t!==`reset`)if(a===-1)j.current.value=L;else{let e=k(U[a]);j.current.value=e,e.toLowerCase().indexOf(L.toLowerCase())===0&&L.length>0&&j.current.setSelectionRange(L.length,e.length)}}),ze=!Ae({array1:W.filteredOptions,array2:U,parser:k}),q=()=>{if(F.current!==-1&&!Ae({array1:W.filteredOptions,array2:U,parser:k})&&W.inputValue===L&&(w?I.length===W.value.length&&W.value.every((e,t)=>k(I[t])===k(e)):((e,t)=>(e?k(e):``)===(t?k(t):``))(W.value,I))){let e=W.filteredOptions[F.current];if(e)return U.findIndex(t=>k(t)===k(e))}return-1},Be=V.useCallback(()=>{if(!H)return;let e=q();if(e!==-1){F.current=e;return}let t=w?I[0]:I;if(U.length===0||t==null){K({diff:`reset`});return}if(M.current){if(t!=null){let e=U[F.current];if(w&&e&&I.findIndex(t=>ae(e,t))!==-1)return;let n=U.findIndex(e=>ae(e,t));n===-1?K({diff:`reset`}):Re({index:n});return}if(F.current>=U.length-1){Re({index:U.length-1});return}Re({index:F.current})}},[U.length,w?!1:I,K,Re,H,L,w]),J=le(e=>{ie(M,e),e&&Be()});V.useEffect(()=>{(ze||H)&&Be()},[Be,ze,H]);let Ve=e=>{B||(Te(!0),De(!0),ue&&ue(e))},He=(e,t)=>{B&&(Te(!1),se&&se(e,t))},Y=(e,t,n,r)=>{if(w){if(I.length===t.length&&I.every((e,n)=>e===t[n]))return}else if(I===t)return;oe&&oe(e,t,n,r),xe(t)},Ue=V.useRef(!1),We=(e,t,n=`selectOption`,r=`options`)=>{let i=n,a=t;if(w){a=Array.isArray(I)?I.slice():[];let e=a.findIndex(e=>ae(t,e));e===-1?a.push(t):r!==`freeSolo`&&(a.splice(e,1),i=`removeOption`)}z(e,a,i),Y(e,a,i,{option:t}),!p&&(!e||!e.ctrlKey&&!e.metaKey)&&He(e,i),(o===!0||o===`touch`&&Ue.current||o===`mouse`&&!Ue.current)&&j.current.blur()};function Ge(e,t){if(e===-1)return-1;let n=e;for(;;){if(t===`next`&&n===I.length||t===`previous`&&n===-1)return-1;let e=D?`data-item-index`:`data-tag-index`,r=_e.querySelector(`[${e}="${n}"]`);if(!r||!r.hasAttribute(`tabindex`)||r.disabled||r.getAttribute(`aria-disabled`)===`true`)n+=t===`next`?1:-1;else return n}}let Ke=(e,t)=>{if(!w)return;L===``&&He(e,`toggleInput`);let n=N;N===-1&&t===`previous`?(n=I.length-1,y&&L!==``&&(R(``),T&&T(e,``,`reset`))):(n+=t===`next`?1:-1,n<0&&(n=0),n===I.length&&(n=-1)),n=Ge(n,t),P(n),Le(n)},qe=e=>{A.current=!0,R(``),T&&T(e,``,`clear`),Y(e,w?[]:null,`clear`)},Je=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(N!==-1&&![`ArrowLeft`,`ArrowRight`].includes(t.key)&&(P(-1),Le(-1)),t.which!==229))switch(t.key){case`Home`:H&&ee&&(t.preventDefault(),K({diff:`start`,direction:`next`,reason:`keyboard`,event:t}));break;case`End`:H&&ee&&(t.preventDefault(),K({diff:`end`,direction:`previous`,reason:`keyboard`,event:t}));break;case`PageUp`:t.preventDefault(),K({diff:-Me,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`PageDown`:t.preventDefault(),K({diff:Me,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowDown`:t.preventDefault(),K({diff:1,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowUp`:t.preventDefault(),K({diff:-1,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowLeft`:{let e=j.current;if(!(e&&e.selectionStart===0&&e.selectionEnd===0))return;!w&&D&&I!=null?(y&&L!==``&&(R(``),T&&T(t,``,`reset`)),P(0),Le(0)):Ke(t,`previous`);break}case`ArrowRight`:!w&&D?(P(-1),Le(-1)):Ke(t,`next`);break;case`Enter`:if(F.current!==-1&&H){let e=U[F.current],n=b?b(e):!1;if(t.preventDefault(),n)return;We(t,e,`selectOption`),r&&j.current.setSelectionRange(j.current.value.length,j.current.value.length)}else y&&L!==``&&Oe===!1&&(w&&t.preventDefault(),We(t,L,`createOption`,`freeSolo`));break;case`Escape`:H?(t.preventDefault(),t.stopPropagation(),He(t,`escape`)):c&&(L!==``||w&&I.length>0||D)&&(t.preventDefault(),t.stopPropagation(),qe(t));break;case`Backspace`:if(w&&!E&&L===``&&I.length>0){let e=N===-1?I.length-1:N,n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&Y(t,null,`removeOption`,{option:I});break;case`Delete`:if(w&&!E&&L===``&&I.length>0&&N!==-1){let e=N,n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&Y(t,null,`removeOption`,{option:I});break;default:}},Ye=e=>{we(!0),N!==-1&&(P(-1),Le(-1)),fe&&!A.current&&Ve(e)},Xe=e=>{if(t(M)){j.current.focus();return}we(!1),ge.current=!0,A.current=!1,a&&F.current!==-1&&H?We(e,U[F.current],`blur`):a&&y&&L!==``?We(e,L,`blur`,`freeSolo`):s&&z(e,I,`blur`),He(e,`blur`)},Ze=e=>{let t=e.target.value;L!==t&&(R(t),De(!1),T&&T(e,t,`input`)),t===``?!f&&!w&&!D&&Y(e,null,`clear`):Ve(e)},Qe=e=>{let t=Number(e.currentTarget.getAttribute(`data-option-index`));F.current!==t&&Re({event:e,index:t,reason:`mouse`})},$e=e=>{Re({event:e,index:Number(e.currentTarget.getAttribute(`data-option-index`)),reason:`touch`}),Ue.current=!0},et=e=>{We(e,U[Number(e.currentTarget.getAttribute(`data-option-index`))],`selectOption`),Ue.current=!1},tt=e=>t=>{let n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})},nt=e=>{Y(e,null,`removeOption`,{option:I})},rt=e=>{B?He(e,`toggleInput`):Ve(e)},it=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute(`id`)!==O&&e.preventDefault()},at=e=>{e.currentTarget.contains(e.target)&&(j.current.focus(),me&&ge.current&&j.current.selectionEnd-j.current.selectionStart===0&&j.current.select(),ge.current=!1)},ot=e=>{!m&&(L===``||!B)&&rt(e)},st=y&&L.length>0;st||=w?I.length>0:I!==null;let ct=U;return C&&(ct=U.reduce((e,t,n)=>{let r=C(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),m&&Ce&&Xe(),{getRootProps:(e={})=>({...e,onKeyDown:Je(e),onMouseDown:it,onClick:at}),getInputLabelProps:()=>({id:`${O}-label`,htmlFor:O}),getInputProps:()=>({id:O,value:L,onBlur:Xe,onFocus:Ye,onChange:Ze,onMouseDown:ot,"aria-activedescendant":H?``:null,"aria-autocomplete":r?`both`:`list`,"aria-controls":Ie?`${O}-listbox`:void 0,"aria-expanded":Ie,autoComplete:`off`,ref:j,autoCapitalize:`none`,spellCheck:`false`,role:`combobox`,disabled:m}),getClearProps:()=>({tabIndex:-1,type:`button`,onClick:qe}),getItemProps:({index:e=0}={})=>({...w&&{key:e},...D?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!E&&{onDelete:w?tt(e):nt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:`button`,onClick:rt}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!E&&{onDelete:tt(e)}}),getListboxProps:()=>({role:`listbox`,id:`${O}-listbox`,"aria-labelledby":`${O}-label`,ref:J,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{let n=(w?I:[I]).some(e=>e!=null&&ae(t,e)),r=b?b(t):!1;return{key:x?.(t)??k(t),tabIndex:-1,role:`option`,id:`${O}-option-${e}`,onMouseMove:Qe,onClick:et,onTouchStart:$e,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:O,inputValue:L,value:I,dirty:st,expanded:H&&_e,popupOpen:H,focused:Ce||N!==-1,anchorEl:_e,setAnchorEl:ve,focusedItem:N,focusedTag:N,groupedOptions:ct}}var Ie=W;function Le(e){return z(`MuiListSubheader`,e)}R(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var G=ae(Ce()),Re=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return _e({root:[`root`,n!==`default`&&`color${fe(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},Le,t)},K=P(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${fe(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(T(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),ze=V.forwardRef(function(e,t){let n=he({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,G.jsx)(K,{as:a,className:E(Re(u).root,r),ref:t,ownerState:u,...l})});ze&&(ze.muiSkipListHighlight=!0);var q=ze;function Be(e){return z(`MuiAutocomplete`,e)}var J=R(`MuiAutocomplete`,`root.expanded.fullWidth.focused.focusVisible.tag.tagSizeSmall.tagSizeMedium.hasPopupIcon.hasClearIcon.inputRoot.input.inputFocused.endAdornment.clearIndicator.popupIndicator.popupIndicatorOpen.popper.popperDisablePortal.paper.listbox.loading.noOptions.option.groupLabel.groupUl`.split(`.`)),Ve,He,Y=e=>{let{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:a,hasClearIcon:o,hasPopupIcon:s,inputFocused:c,popupOpen:l,size:u}=e;return _e({root:[`root`,r&&`expanded`,i&&`focused`,a&&`fullWidth`,o&&`hasClearIcon`,s&&`hasPopupIcon`],inputRoot:[`inputRoot`],input:[`input`,c&&`inputFocused`],tag:[`tag`,`tagSize${fe(u)}`],endAdornment:[`endAdornment`],clearIndicator:[`clearIndicator`],popupIndicator:[`popupIndicator`,l&&`popupIndicatorOpen`],popper:[`popper`,n&&`popperDisablePortal`],paper:[`paper`],listbox:[`listbox`],loading:[`loading`],noOptions:[`noOptions`],option:[`option`],groupLabel:[`groupLabel`],groupUl:[`groupUl`]},Be,t)},Ue=P(`div`,{name:`MuiAutocomplete`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:a,inputFocused:o,size:s}=n;return[{[`& .${J.tag}`]:t.tag},{[`& .${J.tag}`]:t[`tagSize${fe(s)}`]},{[`& .${J.inputRoot}`]:t.inputRoot},{[`& .${J.input}`]:t.input},{[`& .${J.input}`]:o&&t.inputFocused},t.root,r&&t.fullWidth,a&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${J.focused} .${J.clearIndicator}`]:{visibility:`visible`},"@media (pointer: fine)":{[`&:hover .${J.clearIndicator}`]:{visibility:`visible`}},[`& .${J.tag}`]:{margin:3,maxWidth:`calc(100% - 6px)`},[`& .${J.inputRoot}`]:{[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:30},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:56},[`& .${J.input}`]:{width:0,minWidth:30}},[`& .${i.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:`4px 4px 4px 0px`}},[`& .${i.root}.${u.sizeSmall}`]:{[`& .${i.input}`]:{padding:`2px 4px 3px 0`}},[`& .${n.root}`]:{padding:9,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${J.input}`]:{padding:`7.5px 4px 7.5px 5px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${n.root}.${u.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${J.input}`]:{padding:`2.5px 4px 2.5px 8px`}},[`& .${c.root}`]:{paddingTop:19,paddingLeft:8,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${c.input}`]:{padding:`7px 4px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${c.root}.${u.sizeSmall}`]:{paddingBottom:1,[`& .${c.input}`]:{padding:`2.5px 4px`}},[`& .${u.hiddenLabel}`]:{paddingTop:8},[`& .${c.root}.${u.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${J.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${c.root}.${u.hiddenLabel}.${u.sizeSmall}`]:{[`& .${J.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${J.input}`]:{flexGrow:1,textOverflow:`ellipsis`,opacity:0},variants:[{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{[`& .${J.tag}`]:{margin:2,maxWidth:`calc(100% - 4px)`}}},{props:{inputFocused:!0},style:{[`& .${J.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${J.inputRoot}`]:{flexWrap:`wrap`}}}]}),We=P(`div`,{name:`MuiAutocomplete`,slot:`EndAdornment`})({position:`absolute`,right:0,top:`50%`,transform:`translate(0, -50%)`}),Ge=P(te,{name:`MuiAutocomplete`,slot:`ClearIndicator`})({marginRight:-2,padding:4,visibility:`hidden`}),Ke=P(te,{name:`MuiAutocomplete`,slot:`PopupIndicator`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:`rotate(180deg)`}}]}),qe=P(g,{name:`MuiAutocomplete`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${J.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(T(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:`absolute`}}]}))),Je=P(w,{name:`MuiAutocomplete`,slot:`Paper`})(T(({theme:e})=>({...e.typography.body1,overflow:`auto`}))),Ye=P(`div`,{name:`MuiAutocomplete`,slot:`Loading`})(T(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Xe=P(`div`,{name:`MuiAutocomplete`,slot:`NoOptions`})(T(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Ze=P(`ul`,{name:`MuiAutocomplete`,slot:`Listbox`})(T(({theme:e})=>({listStyle:`none`,margin:0,padding:`8px 0`,maxHeight:`40vh`,overflow:`auto`,position:`relative`,[`& .${J.option}`]:{minHeight:48,display:`flex`,overflow:`hidden`,justifyContent:`flex-start`,alignItems:`center`,cursor:`pointer`,paddingTop:6,boxSizing:`border-box`,outline:`0`,WebkitTapHighlightColor:`transparent`,paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up(`sm`)]:{minHeight:`auto`},[`&.${J.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:`none`},[`&.${J.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${J.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${J.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Qe=P(q,{name:`MuiAutocomplete`,slot:`GroupLabel`})(T(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),$e=P(`ul`,{name:`MuiAutocomplete`,slot:`GroupUl`})({padding:0,[`& .${J.option}`]:{paddingLeft:24}}),et=V.forwardRef(function(e,t){let n=he({props:e,name:`MuiAutocomplete`}),{autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:s=!1,ChipProps:c,className:l,clearIcon:u=Ve||=(0,G.jsx)(se,{fontSize:`small`}),clearOnBlur:d=!n.freeSolo,clearOnEscape:f=!1,clearText:p=`Clear`,closeText:m=`Close`,componentsProps:h,defaultValue:v=n.multiple?[]:null,disableClearable:y=!1,disableCloseOnSelect:b=!1,disabled:x=!1,disabledItemsFocusable:S=!1,disableListWrap:C=!1,disablePortal:ee=!1,filterOptions:te,filterSelectedOptions:ne=!1,forcePopupIcon:re=`auto`,freeSolo:ie=!1,fullWidth:ae=!1,getLimitTagsText:oe=e=>`+${e}`,getOptionDisabled:ce,getOptionKey:le,getOptionLabel:T,isOptionEqualToValue:ue,groupBy:de,handleHomeEndKeys:fe=!n.freeSolo,id:pe,includeInputInList:D=!1,inputValue:me,limitTags:O=-1,ListboxComponent:k,ListboxProps:A,loading:ge=!1,loadingText:j=`Loading…`,multiple:_e=!1,noOptionsText:ve=`No options`,onChange:N,onClose:P,onHighlightChange:ye,onInputChange:F,onOpen:be,open:I,openOnFocus:xe=!1,openText:Se=`Open`,options:L,PaperComponent:R,PopperComponent:Ce,popupIcon:we=He||=(0,G.jsx)(o,{}),readOnly:z=!1,renderGroup:B,renderInput:Te,renderOption:Ee,renderTags:De,renderValue:Oe,selectOnFocus:ke=!n.freeSolo,size:Ae=`medium`,slots:H={},slotProps:U={},value:je,...Me}=n,{getRootProps:Ne,getInputProps:Pe,getInputLabelProps:Fe,getPopupIndicatorProps:W,getClearProps:Le,getItemProps:Re,getListboxProps:K,getOptionProps:ze,value:q,dirty:Be,expanded:J,id:et,popupOpen:tt,focused:nt,focusedItem:rt,anchorEl:it,setAnchorEl:at,inputValue:ot,groupedOptions:st}=Ie({...n,componentName:`Autocomplete`}),ct=!y&&!x&&Be&&!z,lt=(!ie||re===!0)&&re!==!1,{onMouseDown:ut}=Pe(),{ref:X,...dt}=K(),ft=T||(e=>e.label??e),Z={...n,disablePortal:ee,expanded:J,focused:nt,fullWidth:ae,getOptionLabel:ft,hasClearIcon:ct,hasPopupIcon:lt,inputFocused:rt===-1,popupOpen:tt,size:Ae},Q=Y(Z),pt={slots:{paper:R,popper:Ce,...H},slotProps:{chip:c,listbox:A,...h,...U}},[mt,ht]=M(`listbox`,{elementType:Ze,externalForwardedProps:pt,ownerState:Z,className:Q.listbox,additionalProps:dt,ref:X}),[gt,_t]=M(`paper`,{elementType:w,externalForwardedProps:pt,ownerState:Z,className:Q.paper}),[vt,yt]=M(`popper`,{elementType:g,externalForwardedProps:pt,ownerState:Z,className:Q.popper,additionalProps:{disablePortal:ee,style:{width:it?it.clientWidth:null},role:`presentation`,anchorEl:it,open:tt}}),$,bt=e=>({className:Q.tag,disabled:x,...Re(e)});if(_e?q.length>0&&($=De?De(q,bt,Z):Oe?Oe(q,bt,Z):q.map((e,t)=>{let{key:n,...r}=bt({index:t});return(0,G.jsx)(_,{label:ft(e),size:Ae,...r,...pt.slotProps.chip},n)})):Oe&&q!=null&&($=Oe(q,bt,Z)),O>-1&&Array.isArray($)){let e=$.length-O;!nt&&e>0&&($=$.splice(0,O),$.push((0,G.jsx)(`span`,{className:Q.tag,children:oe(e)},$.length)))}let xt=B||(e=>(0,G.jsxs)(`li`,{children:[(0,G.jsx)(Qe,{className:Q.groupLabel,ownerState:Z,component:`div`,children:e.group}),(0,G.jsx)($e,{className:Q.groupUl,ownerState:Z,children:e.children})]},e.key)),St=Ee||((e,t)=>{let{key:n,...r}=e;return(0,G.jsx)(`li`,{...r,children:ft(t)},n)}),Ct=(e,t)=>{let n=ze({option:e,index:t});return St({...n,className:Q.option},e,{selected:n[`aria-selected`],index:t,inputValue:ot},Z)},wt=pt.slotProps.clearIndicator,Tt=pt.slotProps.popupIndicator;return(0,G.jsxs)(V.Fragment,{children:[(0,G.jsx)(Ue,{ref:t,className:E(Q.root,l),ownerState:Z,...Ne(Me),children:Te({id:et,disabled:x,fullWidth:!0,size:Ae===`small`?`small`:void 0,InputLabelProps:Fe(),InputProps:{ref:at,className:Q.inputRoot,startAdornment:$,onMouseDown:e=>{e.target===e.currentTarget&&ut(e)},...(ct||lt)&&{endAdornment:(0,G.jsxs)(We,{className:Q.endAdornment,ownerState:Z,children:[ct?(0,G.jsx)(Ge,{...Le(),"aria-label":p,title:p,ownerState:Z,...wt,className:E(Q.clearIndicator,wt?.className),children:u}):null,lt?(0,G.jsx)(Ke,{...W(),disabled:x,"aria-label":tt?m:Se,title:tt?m:Se,ownerState:Z,...Tt,className:E(Q.popupIndicator,Tt?.className),children:we}):null]})}},inputProps:{className:Q.input,disabled:x,readOnly:z,...Pe()}})}),it?(0,G.jsx)(qe,{as:vt,...yt,children:(0,G.jsxs)(Je,{as:gt,..._t,children:[ge&&st.length===0?(0,G.jsx)(Ye,{className:Q.loading,ownerState:Z,children:j}):null,st.length===0&&!ie&&!ge?(0,G.jsx)(Xe,{className:Q.noOptions,ownerState:Z,role:`presentation`,onMouseDown:e=>{e.preventDefault()},children:ve}):null,st.length>0?(0,G.jsx)(mt,{as:k,...ht,children:st.map((e,t)=>de?xt({key:e.key,group:e.group,children:e.options.map((t,n)=>Ct(t,e.index+n))}):Ct(e,t))}):null]})}):null]})});function tt(e){return V.Children.toArray(e).filter(e=>V.isValidElement(e))}function nt(e){return z(`MuiToggleButton`,e)}var rt=R(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),it=V.createContext({}),at=V.createContext(void 0);function ot(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var st=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return _e({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${fe(a)}`,o]},nt,t)},ct=P(ne,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${fe(n.size)}`]]}})(T(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${rt.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${rt.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(ce()).map(([t])=>({props:{color:t},style:{[`&.${rt.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),lt=V.forwardRef(function(e,t){let{value:n,...r}=V.useContext(it),i=V.useContext(at),a=he({props:k({...r,selected:ot(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,v={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},y=st(v),b=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},x=i||``;return(0,G.jsx)(ct,{className:E(r.className,y.root,s,x),disabled:l,focusRipple:!u,ref:t,onClick:b,onChange:f,value:g,ownerState:v,"aria-pressed":m,..._,children:o})});function ut(e){return z(`MuiToggleButtonGroup`,e)}var X=R(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),dt=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return _e({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${fe(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},ut,t)},ft=P(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${fe(n.orientation)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(T(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderTop:0,marginTop:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${X.lastButton}.${rt.disabled},& .${X.middleButton}.${rt.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${X.lastButton}.${rt.disabled},& .${X.middleButton}.${rt.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),Z=V.forwardRef(function(e,t){let n=he({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=dt(m),g=V.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=V.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=V.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=tt(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,G.jsx)(ft,{role:`group`,className:E(h.root,i),ref:t,ownerState:m,...p,children:(0,G.jsx)(it.Provider,{value:v,children:y.map((e,t)=>(0,G.jsx)(at.Provider,{value:x(t),children:e},t))})})}),Q=ue((0,G.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),pt=ue((0,G.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`),mt=ue((0,G.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z`}),`Delete`);function ht({preview:t,configText:n,loading:r,error:i,onLoadPreview:a,onGenerateConfig:o}){let{showSuccess:s}=De();return(0,G.jsxs)(e,{spacing:2.5,children:[(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Navidrome TOML Configuration`}),(0,G.jsxs)(e,{spacing:1.25,children:[(0,G.jsx)(A,{onClick:a,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,G.jsx)(A,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,G.jsxs)(de,{children:[`Error: `,i]})]}),t&&(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Tag Preview`}),(0,G.jsx)(O,{sx:{overflowX:`auto`},children:(0,G.jsxs)(y,{children:[(0,G.jsx)(x,{children:(0,G.jsxs)(C,{children:[(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,G.jsx)(b,{children:t.map(e=>(0,G.jsxs)(C,{children:[(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.tag_key}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.type}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.total_count}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Generated Config`}),(0,G.jsx)(l,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,G.jsx)(A,{onClick:()=>{n&&(navigator.clipboard.writeText(n),s(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}var gt=new Set([`artist`,`artists`,`album`,`album_artist`,`genre`,`year`,`date`,`bpm`,`composer`,`label`,`publisher`,`title`,`lyricist`]),_t=new Set([`year`,`bpm`]),vt={artist:`Artist`,artists:`Artists`,album:`Album`,album_artist:`Album Artist`,genre:`Genre`,year:`Year`,date:`Date`,bpm:`BPM`,composer:`Composer`,label:`Label`,publisher:`Publisher`,title:`Title`,lyricist:`Lyricist`,"nom:mood-loose":`Mood (Loose)`,"nom:mood-regular":`Mood (Regular)`,"nom:mood-strict":`Mood (Strict)`};function yt(e){return gt.has(e)||e.startsWith(`nom:mood-`)}function $(){let[e,t]=(0,V.useState)([]),[n,r]=(0,V.useState)(!1),[i,a]=(0,V.useState)(null),o=(0,V.useCallback)(async()=>{try{r(!0),a(null),t(await ge())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);(0,V.useEffect)(()=>{o()},[o]);let s=(0,V.useMemo)(()=>e.filter(e=>yt(e.key)).map(e=>({...e,type:_t.has(e.key)?`integer`:e.type,label:vt[e.key]??e.key})).sort((e,t)=>e.label.localeCompare(t.label)),[e]);return{tags:s,numericTags:(0,V.useMemo)(()=>s.filter(e=>e.type===`float`||e.type===`integer`),[s]),stringTags:(0,V.useMemo)(()=>s.filter(e=>e.type===`string`),[s]),loading:n,error:i,reload:o}}function bt({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,G.jsxs)(e,{spacing:1.5,children:[(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,G.jsx)(_,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,G.jsx)(ee,{children:(0,G.jsxs)(y,{size:`small`,children:[(0,G.jsx)(x,{children:(0,G.jsxs)(C,{children:[(0,G.jsx)(S,{children:`Title`}),(0,G.jsx)(S,{children:`Artist`}),(0,G.jsx)(S,{children:`Album`})]})}),(0,G.jsx)(b,{children:r.map((e,t)=>(0,G.jsxs)(C,{children:[(0,G.jsx)(S,{children:e.title??`—`}),(0,G.jsx)(S,{children:e.artist??`—`}),(0,G.jsx)(S,{children:e.album??`—`})]},t))})]})}):(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,G.jsxs)(B,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var xt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`}],St=[{value:`contains`,label:`contains`},{value:`notcontains`,label:`not contains`},{value:`=`,label:`=`},{value:`!=`,label:`≠`}];function Ct({rule:n,numericTags:i,stringTags:o,onChange:c,onRemove:u}){let d=[...i,...o],f=d.find(e=>e.key===n.tagKey),p=f?.type===`float`||f?.type===`integer`,m=p?xt:St,[h,g]=(0,V.useState)([]),[_,y]=(0,V.useState)(!1),b=(0,V.useCallback)(async e=>{if(!e){g([]);return}try{y(!0),g(await pe(e))}catch{g([])}finally{y(!1)}},[]);return(0,V.useEffect)(()=>{b(n.tagKey)},[n.tagKey,b]),(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsxs)(t,{size:`small`,sx:{minWidth:180,flex:2},children:[(0,G.jsx)(r,{children:`Tag`}),(0,G.jsxs)(a,{value:n.tagKey,label:`Tag`,onChange:e=>{let t=e.target.value,r=d.find(e=>e.key===t),i=p,a=r?.type===`float`||r?.type===`integer`,o=i===a&&m.some(e=>e.value===n.operator),s=a?`=`:`contains`;c({...n,tagKey:t,operator:o?n.operator:s,value:i===a?n.value:``})},children:[i.length>0&&(0,G.jsx)(q,{children:`Numeric`}),i.map(e=>(0,G.jsx)(s,{value:e.key,children:e.label},e.key)),o.length>0&&(0,G.jsx)(q,{children:`Text`}),o.map(e=>(0,G.jsx)(s,{value:e.key,children:e.label},e.key))]})]}),(0,G.jsxs)(t,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,G.jsx)(r,{children:`Op`}),(0,G.jsx)(a,{value:n.operator,label:`Op`,onChange:e=>{c({...n,operator:e.target.value})},children:m.map(e=>(0,G.jsx)(s,{value:e.value,children:e.label},e.value))})]}),(0,G.jsx)(et,{size:`small`,freeSolo:!0,options:h,loading:_,value:n.value||null,inputValue:n.value,onInputChange:(e,t)=>{c({...n,value:t})},onChange:(e,t)=>{c({...n,value:t??``})},renderInput:e=>(0,G.jsx)(l,{...e,label:`Value`,type:p?`number`:`text`,inputProps:{...e.inputProps,...p?{step:`any`}:{}}}),sx:{flex:2,minWidth:160}}),(0,G.jsx)(v,{title:`Remove rule`,children:(0,G.jsx)(te,{size:`small`,onClick:u,color:`error`,children:(0,G.jsx)(Ee,{fontSize:`small`})})})]})}var wt=1;function Tt(){return{id:String(wt++),tagKey:``,operator:`=`,value:``}}function Et(e=`all`){return{id:String(wt++),logic:e,rules:[],groups:[]}}function Dt(e){let t=[],n=e.rules.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`);t.push(...n);for(let n of e.groups){let e=Dt(n);e&&t.push(`(${e})`)}let r=e.logic===`all`?` AND `:` OR `;return t.join(r)}function Ot({group:t,numericTags:n,stringTags:r,depth:i=0,onGroupChange:a,onRemove:o}){let s=i===0,[c,l]=(0,V.useState)(!1),u=t.rules.length>0||t.groups.length>0,d=()=>{a({...t,rules:[...t.rules,Tt()]})},f=(e,n)=>{a({...t,rules:t.rules.map((t,r)=>r===e?n:t)})},p=e=>{a({...t,rules:t.rules.filter((t,n)=>n!==e)})},m=(e,n)=>{n&&a({...t,logic:n})},h=(e,n)=>{a({...t,groups:t.groups.map((t,r)=>r===e?n:t)})},g=e=>{a({...t,groups:t.groups.filter((t,n)=>n!==e)})},_=()=>{let e=Et(t.logic);a({...t,groups:[...t.groups,e]})},y=()=>{u?l(!0):o&&o()},b=()=>{l(!1),o&&o()},x=()=>{l(!1)};return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(O,{sx:s?{}:{border:1,borderColor:`divider`,borderRadius:1,p:2,ml:2},children:(0,G.jsxs)(e,{spacing:1.5,children:[(0,G.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,children:s?`Match`:`Group match`}),(0,G.jsxs)(Z,{value:t.logic,exclusive:!0,onChange:m,size:`small`,children:[(0,G.jsx)(lt,{value:`all`,children:`ALL`}),(0,G.jsx)(lt,{value:`any`,children:`ANY`})]}),!s&&o&&(0,G.jsx)(v,{title:`Remove group`,children:(0,G.jsx)(te,{size:`small`,onClick:y,color:`error`,sx:{ml:`auto`},children:(0,G.jsx)(mt,{fontSize:`small`})})})]}),t.rules.map((e,t)=>(0,G.jsx)(Ct,{rule:e,numericTags:n,stringTags:r,onChange:e=>f(t,e),onRemove:()=>p(t)},e.id)),t.groups.map((e,t)=>(0,G.jsx)(Ot,{group:e,numericTags:n,stringTags:r,depth:i+1,onGroupChange:e=>h(t,e),onRemove:()=>g(t)},e.id)),(0,G.jsxs)(e,{direction:`row`,spacing:1,children:[(0,G.jsx)(A,{startIcon:(0,G.jsx)(Te,{}),onClick:d,variant:`outlined`,size:`small`,children:`Add Rule`}),(0,G.jsx)(A,{startIcon:(0,G.jsx)(Te,{}),onClick:_,variant:`outlined`,size:`small`,children:`Add Group`})]})]})}),(0,G.jsxs)(me,{open:c,onClose:x,children:[(0,G.jsx)(I,{children:`Remove Group?`}),(0,G.jsx)(ve,{children:(0,G.jsxs)(D,{children:[`This group contains `,t.rules.length,` rule(s) and`,` `,t.groups.length,` nested group(s). Are you sure you want to remove it?`]})}),(0,G.jsxs)(L,{children:[(0,G.jsx)(A,{onClick:x,children:`Cancel`}),(0,G.jsx)(A,{onClick:b,color:`error`,autoFocus:!0,children:`Remove`})]})]})]})}function kt({rootGroup:t,numericTags:n,stringTags:r,onGroupChange:i}){return(0,G.jsx)(e,{spacing:1.5,children:(0,G.jsx)(Ot,{group:t,numericTags:n,stringTags:r,depth:0,onGroupChange:i})})}var At=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function jt(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function Mt({value:n,onChange:i}){let{column:o,descending:c}=jt(n);return(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsxs)(t,{size:`small`,sx:{minWidth:140},children:[(0,G.jsx)(r,{children:`Sort by`}),(0,G.jsx)(a,{value:o,label:`Sort by`,onChange:e=>{let t=e.target.value;i(c?`-${t}`:t)},children:At.map(e=>(0,G.jsx)(s,{value:e.value,children:e.label},e.value))})]}),o!==`random`&&(0,G.jsx)(v,{title:c?`Descending`:`Ascending`,children:(0,G.jsx)(te,{size:`small`,onClick:()=>{i(c?o:`-${o}`)},children:c?(0,G.jsx)(Q,{}):(0,G.jsx)(pt,{})})})]})}function Nt({rootGroup:t,name:n,comment:r,limit:i,sort:a,preview:o,content:s,loading:c,error:u,onGroupChange:d,onNameChange:f,onCommentChange:p,onLimitChange:m,onSortChange:h,onPreview:g,onGenerate:_}){let{numericTags:v,stringTags:y,loading:b}=$(),x=Dt(t),S=x.length>0;return(0,G.jsxs)(e,{spacing:2.5,children:[(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Smart Playlist Generator`}),(0,G.jsxs)(e,{spacing:2,children:[b?(0,G.jsxs)(O,{sx:{display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,py:4,gap:2},children:[(0,G.jsx)(we,{size:40}),(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`Loading tag metadata…`})]}):(0,G.jsx)(kt,{rootGroup:t,numericTags:v,stringTags:y,onGroupChange:d}),x&&(0,G.jsx)(l,{value:x,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,G.jsxs)(O,{children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,G.jsx)(l,{value:n,onChange:e=>f(e.target.value),disabled:c,required:!0,fullWidth:!0,size:`small`})]}),(0,G.jsxs)(O,{children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,G.jsx)(l,{value:r,onChange:e=>p(e.target.value),disabled:c,fullWidth:!0,size:`small`})]}),(0,G.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,G.jsxs)(O,{children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,G.jsx)(Mt,{value:a,onChange:h})]}),(0,G.jsxs)(O,{children:[(0,G.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,G.jsx)(l,{type:`number`,value:i??``,onChange:e=>m(e.target.value?parseInt(e.target.value):void 0),disabled:c,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,G.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,G.jsx)(A,{variant:`contained`,disabled:c||!S,onClick:g,fullWidth:!0,children:c?`Loading…`:`Preview Query`}),(0,G.jsx)(A,{variant:`contained`,disabled:c||!S,onClick:_,fullWidth:!0,children:c?`Generating…`:`Generate .nsp`})]})]}),u&&(0,G.jsxs)(de,{children:[`Error: `,u]})]}),o&&(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Query Preview`}),(0,G.jsx)(bt,{data:o})]}),s&&(0,G.jsxs)(j,{children:[(0,G.jsx)(be,{title:`Generated Playlist (.nsp)`}),(0,G.jsx)(l,{multiline:!0,rows:15,value:s,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,G.jsx)(A,{onClick:()=>{if(s){let e=new Blob([s],{type:`text/plain`}),t=URL.createObjectURL(e),r=document.createElement(`a`);r.href=t,r.download=`${n}.nsp`,r.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Pt(){let{showError:e}=De(),[t,n]=(0,V.useState)(null),[r,i]=(0,V.useState)(null),[a,o]=(0,V.useState)(!1),[s,c]=(0,V.useState)(null),[l,u]=(0,V.useState)(()=>{let e=Et(`all`);return e.rules=[Tt()],e}),[d,f]=(0,V.useState)(`My Playlist`),[p,m]=(0,V.useState)(``),[h,g]=(0,V.useState)(void 0),[_,v]=(0,V.useState)(``),[y,b]=(0,V.useState)(null),[x,S]=(0,V.useState)(null),[C,ee]=(0,V.useState)(!1),[te,ne]=(0,V.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRootGroup:l,playlistName:d,playlistComment:p,playlistLimit:h,playlistSort:_,playlistPreview:y,playlistContent:x,playlistLoading:C,playlistError:te,loadConfigPreview:async()=>{try{o(!0),c(null),n((await F()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await N()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}try{ee(!0),ne(null),b(await ye(t,10))}catch(e){ne(e instanceof Error?e.message:`Failed to preview playlist`)}finally{ee(!1)}},generatePlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}if(!d.trim()){e(`Playlist name is required`);return}try{ee(!0),ne(null),S((await xe({query:t,playlist_name:d,comment:p,limit:h,sort:_||void 0})).content)}catch(e){ne(e instanceof Error?e.message:`Failed to generate playlist`)}finally{ee(!1)}},setPlaylistRootGroup:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:g,setPlaylistSort:v}}function Ft(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRootGroup:a,playlistName:o,playlistComment:s,playlistLimit:c,playlistSort:l,playlistPreview:u,playlistContent:d,playlistLoading:g,playlistError:_,loadConfigPreview:v,generateConfig:y,previewPlaylist:b,generatePlaylist:x,setPlaylistRootGroup:S,setPlaylistName:C,setPlaylistComment:ee,setPlaylistLimit:te,setPlaylistSort:ne}=Pt();return(0,G.jsx)(oe,{title:`Navidrome`,children:(0,G.jsxs)(e,{spacing:2,children:[(0,G.jsxs)(m,{defaultExpanded:!0,disableGutters:!0,children:[(0,G.jsx)(h,{expandIcon:(0,G.jsx)(f,{}),children:(0,G.jsx)(B,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,G.jsx)(p,{children:(0,G.jsx)(ht,{preview:t,configText:n,loading:r,error:i,onLoadPreview:v,onGenerateConfig:y})})]}),(0,G.jsxs)(m,{disableGutters:!0,children:[(0,G.jsx)(h,{expandIcon:(0,G.jsx)(f,{}),children:(0,G.jsx)(B,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,G.jsx)(p,{children:(0,G.jsx)(Nt,{rootGroup:a,name:o,comment:s,limit:c,sort:l,preview:u,content:d,loading:g,error:_,onGroupChange:S,onNameChange:C,onCommentChange:ee,onLimitChange:te,onSortChange:ne,onPreview:b,onGenerate:x})})]})]})})}export{Ft as NavidromePage};