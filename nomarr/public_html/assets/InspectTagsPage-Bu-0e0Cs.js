import{t as e}from"./Stack-CqnjfNxH.js";import{t}from"./TextField-BIZFZSHt.js";import"./Portal-CAh1Yehh.js";import{t as n}from"./TableCell-DhQiDXj4.js";import{i as r,n as i,r as a,t as o}from"./TableRow-BVzODKc1.js";import{It as s,Rt as c,St as l,_ as u,a as d,b as f,f as p,n as m,o as h,p as g,v as _}from"./index-Bmoj33p1.js";import{t as v}from"./useConfirmDialog-62s1TtO7.js";import{t as y}from"./ServerFilePicker-C1UrhG1T.js";var b=c(s(),1),x=c(l(),1);function S(){let{confirm:s}=v(),[c,l]=(0,b.useState)(``),[S,C]=(0,b.useState)(null),[w,T]=(0,b.useState)(!1),[E,D]=(0,b.useState)(null),[O,k]=(0,b.useState)(!1),[A,j]=(0,b.useState)(!1),[M,N]=(0,b.useState)(null),P=async e=>{if(e.preventDefault(),c.trim())try{T(!0),D(null),N(null),C(await m.tags.showTags(c))}catch(e){D(e instanceof Error?e.message:`Failed to load tags`),C(null),console.error(`[Inspect] Load error:`,e)}finally{T(!1)}},F=async()=>{if(c.trim()&&await s({title:`Remove All Tags?`,message:`Remove all tags from ${c}?\n\nThis cannot be undone!`,severity:`warning`}))try{j(!0),D(null),N(null);let e=await m.tags.removeTags(c);N(`Removed ${e.removed} tag(s) from ${e.path}`),C(await m.tags.showTags(c))}catch(e){D(e instanceof Error?e.message:`Failed to remove tags`),console.error(`[Inspect] Remove error:`,e)}finally{j(!1)}},I=e=>Array.isArray(e)?e.join(`, `):String(e);return(0,x.jsxs)(h,{title:`Inspect Tags`,children:[(0,x.jsxs)(g,{children:[(0,x.jsx)(p,{title:`File Path`}),(0,x.jsx)(_,{component:`form`,onSubmit:P,children:(0,x.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,x.jsx)(t,{value:c,onChange:e=>l(e.target.value),placeholder:`Enter relative path to audio file`,disabled:w,fullWidth:!0}),(0,x.jsx)(u,{onClick:()=>k(!O),variant:`outlined`,disabled:w,sx:{minWidth:100},children:O?`Hide`:`Browse...`}),(0,x.jsx)(u,{type:`submit`,variant:`contained`,disabled:w||!c.trim(),sx:{minWidth:100},children:w?`Loading...`:`Inspect`})]})}),O&&(0,x.jsx)(_,{sx:{mt:2},children:(0,x.jsx)(y,{value:c,onChange:e=>{l(e),k(!1)},mode:`file`,label:`Select Audio File`})})]}),E&&(0,x.jsx)(g,{children:(0,x.jsxs)(d,{children:[`Error: `,E]})}),M&&(0,x.jsx)(g,{children:(0,x.jsx)(f,{color:`primary`,children:M})}),S&&(0,x.jsxs)(e,{spacing:2.5,children:[(0,x.jsxs)(g,{children:[(0,x.jsx)(p,{title:`File Metadata`,action:S.count>0?(0,x.jsx)(u,{onClick:F,disabled:A,variant:`contained`,color:`error`,size:`small`,title:`Remove all tags from this file`,children:A?`Removing...`:`Remove All Tags`}):void 0}),(0,x.jsxs)(e,{spacing:1.25,children:[(0,x.jsxs)(_,{children:[(0,x.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Path:`}),(0,x.jsx)(f,{component:`span`,children:S.path})]}),(0,x.jsxs)(_,{children:[(0,x.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Namespace:`}),(0,x.jsx)(f,{component:`span`,children:S.namespace})]}),(0,x.jsxs)(_,{children:[(0,x.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Tag Count:`}),(0,x.jsx)(f,{component:`span`,children:S.count})]})]})]}),(0,x.jsxs)(g,{children:[(0,x.jsx)(p,{title:`Tags`}),S.count===0?(0,x.jsx)(f,{color:`text.secondary`,fontStyle:`italic`,children:`No tags found in this file.`}):(0,x.jsx)(_,{sx:{overflowX:`auto`},children:(0,x.jsxs)(r,{children:[(0,x.jsx)(i,{children:(0,x.jsxs)(o,{children:[(0,x.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag Key`}),(0,x.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Value`})]})}),(0,x.jsx)(a,{children:Object.entries(S.tags).map(([e,t])=>(0,x.jsxs)(o,{children:[(0,x.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:e}),(0,x.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:I(t)})]},e))})]})})]})]}),!S&&!E&&(0,x.jsx)(g,{children:(0,x.jsx)(f,{color:`text.secondary`,fontStyle:`italic`,children:`Enter a file path above to inspect its tags.`})})]})}export{S as InspectTagsPage};