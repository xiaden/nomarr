import{t as e}from"./Stack-Cpw-s-cd.js";import{St as t,ft as n,i as r,l as i,m as a,n as o,p as s,xt as c}from"./index-C7-f9Jfd.js";import{t as l}from"./useConfirmDialog-CfnK9eWc.js";import{t as u}from"./useNotification-516BVKEL.js";var d=t(n(),1);function f({onRestart:e,actionLoading:t}){return(0,d.jsxs)(a,{children:[(0,d.jsx)(s,{title:`System Controls`}),(0,d.jsx)(i,{label:`Restart Server`,description:`Stops and restarts the API server. Config changes will take effect. Page will reload automatically after restart.`,onClick:e,disabled:t,variant:`contained`,color:`error`})]})}function p({onPause:t,onResume:n,actionLoading:r}){return(0,d.jsxs)(a,{children:[(0,d.jsx)(s,{title:`Worker Controls`}),(0,d.jsxs)(e,{spacing:1.25,children:[(0,d.jsx)(i,{label:`Pause Worker`,description:`Stops the worker from processing queue jobs. Jobs remain in the queue.`,onClick:t,disabled:r}),(0,d.jsx)(i,{label:`Resume Worker`,description:`Starts the worker to process queue jobs.`,onClick:n,disabled:r})]})]})}var m=t(c(),1);function h(){let{showSuccess:e,showError:t}=u(),{confirm:n,isOpen:r,options:i,handleConfirm:a,handleCancel:s}=l(),[c,d]=(0,m.useState)(!1);return{actionLoading:c,handlePauseWorker:async()=>{if(await n({title:`Pause Worker?`,message:`Pause the worker? Processing will stop.`,confirmLabel:`Pause`,severity:`warning`}))try{d(!0),e((await o.admin.pauseWorker()).message)}catch(e){t(e instanceof Error?e.message:`Failed to pause worker`)}finally{d(!1)}},handleResumeWorker:async()=>{if(await n({title:`Resume Worker?`,message:`Resume the worker? Processing will start.`,confirmLabel:`Resume`}))try{d(!0),e((await o.admin.resumeWorker()).message)}catch(e){t(e instanceof Error?e.message:`Failed to resume worker`)}finally{d(!1)}},handleRestart:async()=>{if(await n({title:`Restart Server?`,message:`Restart the API server? The page will reload in a few seconds.`,confirmLabel:`Restart`,severity:`error`}))try{d(!0),e((await o.admin.restart()).message),setTimeout(()=>{window.location.reload()},3e3)}catch(e){t(e instanceof Error?e.message:`Failed to restart server`),d(!1)}},dialogState:{isOpen:r,options:i,handleConfirm:a,handleCancel:s}}}function g(){let{actionLoading:e,handlePauseWorker:t,handleResumeWorker:n,handleRestart:i,dialogState:a}=h();return(0,d.jsxs)(`div`,{style:{padding:`20px`},children:[(0,d.jsx)(`h1`,{style:{marginBottom:`20px`},children:`Admin`}),(0,d.jsxs)(`div`,{style:{display:`grid`,gap:`20px`},children:[(0,d.jsx)(p,{onPause:t,onResume:n,actionLoading:e}),(0,d.jsx)(f,{onRestart:i,actionLoading:e})]}),(0,d.jsx)(r,{open:a.isOpen,title:a.options.title,message:a.options.message,confirmLabel:a.options.confirmLabel,cancelLabel:a.options.cancelLabel,severity:a.options.severity,onConfirm:a.handleConfirm,onCancel:a.handleCancel})]})}export{g as AdminPage};