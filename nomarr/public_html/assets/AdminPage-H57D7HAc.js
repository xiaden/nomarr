import{t as e}from"./Stack-B4CN3zD5.js";import{Dt as t,Et as n,_t as r,a as i,d as a,g as o,h as s,l as c,o as l}from"./index-BF2NrADo.js";import{t as u}from"./useConfirmDialog-CtFSKmAm.js";import{t as d}from"./useNotification-DFHAcgcg.js";var f=t(r(),1),p=t(n(),1);async function m(){return i(`/api/web/worker/pause`)}async function h(){return i(`/api/web/worker/resume`)}async function g(){return i(`/api/web/worker/restart`)}function _({onRestart:e,actionLoading:t}){return(0,f.jsxs)(o,{children:[(0,f.jsx)(s,{title:`System Controls`}),(0,f.jsx)(a,{label:`Restart Server`,description:`Stops and restarts the API server. Config changes will take effect. Page will reload automatically after restart.`,onClick:e,disabled:t,variant:`contained`,color:`error`})]})}function v({onPause:t,onResume:n,actionLoading:r}){return(0,f.jsxs)(o,{children:[(0,f.jsx)(s,{title:`Worker Controls`}),(0,f.jsxs)(e,{spacing:1.25,children:[(0,f.jsx)(a,{label:`Pause Worker`,description:`Stops the worker from processing queue jobs. Jobs remain in the queue.`,onClick:t,disabled:r}),(0,f.jsx)(a,{label:`Resume Worker`,description:`Starts the worker to process queue jobs.`,onClick:n,disabled:r})]})]})}function y(){let{showSuccess:e,showError:t}=d(),{confirm:n,isOpen:r,options:i,handleConfirm:a,handleCancel:o}=u(),[s,c]=(0,p.useState)(!1);return{actionLoading:s,handlePauseWorker:async()=>{if(await n({title:`Pause Worker?`,message:`Pause the worker? Processing will stop.`,confirmLabel:`Pause`,severity:`warning`}))try{c(!0),e((await m()).message)}catch(e){t(e instanceof Error?e.message:`Failed to pause worker`)}finally{c(!1)}},handleResumeWorker:async()=>{if(await n({title:`Resume Worker?`,message:`Resume the worker? Processing will start.`,confirmLabel:`Resume`}))try{c(!0),e((await h()).message)}catch(e){t(e instanceof Error?e.message:`Failed to resume worker`)}finally{c(!1)}},handleRestart:async()=>{if(await n({title:`Restart Server?`,message:`Restart the API server? The page will reload in a few seconds.`,confirmLabel:`Restart`,severity:`error`}))try{c(!0),e((await g()).message),setTimeout(()=>{window.location.reload()},3e3)}catch(e){t(e instanceof Error?e.message:`Failed to restart server`),c(!1)}},dialogState:{isOpen:r,options:i,handleConfirm:a,handleCancel:o}}}function b(){let{actionLoading:t,handlePauseWorker:n,handleResumeWorker:r,handleRestart:i,dialogState:a}=y();return(0,f.jsxs)(c,{title:`Admin`,children:[(0,f.jsxs)(e,{spacing:2.5,children:[(0,f.jsx)(v,{onPause:n,onResume:r,actionLoading:t}),(0,f.jsx)(_,{onRestart:i,actionLoading:t})]}),(0,f.jsx)(l,{open:a.isOpen,title:a.options.title,message:a.options.message,confirmLabel:a.options.confirmLabel,cancelLabel:a.options.cancelLabel,severity:a.options.severity,onConfirm:a.handleConfirm,onCancel:a.handleCancel})]})}export{b as AdminPage};