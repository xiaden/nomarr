import{t as e}from"./Stack-C16zh1gZ.js";import{t}from"./TextField-COCzMOZh.js";import"./useSlotProps-CGD2pfMu.js";import{t as n}from"./TableCell-DgZRqqbN.js";import{i as r,n as i,r as a,t as o}from"./TableRow-Oc-SU_76.js";import{Bt as s,C as c,E as l,Et as u,Ht as d,S as f,i as p,m,n as h,o as g,p as _,s as v}from"./index-BQCr6YQc.js";import{t as y}from"./useConfirmDialog-CA4Uyb45.js";import{t as b}from"./ServerFilePicker-CDHWk2Qf.js";var x=d(s(),1),S=d(u(),1);function C(){let{confirm:s,isOpen:u,options:d,handleConfirm:C,handleCancel:w}=y(),[T,E]=(0,x.useState)(``),[D,O]=(0,x.useState)(null),[k,A]=(0,x.useState)(!1),[j,M]=(0,x.useState)(null),[N,P]=(0,x.useState)(!1),[F,I]=(0,x.useState)(!1),[L,R]=(0,x.useState)(null),z=async e=>{if(e.preventDefault(),T.trim())try{A(!0),M(null),R(null),O(await h.tags.showTags(T))}catch(e){M(e instanceof Error?e.message:`Failed to load tags`),O(null),console.error(`[Inspect] Load error:`,e)}finally{A(!1)}},B=async()=>{if(T.trim()&&await s({title:`Remove All Tags?`,message:`Remove all tags from ${T}?\n\nThis cannot be undone!`,severity:`warning`}))try{I(!0),M(null),R(null);let e=await h.tags.removeTags(T);R(`Removed ${e.removed} tag(s) from ${e.path}`),O(await h.tags.showTags(T))}catch(e){M(e instanceof Error?e.message:`Failed to remove tags`),console.error(`[Inspect] Remove error:`,e)}finally{I(!1)}},V=e=>Array.isArray(e)?e.join(`, `):String(e);return(0,S.jsxs)(v,{title:`Inspect Tags`,children:[(0,S.jsxs)(m,{children:[(0,S.jsx)(_,{title:`File Path`}),(0,S.jsx)(c,{component:`form`,onSubmit:z,children:(0,S.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,S.jsx)(t,{value:T,onChange:e=>E(e.target.value),placeholder:`Enter relative path to audio file`,disabled:k,fullWidth:!0}),(0,S.jsx)(f,{onClick:()=>P(!N),variant:`outlined`,disabled:k,sx:{minWidth:100},children:N?`Hide`:`Browse...`}),(0,S.jsx)(f,{type:`submit`,variant:`contained`,disabled:k||!T.trim(),sx:{minWidth:100},children:k?`Loading...`:`Inspect`})]})}),N&&(0,S.jsx)(c,{sx:{mt:2},children:(0,S.jsx)(b,{value:T,onChange:e=>{E(e),P(!1)},mode:`file`,label:`Select Audio File`})})]}),j&&(0,S.jsx)(m,{children:(0,S.jsxs)(g,{children:[`Error: `,j]})}),L&&(0,S.jsx)(m,{children:(0,S.jsx)(l,{color:`primary`,children:L})}),D&&(0,S.jsxs)(e,{spacing:2.5,children:[(0,S.jsxs)(m,{children:[(0,S.jsx)(_,{title:`File Metadata`,action:D.count>0?(0,S.jsx)(f,{onClick:B,disabled:F,variant:`contained`,color:`error`,size:`small`,title:`Remove all tags from this file`,children:F?`Removing...`:`Remove All Tags`}):void 0}),(0,S.jsxs)(e,{spacing:1.25,children:[(0,S.jsxs)(c,{children:[(0,S.jsx)(l,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Path:`}),(0,S.jsx)(l,{component:`span`,children:D.path})]}),(0,S.jsxs)(c,{children:[(0,S.jsx)(l,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Namespace:`}),(0,S.jsx)(l,{component:`span`,children:D.namespace})]}),(0,S.jsxs)(c,{children:[(0,S.jsx)(l,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Tag Count:`}),(0,S.jsx)(l,{component:`span`,children:D.count})]})]})]}),(0,S.jsxs)(m,{children:[(0,S.jsx)(_,{title:`Tags`}),D.count===0?(0,S.jsx)(l,{color:`text.secondary`,fontStyle:`italic`,children:`No tags found in this file.`}):(0,S.jsx)(c,{sx:{overflowX:`auto`},children:(0,S.jsxs)(r,{children:[(0,S.jsx)(i,{children:(0,S.jsxs)(o,{children:[(0,S.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag Key`}),(0,S.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Value`})]})}),(0,S.jsx)(a,{children:Object.entries(D.tags).map(([e,t])=>(0,S.jsxs)(o,{children:[(0,S.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:e}),(0,S.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:V(t)})]},e))})]})})]})]}),!D&&!j&&(0,S.jsx)(m,{children:(0,S.jsx)(l,{color:`text.secondary`,fontStyle:`italic`,children:`Enter a file path above to inspect its tags.`})}),(0,S.jsx)(p,{open:u,title:d.title,message:d.message,confirmLabel:d.confirmLabel,cancelLabel:d.cancelLabel,severity:d.severity,onConfirm:C,onCancel:w})]})}export{C as InspectTagsPage};