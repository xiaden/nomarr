import{c as e,l as t,n,t as r,u as i}from"./ui-0x0XinP6.js";import{t as a}from"./TextField-RhsmfodV.js";import"./Grow-BleD-8bo.js";import{t as o}from"./TableCell-C1oxeEqY.js";import{i as s,n as c,r as l,t as u}from"./TableRow-8WmbevDu.js";import{Z as d,a as f,dt as p,n as m,o as h,pt as g,s as _}from"./index-ByHFyLQZ.js";import{t as v}from"./ServerFilePicker-DtV8sjX5.js";var y=g(p(),1),b=g(d(),1);function x(){let[d,p]=(0,y.useState)(``),[g,x]=(0,y.useState)(null),[S,C]=(0,y.useState)(!1),[w,T]=(0,y.useState)(null),[E,D]=(0,y.useState)(!1),[O,k]=(0,y.useState)(!1),[A,j]=(0,y.useState)(null),M=async e=>{if(e.preventDefault(),d.trim())try{C(!0),T(null),j(null),x(await m.tags.showTags(d))}catch(e){T(e instanceof Error?e.message:`Failed to load tags`),x(null),console.error(`[Inspect] Load error:`,e)}finally{C(!1)}},N=async()=>{if(d.trim()&&confirm(`Remove all tags from ${d}?\n\nThis cannot be undone!`))try{k(!0),T(null),j(null);let e=await m.tags.removeTags(d);j(`Removed ${e.removed} tag(s) from ${e.path}`),x(await m.tags.showTags(d))}catch(e){T(e instanceof Error?e.message:`Failed to remove tags`),console.error(`[Inspect] Remove error:`,e)}finally{k(!1)}},P=e=>Array.isArray(e)?e.join(`, `):String(e);return(0,b.jsxs)(n,{title:`Inspect Tags`,children:[(0,b.jsxs)(t,{children:[(0,b.jsx)(e,{title:`File Path`}),(0,b.jsx)(h,{component:`form`,onSubmit:M,children:(0,b.jsxs)(i,{direction:`row`,spacing:1.25,children:[(0,b.jsx)(a,{value:d,onChange:e=>p(e.target.value),placeholder:`Enter relative path to audio file`,disabled:S,fullWidth:!0}),(0,b.jsx)(f,{onClick:()=>D(!E),variant:`outlined`,disabled:S,sx:{minWidth:100},children:E?`Hide`:`Browse...`}),(0,b.jsx)(f,{type:`submit`,variant:`contained`,disabled:S||!d.trim(),sx:{minWidth:100},children:S?`Loading...`:`Inspect`})]})}),E&&(0,b.jsx)(h,{sx:{mt:2},children:(0,b.jsx)(v,{value:d,onChange:e=>{p(e),D(!1)},mode:`file`,label:`Select Audio File`})})]}),w&&(0,b.jsx)(t,{children:(0,b.jsxs)(r,{children:[`Error: `,w]})}),A&&(0,b.jsx)(t,{children:(0,b.jsx)(_,{color:`primary`,children:A})}),g&&(0,b.jsxs)(i,{spacing:2.5,children:[(0,b.jsxs)(t,{children:[(0,b.jsx)(e,{title:`File Metadata`,action:g.count>0?(0,b.jsx)(f,{onClick:N,disabled:O,variant:`contained`,color:`error`,size:`small`,title:`Remove all tags from this file`,children:O?`Removing...`:`Remove All Tags`}):void 0}),(0,b.jsxs)(i,{spacing:1.25,children:[(0,b.jsxs)(h,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Path:`}),(0,b.jsx)(_,{component:`span`,children:g.path})]}),(0,b.jsxs)(h,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Namespace:`}),(0,b.jsx)(_,{component:`span`,children:g.namespace})]}),(0,b.jsxs)(h,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Tag Count:`}),(0,b.jsx)(_,{component:`span`,children:g.count})]})]})]}),(0,b.jsxs)(t,{children:[(0,b.jsx)(e,{title:`Tags`}),g.count===0?(0,b.jsx)(_,{color:`text.secondary`,fontStyle:`italic`,children:`No tags found in this file.`}):(0,b.jsx)(h,{sx:{overflowX:`auto`},children:(0,b.jsxs)(s,{children:[(0,b.jsx)(c,{children:(0,b.jsxs)(u,{children:[(0,b.jsx)(o,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag Key`}),(0,b.jsx)(o,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Value`})]})}),(0,b.jsx)(l,{children:Object.entries(g.tags).map(([e,t])=>(0,b.jsxs)(u,{children:[(0,b.jsx)(o,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:e}),(0,b.jsx)(o,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:P(t)})]},e))})]})})]})]}),!g&&!w&&(0,b.jsx)(t,{children:(0,b.jsx)(_,{color:`text.secondary`,fontStyle:`italic`,children:`Enter a file path above to inspect its tags.`})})]})}export{x as InspectTagsPage};