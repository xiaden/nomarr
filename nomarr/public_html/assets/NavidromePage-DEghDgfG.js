import{t as e}from"./Stack-Yia4z9hu.js";import"./List-ClDpiA8c.js";import{t}from"./TextField-7eBCAcnM.js";import{i as n,n as r,r as i,t as a}from"./ExpandMore-C5i0TLrw.js";import{a as o,i as s,n as c,r as l,t as u}from"./TableRow-xLyxtrfu.js";import{$ as d,En as f,J as p,et as m,i as h,n as g,ot as _,pn as v,q as y,r as b,st as x,t as S,ut as C,wn as w}from"./index-BcSftaEo.js";import{t as T}from"./useNotification-B_lRTHle.js";var E=f(v(),1);function D({preview:n,configText:r,loading:i,error:a,onLoadPreview:f,onGenerateConfig:p}){let{showSuccess:h}=T();return(0,E.jsxs)(e,{spacing:2.5,children:[(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Navidrome TOML Configuration`}),(0,E.jsxs)(e,{spacing:1.25,children:[(0,E.jsx)(_,{onClick:f,disabled:i,variant:`contained`,fullWidth:!0,children:i?`Loading...`:`Load Tag Preview`}),(0,E.jsx)(_,{onClick:p,disabled:i,variant:`contained`,fullWidth:!0,children:i?`Generating...`:`Generate Config`})]}),a&&(0,E.jsxs)(y,{children:[`Error: `,a]})]}),n&&(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Tag Preview`}),(0,E.jsx)(x,{sx:{overflowX:`auto`},children:(0,E.jsxs)(o,{children:[(0,E.jsx)(c,{children:(0,E.jsxs)(u,{children:[(0,E.jsx)(l,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,E.jsx)(l,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,E.jsx)(l,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,E.jsx)(l,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,E.jsx)(l,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,E.jsx)(s,{children:n.map(e=>(0,E.jsxs)(u,{children:[(0,E.jsx)(l,{sx:{borderColor:`divider`},children:e.tag_key}),(0,E.jsx)(l,{sx:{borderColor:`divider`},children:e.type}),(0,E.jsx)(l,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,E.jsx)(l,{sx:{borderColor:`divider`},children:e.total_count}),(0,E.jsx)(l,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),r&&(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Generated Config`}),(0,E.jsx)(t,{multiline:!0,rows:20,value:r,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,E.jsx)(_,{onClick:()=>{r&&(navigator.clipboard.writeText(r),h(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}function O({query:n,name:r,comment:i,limit:a,sort:o,preview:s,content:c,loading:l,error:u,onQueryChange:f,onNameChange:p,onCommentChange:h,onLimitChange:g,onSortChange:v,onPreview:b,onGenerate:S}){return(0,E.jsxs)(e,{spacing:2.5,children:[(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Smart Playlist Generator`}),(0,E.jsx)(x,{component:`form`,onSubmit:b,children:(0,E.jsxs)(e,{spacing:2,children:[(0,E.jsxs)(x,{children:[(0,E.jsx)(C,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Query *`}),(0,E.jsx)(t,{value:n,onChange:e=>f(e.target.value),placeholder:`e.g., tag:nom_happy > 0.8`,multiline:!0,rows:3,disabled:l,required:!0,fullWidth:!0,InputProps:{sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}})]}),(0,E.jsxs)(x,{children:[(0,E.jsx)(C,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,E.jsx)(t,{value:r,onChange:e=>p(e.target.value),disabled:l,required:!0,fullWidth:!0})]}),(0,E.jsxs)(x,{children:[(0,E.jsx)(C,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,E.jsx)(t,{value:i,onChange:e=>h(e.target.value),disabled:l,fullWidth:!0})]}),(0,E.jsxs)(x,{sx:{display:`grid`,gridTemplateColumns:`1fr 1fr`,gap:1.25},children:[(0,E.jsxs)(x,{children:[(0,E.jsx)(C,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,E.jsx)(t,{type:`number`,value:a??``,onChange:e=>g(e.target.value?parseInt(e.target.value):void 0),disabled:l,placeholder:`Optional`,fullWidth:!0})]}),(0,E.jsxs)(x,{children:[(0,E.jsx)(C,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,E.jsx)(t,{value:o,onChange:e=>v(e.target.value),disabled:l,placeholder:`Optional`,fullWidth:!0})]})]}),(0,E.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,E.jsx)(_,{type:`submit`,variant:`contained`,disabled:l,fullWidth:!0,children:l?`Loading...`:`Preview Query`}),(0,E.jsx)(_,{type:`button`,onClick:S,variant:`contained`,disabled:l,fullWidth:!0,children:l?`Generating...`:`Generate .nsp`})]})]})}),u&&(0,E.jsxs)(y,{children:[`Error: `,u]})]}),s&&(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Query Preview`}),(0,E.jsx)(x,{component:`pre`,sx:{p:2,bgcolor:`background.default`,border:1,borderColor:`divider`,borderRadius:1,overflow:`auto`,fontSize:`0.875rem`,fontFamily:`monospace`},children:JSON.stringify(s,null,2)})]}),c&&(0,E.jsxs)(m,{children:[(0,E.jsx)(d,{title:`Generated Playlist (.nsp)`}),(0,E.jsx)(t,{multiline:!0,rows:15,value:c,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,E.jsx)(_,{onClick:()=>{if(c){let e=new Blob([c],{type:`text/plain`}),t=URL.createObjectURL(e),n=document.createElement(`a`);n.href=t,n.download=`${r}.nsp`,n.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}var k=f(w(),1);function A(){let{showError:e}=T(),[t,n]=(0,k.useState)(null),[r,i]=(0,k.useState)(null),[a,o]=(0,k.useState)(!1),[s,c]=(0,k.useState)(null),[l,u]=(0,k.useState)(``),[d,f]=(0,k.useState)(`My Playlist`),[p,m]=(0,k.useState)(``),[_,v]=(0,k.useState)(void 0),[y,x]=(0,k.useState)(``),[C,w]=(0,k.useState)(null),[E,D]=(0,k.useState)(null),[O,A]=(0,k.useState)(!1),[j,M]=(0,k.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistQuery:l,playlistName:d,playlistComment:p,playlistLimit:_,playlistSort:y,playlistPreview:C,playlistContent:E,playlistLoading:O,playlistError:j,loadConfigPreview:async()=>{try{o(!0),c(null),n((await b()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await g()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async e=>{if(e.preventDefault(),l.trim())try{A(!0),M(null),w(await h(l,10))}catch(e){M(e instanceof Error?e.message:`Failed to preview playlist`)}finally{A(!1)}},generatePlaylist:async()=>{if(!l.trim()){e(`Query is required`);return}if(!d.trim()){e(`Playlist name is required`);return}try{A(!0),M(null),D((await S({query:l,playlist_name:d,comment:p,limit:_,sort:y||void 0})).content)}catch(e){M(e instanceof Error?e.message:`Failed to generate playlist`)}finally{A(!1)}},setPlaylistQuery:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:v,setPlaylistSort:x}}function j(){let{configPreview:t,configText:o,configLoading:s,configError:c,playlistQuery:l,playlistName:u,playlistComment:d,playlistLimit:f,playlistSort:m,playlistPreview:h,playlistContent:g,playlistLoading:_,playlistError:v,loadConfigPreview:y,generateConfig:b,previewPlaylist:x,generatePlaylist:S,setPlaylistQuery:w,setPlaylistName:T,setPlaylistComment:k,setPlaylistLimit:j,setPlaylistSort:M}=A();return(0,E.jsx)(p,{title:`Navidrome`,children:(0,E.jsxs)(e,{spacing:2,children:[(0,E.jsxs)(n,{defaultExpanded:!0,disableGutters:!0,children:[(0,E.jsx)(r,{expandIcon:(0,E.jsx)(a,{}),children:(0,E.jsx)(C,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,E.jsx)(i,{children:(0,E.jsx)(D,{preview:t,configText:o,loading:s,error:c,onLoadPreview:y,onGenerateConfig:b})})]}),(0,E.jsxs)(n,{disableGutters:!0,children:[(0,E.jsx)(r,{expandIcon:(0,E.jsx)(a,{}),children:(0,E.jsx)(C,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,E.jsx)(i,{children:(0,E.jsx)(O,{query:l,name:u,comment:d,limit:f,sort:m,preview:h,content:g,loading:_,error:v,onQueryChange:w,onNameChange:T,onCommentChange:k,onLimitChange:j,onSortChange:M,onPreview:x,onGenerate:S})})]})]})})}export{j as NavidromePage};