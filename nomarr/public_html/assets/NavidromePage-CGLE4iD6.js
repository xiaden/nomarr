import{t as e}from"./Stack-DoLtnbcQ.js";import{c as t,d as n,f as r,i,l as a,o,r as s,t as c,u as l,v as u}from"./Select-B5bVQCV0.js";import{t as d}from"./ExpandMore-65li7hLD.js";import{n as f,r as p,t as m}from"./AccordionSummary-BAVN3JM4.js";import{t as h}from"./Popper-D7ogtwWz.js";import{t as g}from"./Chip-DC8bwQ5T.js";import{t as _}from"./TextField-Bs2H1HgS.js";import{t as v}from"./Tooltip-B8rNWGzB.js";import{a as y,i as b,n as x,r as S,t as ee}from"./TableRow-tyIFvJAE.js";import{t as C}from"./TableContainer-C6dGqsUq.js";import{At as te,Cn as ne,Dn as re,Dt as ie,En as w,Gn as ae,Mn as oe,Nt as se,On as T,Ot as ce,Pt as le,Qt as ue,Un as de,Xt as fe,_n as pe,a as me,bt as E,ct as D,ft as he,gn as ge,gt as O,ht as k,i as _e,jt as ve,kt as A,ln as j,lt as M,mt as ye,n as N,nn as P,nt as be,o as F,pt as xe,r as I,rn as Se,rt as L,sn as R,t as Ce,tn as we,wt as z,xt as B}from"./index-D3CBCd4e.js";import{t as Te}from"./useNotification-BfaSfgIA.js";import{t as Ee}from"./Add-BLDENIbo.js";import{t as De}from"./Close-Ujih8gPt.js";var V=ae(de());function Oe(e){let t=V.useRef({});return V.useEffect(()=>{t.current=e}),t.current}var ke=Oe;function Ae({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function H(e){return e.normalize(`NFD`).replace(/[\u0300-\u036f]/g,``)}function U(e={}){let{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i=`any`,stringify:a,trim:o=!1}=e;return(e,{inputValue:s,getOptionLabel:c})=>{let l=o?s.trim():s;n&&(l=l.toLowerCase()),t&&(l=H(l));let u=l?e.filter(e=>{let r=(a||c)(e);return n&&(r=r.toLowerCase()),t&&(r=H(r)),i===`start`?r.startsWith(l):r.includes(l)}):e;return typeof r==`number`?u.slice(0,r):u}}var je=U(),Me=5,Ne=e=>e.current!==null&&e.current.parentElement?.contains(document.activeElement),Pe=[];function Fe(e,t,n,r){if(t||e==null||r)return``;let i=n(e);return typeof i==`string`?i:``}function W(e){let{unstable_isActiveElementInListbox:t=Ne,unstable_classNamePrefix:n=`Mui`,autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:o=!1,clearOnBlur:s=!e.freeSolo,clearOnEscape:c=!1,componentName:l=`useAutocomplete`,defaultValue:d=e.multiple?Pe:null,disableClearable:f=!1,disableCloseOnSelect:p=!1,disabled:m,disabledItemsFocusable:h=!1,disableListWrap:g=!1,filterOptions:_=je,filterSelectedOptions:v=!1,freeSolo:y=!1,getOptionDisabled:b,getOptionKey:x,getOptionLabel:S=e=>e.label??e,groupBy:ee,handleHomeEndKeys:C=!e.freeSolo,id:te,includeInputInList:ne=!1,inputValue:re,isOptionEqualToValue:ie=(e,t)=>e===t,multiple:w=!1,onChange:ae,onClose:oe,onHighlightChange:se,onInputChange:T,onOpen:ce,open:le,openOnFocus:de=!1,options:me,readOnly:E=!1,renderValue:D,selectOnFocus:he=!e.freeSolo,value:ge}=e,O=pe(te),k=S;k=e=>{let t=S(e);return typeof t==`string`?t:String(t)};let _e=V.useRef(!1),ve=V.useRef(!0),A=V.useRef(null),j=V.useRef(null),[M,ye]=V.useState(null),[N,P]=V.useState(-1),be=i?0:-1,F=V.useRef(be),xe=V.useRef(Fe(d??ge,w,k)).current,[I,Se]=u({controlled:ge,default:d,name:l}),[L,R]=u({controlled:re,default:xe,name:l,state:`inputValue`}),[Ce,we]=V.useState(!1),z=V.useCallback((e,t,n)=>{if(!(w?I.length<t.length:t!==null)&&!s)return;let r=Fe(t,w,k,D);L!==r&&(R(r),T&&T(e,r,n))},[k,L,w,T,R,s,I,D]),[B,Te]=u({controlled:le,default:!1,name:l,state:`open`}),[Ee,De]=V.useState(!0),Oe=!w&&I!=null&&L===k(I),H=B&&!E,U=H?_(me.filter(e=>!(v&&(w?I:[I]).some(t=>t!==null&&ie(e,t)))),{inputValue:Oe&&Ee?``:L,getOptionLabel:k}):[],W=ke({filteredOptions:U,value:I,inputValue:L});V.useEffect(()=>{let e=I!==W.value;Ce&&!e||y&&!e||z(null,I,`reset`)},[I,z,Ce,W.value,y]);let Ie=B&&U.length>0&&!E,Le=fe(e=>{if(e===-1)A.current.focus();else{let t=D?`data-item-index`:`data-tag-index`;M.querySelector(`[${t}="${e}"]`).focus()}});V.useEffect(()=>{w&&N>I.length-1&&(P(-1),Le(-1))},[I,w,N,Le]);function G(e,t){if(!j.current||e<0||e>=U.length)return-1;let n=e;for(;;){let r=j.current.querySelector(`[data-option-index="${n}"]`),i=h?!1:!r||r.disabled||r.getAttribute(`aria-disabled`)===`true`;if(r&&r.hasAttribute(`tabindex`)&&!i)return n;if(n=t===`next`?(n+1)%U.length:(n-1+U.length)%U.length,n===e)return-1}}let Re=fe(({event:e,index:t,reason:r})=>{if(F.current=t,t===-1?A.current.removeAttribute(`aria-activedescendant`):A.current.setAttribute(`aria-activedescendant`,`${O}-option-${t}`),se&&[`mouse`,`keyboard`,`touch`].includes(r)&&se(e,t===-1?null:U[t],r),!j.current)return;let i=j.current.querySelector(`[role="option"].${n}-focused`);i&&(i.classList.remove(`${n}-focused`),i.classList.remove(`${n}-focusVisible`));let a=j.current;if(j.current.getAttribute(`role`)!==`listbox`&&(a=j.current.parentElement.querySelector(`[role="listbox"]`)),!a)return;if(t===-1){a.scrollTop=0;return}let o=j.current.querySelector(`[data-option-index="${t}"]`);if(o&&(o.classList.add(`${n}-focused`),r===`keyboard`&&o.classList.add(`${n}-focusVisible`),a.scrollHeight>a.clientHeight&&r!==`mouse`&&r!==`touch`)){let e=o,t=a.clientHeight+a.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?a.scrollTop=n-a.clientHeight:e.offsetTop-e.offsetHeight*(ee?1.3:0)<a.scrollTop&&(a.scrollTop=e.offsetTop-e.offsetHeight*(ee?1.3:0))}}),K=fe(({event:e,diff:t,direction:n=`next`,reason:i})=>{if(!H)return;let a=G((()=>{let e=U.length-1;if(t===`reset`)return be;if(t===`start`)return 0;if(t===`end`)return e;let n=F.current+t;return n<0?n===-1&&ne?-1:g&&F.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&ne?-1:g||Math.abs(t)>1?e:0:n})(),n);if(Re({index:a,reason:i,event:e}),r&&t!==`reset`)if(a===-1)A.current.value=L;else{let e=k(U[a]);A.current.value=e,e.toLowerCase().indexOf(L.toLowerCase())===0&&L.length>0&&A.current.setSelectionRange(L.length,e.length)}}),ze=!Ae({array1:W.filteredOptions,array2:U,parser:k}),q=()=>{if(F.current!==-1&&!Ae({array1:W.filteredOptions,array2:U,parser:k})&&W.inputValue===L&&(w?I.length===W.value.length&&W.value.every((e,t)=>k(I[t])===k(e)):((e,t)=>(e?k(e):``)===(t?k(t):``))(W.value,I))){let e=W.filteredOptions[F.current];if(e)return U.findIndex(t=>k(t)===k(e))}return-1},Be=V.useCallback(()=>{if(!H)return;let e=q();if(e!==-1){F.current=e;return}let t=w?I[0]:I;if(U.length===0||t==null){K({diff:`reset`});return}if(j.current){if(t!=null){let e=U[F.current];if(w&&e&&I.findIndex(t=>ie(e,t))!==-1)return;let n=U.findIndex(e=>ie(e,t));n===-1?K({diff:`reset`}):Re({index:n});return}if(F.current>=U.length-1){Re({index:U.length-1});return}Re({index:F.current})}},[U.length,w?!1:I,K,Re,H,L,w]),J=fe(e=>{ue(j,e),e&&Be()});V.useEffect(()=>{(ze||H)&&Be()},[Be,ze,H]);let Ve=e=>{B||(Te(!0),De(!0),ce&&ce(e))},He=(e,t)=>{B&&(Te(!1),oe&&oe(e,t))},Y=(e,t,n,r)=>{if(w){if(I.length===t.length&&I.every((e,n)=>e===t[n]))return}else if(I===t)return;ae&&ae(e,t,n,r),Se(t)},Ue=V.useRef(!1),We=(e,t,n=`selectOption`,r=`options`)=>{let i=n,a=t;if(w){a=Array.isArray(I)?I.slice():[];let e=a.findIndex(e=>ie(t,e));e===-1?a.push(t):r!==`freeSolo`&&(a.splice(e,1),i=`removeOption`)}z(e,a,i),Y(e,a,i,{option:t}),!p&&(!e||!e.ctrlKey&&!e.metaKey)&&He(e,i),(o===!0||o===`touch`&&Ue.current||o===`mouse`&&!Ue.current)&&A.current.blur()};function Ge(e,t){if(e===-1)return-1;let n=e;for(;;){if(t===`next`&&n===I.length||t===`previous`&&n===-1)return-1;let e=D?`data-item-index`:`data-tag-index`,r=M.querySelector(`[${e}="${n}"]`);if(!r||!r.hasAttribute(`tabindex`)||r.disabled||r.getAttribute(`aria-disabled`)===`true`)n+=t===`next`?1:-1;else return n}}let Ke=(e,t)=>{if(!w)return;L===``&&He(e,`toggleInput`);let n=N;N===-1&&t===`previous`?(n=I.length-1,y&&L!==``&&(R(``),T&&T(e,``,`reset`))):(n+=t===`next`?1:-1,n<0&&(n=0),n===I.length&&(n=-1)),n=Ge(n,t),P(n),Le(n)},qe=e=>{_e.current=!0,R(``),T&&T(e,``,`clear`),Y(e,w?[]:null,`clear`)},Je=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(N!==-1&&![`ArrowLeft`,`ArrowRight`].includes(t.key)&&(P(-1),Le(-1)),t.which!==229))switch(t.key){case`Home`:H&&C&&(t.preventDefault(),K({diff:`start`,direction:`next`,reason:`keyboard`,event:t}));break;case`End`:H&&C&&(t.preventDefault(),K({diff:`end`,direction:`previous`,reason:`keyboard`,event:t}));break;case`PageUp`:t.preventDefault(),K({diff:-Me,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`PageDown`:t.preventDefault(),K({diff:Me,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowDown`:t.preventDefault(),K({diff:1,direction:`next`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowUp`:t.preventDefault(),K({diff:-1,direction:`previous`,reason:`keyboard`,event:t}),Ve(t);break;case`ArrowLeft`:{let e=A.current;if(!(e&&e.selectionStart===0&&e.selectionEnd===0))return;!w&&D&&I!=null?(y&&L!==``&&(R(``),T&&T(t,``,`reset`)),P(0),Le(0)):Ke(t,`previous`);break}case`ArrowRight`:!w&&D?(P(-1),Le(-1)):Ke(t,`next`);break;case`Enter`:if(F.current!==-1&&H){let e=U[F.current],n=b?b(e):!1;if(t.preventDefault(),n)return;We(t,e,`selectOption`),r&&A.current.setSelectionRange(A.current.value.length,A.current.value.length)}else y&&L!==``&&Oe===!1&&(w&&t.preventDefault(),We(t,L,`createOption`,`freeSolo`));break;case`Escape`:H?(t.preventDefault(),t.stopPropagation(),He(t,`escape`)):c&&(L!==``||w&&I.length>0||D)&&(t.preventDefault(),t.stopPropagation(),qe(t));break;case`Backspace`:if(w&&!E&&L===``&&I.length>0){let e=N===-1?I.length-1:N,n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&Y(t,null,`removeOption`,{option:I});break;case`Delete`:if(w&&!E&&L===``&&I.length>0&&N!==-1){let e=N,n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&Y(t,null,`removeOption`,{option:I});break;default:}},Ye=e=>{we(!0),N!==-1&&(P(-1),Le(-1)),de&&!_e.current&&Ve(e)},Xe=e=>{if(t(j)){A.current.focus();return}we(!1),ve.current=!0,_e.current=!1,a&&F.current!==-1&&H?We(e,U[F.current],`blur`):a&&y&&L!==``?We(e,L,`blur`,`freeSolo`):s&&z(e,I,`blur`),He(e,`blur`)},Ze=e=>{let t=e.target.value;L!==t&&(R(t),De(!1),T&&T(e,t,`input`)),t===``?!f&&!w&&!D&&Y(e,null,`clear`):Ve(e)},Qe=e=>{let t=Number(e.currentTarget.getAttribute(`data-option-index`));F.current!==t&&Re({event:e,index:t,reason:`mouse`})},$e=e=>{Re({event:e,index:Number(e.currentTarget.getAttribute(`data-option-index`)),reason:`touch`}),Ue.current=!0},et=e=>{We(e,U[Number(e.currentTarget.getAttribute(`data-option-index`))],`selectOption`),Ue.current=!1},tt=e=>t=>{let n=I.slice();n.splice(e,1),Y(t,n,`removeOption`,{option:I[e]})},nt=e=>{Y(e,null,`removeOption`,{option:I})},X=e=>{B?He(e,`toggleInput`):Ve(e)},rt=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute(`id`)!==O&&e.preventDefault()},it=e=>{e.currentTarget.contains(e.target)&&(A.current.focus(),he&&ve.current&&A.current.selectionEnd-A.current.selectionStart===0&&A.current.select(),ve.current=!1)},at=e=>{!m&&(L===``||!B)&&X(e)},ot=y&&L.length>0;ot||=w?I.length>0:I!==null;let st=U;return ee&&(st=U.reduce((e,t,n)=>{let r=ee(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),m&&Ce&&Xe(),{getRootProps:(e={})=>({...e,onKeyDown:Je(e),onMouseDown:rt,onClick:it}),getInputLabelProps:()=>({id:`${O}-label`,htmlFor:O}),getInputProps:()=>({id:O,value:L,onBlur:Xe,onFocus:Ye,onChange:Ze,onMouseDown:at,"aria-activedescendant":H?``:null,"aria-autocomplete":r?`both`:`list`,"aria-controls":Ie?`${O}-listbox`:void 0,"aria-expanded":Ie,autoComplete:`off`,ref:A,autoCapitalize:`none`,spellCheck:`false`,role:`combobox`,disabled:m}),getClearProps:()=>({tabIndex:-1,type:`button`,onClick:qe}),getItemProps:({index:e=0}={})=>({...w&&{key:e},...D?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!E&&{onDelete:w?tt(e):nt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:`button`,onClick:X}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!E&&{onDelete:tt(e)}}),getListboxProps:()=>({role:`listbox`,id:`${O}-listbox`,"aria-labelledby":`${O}-label`,ref:J,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{let n=(w?I:[I]).some(e=>e!=null&&ie(t,e)),r=b?b(t):!1;return{key:x?.(t)??k(t),tabIndex:-1,role:`option`,id:`${O}-option-${e}`,onMouseMove:Qe,onClick:et,onTouchStart:$e,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:O,inputValue:L,value:I,dirty:ot,expanded:H&&M,popupOpen:H,focused:Ce||N!==-1,anchorEl:M,setAnchorEl:ye,focusedItem:N,focusedTag:N,groupedOptions:st}}var Ie=W;function Le(e){return re(`MuiListSubheader`,e)}w(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var G=ae(oe()),Re=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return ge({root:[`root`,n!==`default`&&`color${Se(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},Le,t)},K=j(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${Se(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(P(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),ze=V.forwardRef(function(e,t){let n=R({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,G.jsx)(K,{as:a,className:T(Re(u).root,r),ref:t,ownerState:u,...l})});ze&&(ze.muiSkipListHighlight=!0);var q=ze;function Be(e){return re(`MuiAutocomplete`,e)}var J=w(`MuiAutocomplete`,`root.expanded.fullWidth.focused.focusVisible.tag.tagSizeSmall.tagSizeMedium.hasPopupIcon.hasClearIcon.inputRoot.input.inputFocused.endAdornment.clearIndicator.popupIndicator.popupIndicatorOpen.popper.popperDisablePortal.paper.listbox.loading.noOptions.option.groupLabel.groupUl`.split(`.`)),Ve,He,Y=e=>{let{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:a,hasClearIcon:o,hasPopupIcon:s,inputFocused:c,popupOpen:l,size:u}=e;return ge({root:[`root`,r&&`expanded`,i&&`focused`,a&&`fullWidth`,o&&`hasClearIcon`,s&&`hasPopupIcon`],inputRoot:[`inputRoot`],input:[`input`,c&&`inputFocused`],tag:[`tag`,`tagSize${Se(u)}`],endAdornment:[`endAdornment`],clearIndicator:[`clearIndicator`],popupIndicator:[`popupIndicator`,l&&`popupIndicatorOpen`],popper:[`popper`,n&&`popperDisablePortal`],paper:[`paper`],listbox:[`listbox`],loading:[`loading`],noOptions:[`noOptions`],option:[`option`],groupLabel:[`groupLabel`],groupUl:[`groupUl`]},Be,t)},Ue=j(`div`,{name:`MuiAutocomplete`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:a,inputFocused:o,size:s}=n;return[{[`& .${J.tag}`]:t.tag},{[`& .${J.tag}`]:t[`tagSize${Se(s)}`]},{[`& .${J.inputRoot}`]:t.inputRoot},{[`& .${J.input}`]:t.input},{[`& .${J.input}`]:o&&t.inputFocused},t.root,r&&t.fullWidth,a&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${J.focused} .${J.clearIndicator}`]:{visibility:`visible`},"@media (pointer: fine)":{[`&:hover .${J.clearIndicator}`]:{visibility:`visible`}},[`& .${J.tag}`]:{margin:3,maxWidth:`calc(100% - 6px)`},[`& .${J.inputRoot}`]:{[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:30},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:56},[`& .${J.input}`]:{width:0,minWidth:30}},[`& .${n.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:`4px 4px 4px 0px`}},[`& .${n.root}.${r.sizeSmall}`]:{[`& .${n.input}`]:{padding:`2px 4px 3px 0`}},[`& .${l.root}`]:{padding:9,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${J.input}`]:{padding:`7.5px 4px 7.5px 5px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${l.root}.${r.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${J.input}`]:{padding:`2.5px 4px 2.5px 8px`}},[`& .${a.root}`]:{paddingTop:19,paddingLeft:8,[`.${J.hasPopupIcon}&, .${J.hasClearIcon}&`]:{paddingRight:39},[`.${J.hasPopupIcon}.${J.hasClearIcon}&`]:{paddingRight:65},[`& .${a.input}`]:{padding:`7px 4px`},[`& .${J.endAdornment}`]:{right:9}},[`& .${a.root}.${r.sizeSmall}`]:{paddingBottom:1,[`& .${a.input}`]:{padding:`2.5px 4px`}},[`& .${r.hiddenLabel}`]:{paddingTop:8},[`& .${a.root}.${r.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${J.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${a.root}.${r.hiddenLabel}.${r.sizeSmall}`]:{[`& .${J.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${J.input}`]:{flexGrow:1,textOverflow:`ellipsis`,opacity:0},variants:[{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{[`& .${J.tag}`]:{margin:2,maxWidth:`calc(100% - 4px)`}}},{props:{inputFocused:!0},style:{[`& .${J.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${J.inputRoot}`]:{flexWrap:`wrap`}}}]}),We=j(`div`,{name:`MuiAutocomplete`,slot:`EndAdornment`})({position:`absolute`,right:0,top:`50%`,transform:`translate(0, -50%)`}),Ge=j(ce,{name:`MuiAutocomplete`,slot:`ClearIndicator`})({marginRight:-2,padding:4,visibility:`hidden`}),Ke=j(ce,{name:`MuiAutocomplete`,slot:`PopupIndicator`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:`rotate(180deg)`}}]}),qe=j(h,{name:`MuiAutocomplete`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${J.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(P(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:`absolute`}}]}))),Je=j(se,{name:`MuiAutocomplete`,slot:`Paper`})(P(({theme:e})=>({...e.typography.body1,overflow:`auto`}))),Ye=j(`div`,{name:`MuiAutocomplete`,slot:`Loading`})(P(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Xe=j(`div`,{name:`MuiAutocomplete`,slot:`NoOptions`})(P(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Ze=j(`ul`,{name:`MuiAutocomplete`,slot:`Listbox`})(P(({theme:e})=>({listStyle:`none`,margin:0,padding:`8px 0`,maxHeight:`40vh`,overflow:`auto`,position:`relative`,[`& .${J.option}`]:{minHeight:48,display:`flex`,overflow:`hidden`,justifyContent:`flex-start`,alignItems:`center`,cursor:`pointer`,paddingTop:6,boxSizing:`border-box`,outline:`0`,WebkitTapHighlightColor:`transparent`,paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up(`sm`)]:{minHeight:`auto`},[`&.${J.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:`none`},[`&.${J.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${J.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${J.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Qe=j(q,{name:`MuiAutocomplete`,slot:`GroupLabel`})(P(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),$e=j(`ul`,{name:`MuiAutocomplete`,slot:`GroupUl`})({padding:0,[`& .${J.option}`]:{paddingLeft:24}}),et=V.forwardRef(function(e,n){let r=R({props:e,name:`MuiAutocomplete`}),{autoComplete:i=!1,autoHighlight:a=!1,autoSelect:o=!1,blurOnSelect:s=!1,ChipProps:c,className:l,clearIcon:u=Ve||=(0,G.jsx)(ie,{fontSize:`small`}),clearOnBlur:d=!r.freeSolo,clearOnEscape:f=!1,clearText:p=`Clear`,closeText:m=`Close`,componentsProps:_,defaultValue:v=r.multiple?[]:null,disableClearable:y=!1,disableCloseOnSelect:b=!1,disabled:x=!1,disabledItemsFocusable:S=!1,disableListWrap:ee=!1,disablePortal:C=!1,filterOptions:te,filterSelectedOptions:ne=!1,forcePopupIcon:re=`auto`,freeSolo:w=!1,fullWidth:ae=!1,getLimitTagsText:oe=e=>`+${e}`,getOptionDisabled:ce,getOptionKey:ue,getOptionLabel:de,isOptionEqualToValue:fe,groupBy:pe,handleHomeEndKeys:me=!r.freeSolo,id:E,includeInputInList:D=!1,inputValue:he,limitTags:ge=-1,ListboxComponent:O,ListboxProps:k,loading:_e=!1,loadingText:ve=`Loading…`,multiple:A=!1,noOptionsText:j=`No options`,onChange:M,onClose:ye,onHighlightChange:N,onInputChange:P,onOpen:be,open:F,openOnFocus:xe=!1,openText:I=`Open`,options:Se,PaperComponent:L,PopperComponent:Ce,popupIcon:we=He||=(0,G.jsx)(t,{}),readOnly:z=!1,renderGroup:B,renderInput:Te,renderOption:Ee,renderTags:De,renderValue:Oe,selectOnFocus:ke=!r.freeSolo,size:Ae=`medium`,slots:H={},slotProps:U={},value:je,...Me}=r,{getRootProps:Ne,getInputProps:Pe,getInputLabelProps:Fe,getPopupIndicatorProps:W,getClearProps:Le,getItemProps:Re,getListboxProps:K,getOptionProps:ze,value:q,dirty:Be,expanded:J,id:et,popupOpen:tt,focused:nt,focusedItem:X,anchorEl:rt,setAnchorEl:it,inputValue:at,groupedOptions:ot}=Ie({...r,componentName:`Autocomplete`}),st=!y&&!x&&Be&&!z,ct=(!w||re===!0)&&re!==!1,{onMouseDown:lt}=Pe(),{ref:Z,...ut}=K(),dt=de||(e=>e.label??e),Q={...r,disablePortal:C,expanded:J,focused:nt,fullWidth:ae,getOptionLabel:dt,hasClearIcon:st,hasPopupIcon:ct,inputFocused:X===-1,popupOpen:tt,size:Ae},$=Y(Q),ft={slots:{paper:L,popper:Ce,...H},slotProps:{chip:c,listbox:k,..._,...U}},[pt,mt]=le(`listbox`,{elementType:Ze,externalForwardedProps:ft,ownerState:Q,className:$.listbox,additionalProps:ut,ref:Z}),[ht,gt]=le(`paper`,{elementType:se,externalForwardedProps:ft,ownerState:Q,className:$.paper}),[_t,vt]=le(`popper`,{elementType:h,externalForwardedProps:ft,ownerState:Q,className:$.popper,additionalProps:{disablePortal:C,style:{width:rt?rt.clientWidth:null},role:`presentation`,anchorEl:rt,open:tt}}),yt,bt=e=>({className:$.tag,disabled:x,...Re(e)});if(A?q.length>0&&(yt=De?De(q,bt,Q):Oe?Oe(q,bt,Q):q.map((e,t)=>{let{key:n,...r}=bt({index:t});return(0,G.jsx)(g,{label:dt(e),size:Ae,...r,...ft.slotProps.chip},n)})):Oe&&q!=null&&(yt=Oe(q,bt,Q)),ge>-1&&Array.isArray(yt)){let e=yt.length-ge;!nt&&e>0&&(yt=yt.splice(0,ge),yt.push((0,G.jsx)(`span`,{className:$.tag,children:oe(e)},yt.length)))}let xt=B||(e=>(0,G.jsxs)(`li`,{children:[(0,G.jsx)(Qe,{className:$.groupLabel,ownerState:Q,component:`div`,children:e.group}),(0,G.jsx)($e,{className:$.groupUl,ownerState:Q,children:e.children})]},e.key)),St=Ee||((e,t)=>{let{key:n,...r}=e;return(0,G.jsx)(`li`,{...r,children:dt(t)},n)}),Ct=(e,t)=>{let n=ze({option:e,index:t});return St({...n,className:$.option},e,{selected:n[`aria-selected`],index:t,inputValue:at},Q)},wt=ft.slotProps.clearIndicator,Tt=ft.slotProps.popupIndicator;return(0,G.jsxs)(V.Fragment,{children:[(0,G.jsx)(Ue,{ref:n,className:T($.root,l),ownerState:Q,...Ne(Me),children:Te({id:et,disabled:x,fullWidth:!0,size:Ae===`small`?`small`:void 0,InputLabelProps:Fe(),InputProps:{ref:it,className:$.inputRoot,startAdornment:yt,onMouseDown:e=>{e.target===e.currentTarget&&lt(e)},...(st||ct)&&{endAdornment:(0,G.jsxs)(We,{className:$.endAdornment,ownerState:Q,children:[st?(0,G.jsx)(Ge,{...Le(),"aria-label":p,title:p,ownerState:Q,...wt,className:T($.clearIndicator,wt?.className),children:u}):null,ct?(0,G.jsx)(Ke,{...W(),disabled:x,"aria-label":tt?m:I,title:tt?m:I,ownerState:Q,...Tt,className:T($.popupIndicator,Tt?.className),children:we}):null]})}},inputProps:{className:$.input,disabled:x,readOnly:z,...Pe()}})}),rt?(0,G.jsx)(qe,{as:_t,...vt,children:(0,G.jsxs)(Je,{as:ht,...gt,children:[_e&&ot.length===0?(0,G.jsx)(Ye,{className:$.loading,ownerState:Q,children:ve}):null,ot.length===0&&!w&&!_e?(0,G.jsx)(Xe,{className:$.noOptions,ownerState:Q,role:`presentation`,onMouseDown:e=>{e.preventDefault()},children:j}):null,ot.length>0?(0,G.jsx)(pt,{as:O,...mt,children:ot.map((e,t)=>pe?xt({key:e.key,group:e.group,children:e.options.map((t,n)=>Ct(t,e.index+n))}):Ct(e,t))}):null]})}):null]})});function tt(e){return V.Children.toArray(e).filter(e=>V.isValidElement(e))}function nt(e){return re(`MuiToggleButton`,e)}var X=w(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),rt=V.createContext({}),it=V.createContext(void 0);function at(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var ot=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return ge({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${Se(a)}`,o]},nt,t)},st=j(ve,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${Se(n.size)}`]]}})(P(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${X.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${X.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(te()).map(([t])=>({props:{color:t},style:{[`&.${X.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),ct=V.forwardRef(function(e,t){let{value:n,...r}=V.useContext(rt),i=V.useContext(it),a=R({props:ne({...r,selected:at(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,v={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},y=ot(v),b=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},x=i||``;return(0,G.jsx)(st,{className:T(r.className,y.root,s,x),disabled:l,focusRipple:!u,ref:t,onClick:b,onChange:f,value:g,ownerState:v,"aria-pressed":m,..._,children:o})});function lt(e){return re(`MuiToggleButtonGroup`,e)}var Z=w(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),ut=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return ge({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${Se(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},lt,t)},dt=j(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${Z.grouped}`]:t.grouped},{[`& .${Z.grouped}`]:t[`grouped${Se(n.orientation)}`]},{[`& .${Z.firstButton}`]:t.firstButton},{[`& .${Z.lastButton}`]:t.lastButton},{[`& .${Z.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(P(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${Z.grouped}`]:{[`&.${Z.selected} + .${Z.grouped}.${Z.selected}`]:{borderTop:0,marginTop:0}},[`& .${Z.firstButton},& .${Z.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${Z.lastButton},& .${Z.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${Z.lastButton}.${X.disabled},& .${Z.middleButton}.${X.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${Z.grouped}`]:{[`&.${Z.selected} + .${Z.grouped}.${Z.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${Z.firstButton},& .${Z.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${Z.lastButton},& .${Z.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${Z.lastButton}.${X.disabled},& .${Z.middleButton}.${X.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),Q=V.forwardRef(function(e,t){let n=R({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=ut(m),g=V.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=V.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=V.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=tt(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,G.jsx)(dt,{role:`group`,className:T(h.root,i),ref:t,ownerState:m,...p,children:(0,G.jsx)(rt.Provider,{value:v,children:y.map((e,t)=>(0,G.jsx)(it.Provider,{value:x(t),children:e},t))})})}),$=we((0,G.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),ft=we((0,G.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`),pt=we((0,G.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z`}),`Delete`);function mt({preview:t,configText:n,loading:r,error:i,onLoadPreview:a,onGenerateConfig:o}){let{showSuccess:s}=Te();return(0,G.jsxs)(e,{spacing:2.5,children:[(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Navidrome TOML Configuration`}),(0,G.jsxs)(e,{spacing:1.25,children:[(0,G.jsx)(E,{onClick:a,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,G.jsx)(E,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,G.jsxs)(be,{children:[`Error: `,i]})]}),t&&(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Tag Preview`}),(0,G.jsx)(B,{sx:{overflowX:`auto`},children:(0,G.jsxs)(y,{children:[(0,G.jsx)(x,{children:(0,G.jsxs)(ee,{children:[(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,G.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,G.jsx)(b,{children:t.map(e=>(0,G.jsxs)(ee,{children:[(0,G.jsx)(S,{sx:{borderColor:`divider`},title:e.tag_key,children:e.short_name}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.type}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.total_count}),(0,G.jsx)(S,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Generated Config`}),(0,G.jsx)(_,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,G.jsx)(E,{onClick:()=>{n&&(navigator.clipboard.writeText(n),s(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}var ht=new Set([`artist`,`artists`,`album`,`album_artist`,`genre`,`year`,`date`,`bpm`,`composer`,`label`,`publisher`,`title`,`lyricist`]),gt=new Set([`year`,`bpm`]),_t={artist:`Artist`,artists:`Artists`,album:`Album`,album_artist:`Album Artist`,genre:`Genre`,year:`Year`,date:`Date`,bpm:`BPM`,composer:`Composer`,label:`Label`,publisher:`Publisher`,title:`Title`,lyricist:`Lyricist`,"nom:mood-loose":`Mood (Loose)`,"nom:mood-regular":`Mood (Regular)`,"nom:mood-strict":`Mood (Strict)`};function vt(e){return ht.has(e)||e.startsWith(`nom:`)}function yt(){let[e,t]=(0,V.useState)([]),[n,r]=(0,V.useState)(!1),[i,a]=(0,V.useState)(null),o=(0,V.useCallback)(async()=>{try{r(!0),a(null),t(await _e())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);(0,V.useEffect)(()=>{o()},[o]);let s=(0,V.useMemo)(()=>e.filter(e=>vt(e.key)).map(e=>({...e,type:gt.has(e.key)?`integer`:e.type,label:_t[e.key]??e.short_name??e.key})).sort((e,t)=>e.label.localeCompare(t.label)),[e]);return{tags:s,numericTags:(0,V.useMemo)(()=>s.filter(e=>e.type===`float`||e.type===`integer`),[s]),stringTags:(0,V.useMemo)(()=>s.filter(e=>e.type===`string`),[s]),loading:n,error:i,reload:o}}function bt({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,G.jsxs)(e,{spacing:1.5,children:[(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,G.jsx)(g,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,G.jsx)(C,{children:(0,G.jsxs)(y,{size:`small`,children:[(0,G.jsx)(x,{children:(0,G.jsxs)(ee,{children:[(0,G.jsx)(S,{children:`Title`}),(0,G.jsx)(S,{children:`Artist`}),(0,G.jsx)(S,{children:`Album`})]})}),(0,G.jsx)(b,{children:r.map((e,t)=>(0,G.jsxs)(ee,{children:[(0,G.jsx)(S,{children:e.title??`—`}),(0,G.jsx)(S,{children:e.artist??`—`}),(0,G.jsx)(S,{children:e.album??`—`})]},t))})]})}):(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,G.jsxs)(z,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var xt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`}],St=[{value:`contains`,label:`contains`},{value:`notcontains`,label:`not contains`},{value:`=`,label:`=`},{value:`!=`,label:`≠`}];function Ct({rule:t,numericTags:n,stringTags:r,onChange:a,onRemove:l}){let u=[...n,...r],d=u.find(e=>e.key===t.tagKey),f=d?.type===`float`||d?.type===`integer`,p=f?xt:St,[m,h]=(0,V.useState)([]),[g,y]=(0,V.useState)(!1),b=(0,V.useCallback)(async e=>{if(!e){h([]);return}try{y(!0),h(await me(e))}catch{h([])}finally{y(!1)}},[]);return(0,V.useEffect)(()=>{b(t.tagKey)},[t.tagKey,b]),(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsxs)(o,{size:`small`,sx:{minWidth:180,flex:2},children:[(0,G.jsx)(i,{children:`Tag`}),(0,G.jsxs)(c,{value:t.tagKey,label:`Tag`,onChange:e=>{let n=e.target.value,r=u.find(e=>e.key===n),i=f,o=r?.type===`float`||r?.type===`integer`,s=i===o&&p.some(e=>e.value===t.operator),c=o?`=`:`contains`;a({...t,tagKey:n,operator:s?t.operator:c,value:i===o?t.value:``})},children:[n.length>0&&(0,G.jsx)(q,{children:`Numeric`}),n.map(e=>(0,G.jsx)(s,{value:e.key,children:e.label},e.key)),r.length>0&&(0,G.jsx)(q,{children:`Text`}),r.map(e=>(0,G.jsx)(s,{value:e.key,children:e.label},e.key))]})]}),(0,G.jsxs)(o,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,G.jsx)(i,{children:`Op`}),(0,G.jsx)(c,{value:t.operator,label:`Op`,onChange:e=>{a({...t,operator:e.target.value})},children:p.map(e=>(0,G.jsx)(s,{value:e.value,children:e.label},e.value))})]}),(0,G.jsx)(et,{size:`small`,freeSolo:!0,options:m,loading:g,value:t.value||null,inputValue:t.value,onInputChange:(e,n)=>{a({...t,value:n})},onChange:(e,n)=>{a({...t,value:n??``})},renderInput:e=>(0,G.jsx)(_,{...e,label:`Value`,type:f?`number`:`text`,inputProps:{...e.inputProps,...f?{step:`any`}:{}}}),sx:{flex:2,minWidth:160}}),(0,G.jsx)(v,{title:`Remove rule`,children:(0,G.jsx)(ce,{size:`small`,onClick:l,color:`error`,children:(0,G.jsx)(De,{fontSize:`small`})})})]})}var wt=1;function Tt(){return{id:String(wt++),tagKey:``,operator:`=`,value:``}}function Et(e=`all`){return{id:String(wt++),logic:e,rules:[],groups:[]}}function Dt(e){let t=[],n=e.rules.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`);t.push(...n);for(let n of e.groups){let e=Dt(n);e&&t.push(`(${e})`)}let r=e.logic===`all`?` AND `:` OR `;return t.join(r)}function Ot({group:t,numericTags:n,stringTags:r,depth:i=0,onGroupChange:a,onRemove:o}){let s=i===0,[c,l]=(0,V.useState)(!1),u=t.rules.length>0||t.groups.length>0,d=()=>{a({...t,rules:[...t.rules,Tt()]})},f=(e,n)=>{a({...t,rules:t.rules.map((t,r)=>r===e?n:t)})},p=e=>{a({...t,rules:t.rules.filter((t,n)=>n!==e)})},m=(e,n)=>{n&&a({...t,logic:n})},h=(e,n)=>{a({...t,groups:t.groups.map((t,r)=>r===e?n:t)})},g=e=>{a({...t,groups:t.groups.filter((t,n)=>n!==e)})},_=()=>{let e=Et(t.logic);a({...t,groups:[...t.groups,e]})},y=()=>{u?l(!0):o&&o()},b=()=>{l(!1),o&&o()},x=()=>{l(!1)};return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(B,{sx:s?{}:{border:1,borderColor:`divider`,borderRadius:1,p:2,ml:2},children:(0,G.jsxs)(e,{spacing:1.5,children:[(0,G.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,children:s?`Match`:`Group match`}),(0,G.jsxs)(Q,{value:t.logic,exclusive:!0,onChange:m,size:`small`,children:[(0,G.jsx)(ct,{value:`all`,children:`ALL`}),(0,G.jsx)(ct,{value:`any`,children:`ANY`})]}),!s&&o&&(0,G.jsx)(v,{title:`Remove group`,children:(0,G.jsx)(ce,{size:`small`,onClick:y,color:`error`,sx:{ml:`auto`},children:(0,G.jsx)(pt,{fontSize:`small`})})})]}),t.rules.map((e,t)=>(0,G.jsx)(Ct,{rule:e,numericTags:n,stringTags:r,onChange:e=>f(t,e),onRemove:()=>p(t)},e.id)),t.groups.map((e,t)=>(0,G.jsx)(Ot,{group:e,numericTags:n,stringTags:r,depth:i+1,onGroupChange:e=>h(t,e),onRemove:()=>g(t)},e.id)),(0,G.jsxs)(e,{direction:`row`,spacing:1,children:[(0,G.jsx)(E,{startIcon:(0,G.jsx)(Ee,{}),onClick:d,variant:`outlined`,size:`small`,children:`Add Rule`}),(0,G.jsx)(E,{startIcon:(0,G.jsx)(Ee,{}),onClick:_,variant:`outlined`,size:`small`,children:`Add Group`})]})]})}),(0,G.jsxs)(O,{open:c,onClose:x,children:[(0,G.jsx)(he,{children:`Remove Group?`}),(0,G.jsx)(ye,{children:(0,G.jsxs)(xe,{children:[`This group contains `,t.rules.length,` rule(s) and`,` `,t.groups.length,` nested group(s). Are you sure you want to remove it?`]})}),(0,G.jsxs)(k,{children:[(0,G.jsx)(E,{onClick:x,children:`Cancel`}),(0,G.jsx)(E,{onClick:b,color:`error`,autoFocus:!0,children:`Remove`})]})]})]})}function kt({rootGroup:t,numericTags:n,stringTags:r,onGroupChange:i}){return(0,G.jsx)(e,{spacing:1.5,children:(0,G.jsx)(Ot,{group:t,numericTags:n,stringTags:r,depth:0,onGroupChange:i})})}var At=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function jt(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function Mt({value:t,onChange:n}){let{column:r,descending:a}=jt(t);return(0,G.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,G.jsxs)(o,{size:`small`,sx:{minWidth:140},children:[(0,G.jsx)(i,{children:`Sort by`}),(0,G.jsx)(c,{value:r,label:`Sort by`,onChange:e=>{let t=e.target.value;n(a?`-${t}`:t)},children:At.map(e=>(0,G.jsx)(s,{value:e.value,children:e.label},e.value))})]}),r!==`random`&&(0,G.jsx)(v,{title:a?`Descending`:`Ascending`,children:(0,G.jsx)(ce,{size:`small`,onClick:()=>{n(a?r:`-${r}`)},children:a?(0,G.jsx)($,{}):(0,G.jsx)(ft,{})})})]})}function Nt({rootGroup:t,name:n,comment:r,limit:i,sort:a,preview:o,content:s,loading:c,error:l,onGroupChange:u,onNameChange:d,onCommentChange:f,onLimitChange:p,onSortChange:m,onPreview:h,onGenerate:g}){let{numericTags:v,stringTags:y,loading:b}=yt(),x=Dt(t),S=x.length>0;return(0,G.jsxs)(e,{spacing:2.5,children:[(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Smart Playlist Generator`}),(0,G.jsxs)(e,{spacing:2,children:[b?(0,G.jsxs)(B,{sx:{display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,py:4,gap:2},children:[(0,G.jsx)(A,{size:40}),(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,children:`Loading tag metadata…`})]}):(0,G.jsx)(kt,{rootGroup:t,numericTags:v,stringTags:y,onGroupChange:u}),x&&(0,G.jsx)(_,{value:x,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,G.jsxs)(B,{children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,G.jsx)(_,{value:n,onChange:e=>d(e.target.value),disabled:c,required:!0,fullWidth:!0,size:`small`})]}),(0,G.jsxs)(B,{children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,G.jsx)(_,{value:r,onChange:e=>f(e.target.value),disabled:c,fullWidth:!0,size:`small`})]}),(0,G.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,G.jsxs)(B,{children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,G.jsx)(Mt,{value:a,onChange:m})]}),(0,G.jsxs)(B,{children:[(0,G.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,G.jsx)(_,{type:`number`,value:i??``,onChange:e=>p(e.target.value?parseInt(e.target.value):void 0),disabled:c,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,G.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,G.jsx)(E,{variant:`contained`,disabled:c||!S,onClick:h,fullWidth:!0,children:c?`Loading…`:`Preview Query`}),(0,G.jsx)(E,{variant:`contained`,disabled:c||!S,onClick:g,fullWidth:!0,children:c?`Generating…`:`Generate .nsp`})]})]}),l&&(0,G.jsxs)(be,{children:[`Error: `,l]})]}),o&&(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Query Preview`}),(0,G.jsx)(bt,{data:o})]}),s&&(0,G.jsxs)(M,{children:[(0,G.jsx)(D,{title:`Generated Playlist (.nsp)`}),(0,G.jsx)(_,{multiline:!0,rows:15,value:s,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,G.jsx)(E,{onClick:()=>{if(s){let e=new Blob([s],{type:`text/plain`}),t=URL.createObjectURL(e),r=document.createElement(`a`);r.href=t,r.download=`${n}.nsp`,r.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Pt(){let{showError:e}=Te(),[t,n]=(0,V.useState)(null),[r,i]=(0,V.useState)(null),[a,o]=(0,V.useState)(!1),[s,c]=(0,V.useState)(null),[l,u]=(0,V.useState)(()=>{let e=Et(`all`);return e.rules=[Tt()],e}),[d,f]=(0,V.useState)(`My Playlist`),[p,m]=(0,V.useState)(``),[h,g]=(0,V.useState)(void 0),[_,v]=(0,V.useState)(``),[y,b]=(0,V.useState)(null),[x,S]=(0,V.useState)(null),[ee,C]=(0,V.useState)(!1),[te,ne]=(0,V.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRootGroup:l,playlistName:d,playlistComment:p,playlistLimit:h,playlistSort:_,playlistPreview:y,playlistContent:x,playlistLoading:ee,playlistError:te,loadConfigPreview:async()=>{try{o(!0),c(null),n((await I()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await N()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}try{C(!0),ne(null),b(await F(t,10))}catch(e){ne(e instanceof Error?e.message:`Failed to preview playlist`)}finally{C(!1)}},generatePlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}if(!d.trim()){e(`Playlist name is required`);return}try{C(!0),ne(null),S((await Ce({query:t,playlist_name:d,comment:p,limit:h,sort:_||void 0})).content)}catch(e){ne(e instanceof Error?e.message:`Failed to generate playlist`)}finally{C(!1)}},setPlaylistRootGroup:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:g,setPlaylistSort:v}}function Ft(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRootGroup:a,playlistName:o,playlistComment:s,playlistLimit:c,playlistSort:l,playlistPreview:u,playlistContent:h,playlistLoading:g,playlistError:_,loadConfigPreview:v,generateConfig:y,previewPlaylist:b,generatePlaylist:x,setPlaylistRootGroup:S,setPlaylistName:ee,setPlaylistComment:C,setPlaylistLimit:te,setPlaylistSort:ne}=Pt();return(0,G.jsx)(L,{title:`Navidrome`,children:(0,G.jsxs)(e,{spacing:2,children:[(0,G.jsxs)(p,{defaultExpanded:!0,disableGutters:!0,children:[(0,G.jsx)(m,{expandIcon:(0,G.jsx)(d,{}),children:(0,G.jsx)(z,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,G.jsx)(f,{children:(0,G.jsx)(mt,{preview:t,configText:n,loading:r,error:i,onLoadPreview:v,onGenerateConfig:y})})]}),(0,G.jsxs)(p,{disableGutters:!0,children:[(0,G.jsx)(m,{expandIcon:(0,G.jsx)(d,{}),children:(0,G.jsx)(z,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,G.jsx)(f,{children:(0,G.jsx)(Nt,{rootGroup:a,name:o,comment:s,limit:c,sort:l,preview:u,content:h,loading:g,error:_,onGroupChange:S,onNameChange:ee,onCommentChange:C,onLimitChange:te,onSortChange:ne,onPreview:b,onGenerate:x})})]})]})})}export{Ft as NavidromePage};