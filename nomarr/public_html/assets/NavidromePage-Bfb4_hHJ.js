import{t as e}from"./Stack-CAFvF0UM.js";import"./listItemTextClasses-9OxOGNj_.js";import{a as t,i as n,n as r,r as i,t as a}from"./TextField-CYg-dUi_.js";import{i as o,n as s,r as c,t as l}from"./ExpandMore-Luh44wfZ.js";import"./Popper-D5Ar-Qyh.js";import{t as u}from"./Chip-BkTL4Prg.js";import{t as d}from"./Tooltip-qUb_154x.js";import{a as f,i as p,n as m,r as h,t as g}from"./TableRow-B2x2MPhL.js";import{t as _}from"./TableContainer-C9gE8cH3.js";import{$t as v,Bt as y,Dn as b,J as x,Kt as S,Tn as C,Vt as w,Wt as T,Y as E,_t as D,a as O,an as k,cn as A,ct as j,dt as M,et as N,gt as ee,i as te,ln as P,mn as ne,mt as F,n as re,r as ie,st as I,t as L,tt as R,un as z,zt as B}from"./index-D_XI8DwD.js";import{t as ae}from"./Close-CTvcekD2.js";import{t as V}from"./useNotification-DNqPpRk7.js";function oe(e){return P(`MuiListSubheader`,e)}A(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var H=b(C()),U=b(ne()),se=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return v({root:[`root`,n!==`default`&&`color${w(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},oe,t)},ce=S(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${w(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(y(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),W=H.forwardRef(function(e,t){let n=T({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,U.jsx)(ce,{as:a,className:z(se(u).root,r),ref:t,ownerState:u,...l})});W&&(W.muiSkipListHighlight=!0);var G=W;function le(e){return H.Children.toArray(e).filter(e=>H.isValidElement(e))}function ue(e){return P(`MuiToggleButton`,e)}var K=A(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),q=H.createContext({}),J=H.createContext(void 0);function de(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var fe=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return v({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${w(a)}`,o]},ue,t)},pe=S(D,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${w(n.size)}`]]}})(y(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${K.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${K.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(ee()).map(([t])=>({props:{color:t},style:{[`&.${K.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),Y=H.forwardRef(function(e,t){let{value:n,...r}=H.useContext(q),i=H.useContext(J),a=T({props:k({...r,selected:de(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,v={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},y=fe(v),b=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},x=i||``;return(0,U.jsx)(pe,{className:z(r.className,y.root,s,x),disabled:l,focusRipple:!u,ref:t,onClick:b,onChange:f,value:g,ownerState:v,"aria-pressed":m,..._,children:o})});function me(e){return P(`MuiToggleButtonGroup`,e)}var X=A(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),he=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return v({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${w(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},me,t)},ge=S(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${w(n.orientation)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(y(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderTop:0,marginTop:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${X.lastButton}.${K.disabled},& .${X.middleButton}.${K.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${X.lastButton}.${K.disabled},& .${X.middleButton}.${K.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),_e=H.forwardRef(function(e,t){let n=T({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=he(m),g=H.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=H.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=H.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=le(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,U.jsx)(ge,{role:`group`,className:z(h.root,i),ref:t,ownerState:m,...p,children:(0,U.jsx)(q.Provider,{value:v,children:y.map((e,t)=>(0,U.jsx)(J.Provider,{value:x(t),children:e},t))})})}),ve=B((0,U.jsx)(`path`,{d:`M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z`}),`Add`),ye=B((0,U.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),be=B((0,U.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`);function xe({preview:t,configText:n,loading:r,error:i,onLoadPreview:o,onGenerateConfig:s}){let{showSuccess:c}=V();return(0,U.jsxs)(e,{spacing:2.5,children:[(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Navidrome TOML Configuration`}),(0,U.jsxs)(e,{spacing:1.25,children:[(0,U.jsx)(I,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,U.jsx)(I,{onClick:s,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,U.jsxs)(x,{children:[`Error: `,i]})]}),t&&(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Tag Preview`}),(0,U.jsx)(j,{sx:{overflowX:`auto`},children:(0,U.jsxs)(f,{children:[(0,U.jsx)(m,{children:(0,U.jsxs)(g,{children:[(0,U.jsx)(h,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,U.jsx)(h,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,U.jsx)(h,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,U.jsx)(h,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,U.jsx)(h,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,U.jsx)(p,{children:t.map(e=>(0,U.jsxs)(g,{children:[(0,U.jsx)(h,{sx:{borderColor:`divider`},children:e.tag_key}),(0,U.jsx)(h,{sx:{borderColor:`divider`},children:e.type}),(0,U.jsx)(h,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,U.jsx)(h,{sx:{borderColor:`divider`},children:e.total_count}),(0,U.jsx)(h,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Generated Config`}),(0,U.jsx)(a,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,U.jsx)(I,{onClick:()=>{n&&(navigator.clipboard.writeText(n),c(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}function Se(){let[e,t]=(0,H.useState)([]),[n,r]=(0,H.useState)(!1),[i,a]=(0,H.useState)(null),o=(0,H.useCallback)(async()=>{try{r(!0),a(null),t(await te())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);return(0,H.useEffect)(()=>{o()},[o]),{tags:e,numericTags:(0,H.useMemo)(()=>e.filter(e=>e.type===`float`||e.type===`integer`),[e]),stringTags:(0,H.useMemo)(()=>e.filter(e=>e.type===`string`),[e]),loading:n,error:i,reload:o}}function Ce({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,U.jsxs)(e,{spacing:1.5,children:[(0,U.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,U.jsx)(u,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,U.jsx)(_,{children:(0,U.jsxs)(f,{size:`small`,children:[(0,U.jsx)(m,{children:(0,U.jsxs)(g,{children:[(0,U.jsx)(h,{children:`Title`}),(0,U.jsx)(h,{children:`Artist`}),(0,U.jsx)(h,{children:`Album`})]})}),(0,U.jsx)(p,{children:r.map((e,t)=>(0,U.jsxs)(g,{children:[(0,U.jsx)(h,{children:e.title??`—`}),(0,U.jsx)(h,{children:e.artist??`—`}),(0,U.jsx)(h,{children:e.album??`—`})]},t))})]})}):(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,U.jsxs)(M,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var we=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`},{value:`>=`,label:`≥`},{value:`<=`,label:`≤`}],Te=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`contains`,label:`contains`}];function Z(e){if(e.type===`string`){let t=e.summary.match(/unique=(\d+)/);return t?`${t[1]} values`:``}let t=e.summary.match(/min=([\d.]+)/),n=e.summary.match(/max=([\d.]+)/);return t&&n?`${t[1]} – ${n[1]}`:``}function Ee({rule:o,numericTags:s,stringTags:c,onChange:l,onRemove:u}){let f=[...s,...c].find(e=>e.key===o.tagKey),p=f?.type===`float`||f?.type===`integer`,m=p?we:Te;return(0,U.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,U.jsxs)(t,{size:`small`,sx:{minWidth:200,flex:2},children:[(0,U.jsx)(n,{children:`Tag`}),(0,U.jsxs)(r,{value:o.tagKey,label:`Tag`,onChange:e=>{let t=e.target.value,n=[...s,...c].find(e=>e.key===t),r=p,i=n?.type===`float`||n?.type===`integer`,a=r===i&&m.some(e=>e.value===o.operator);l({...o,tagKey:t,operator:a?o.operator:`=`,value:r===i?o.value:``})},children:[s.length>0&&(0,U.jsx)(G,{children:`Numeric`}),s.map(e=>{let t=Z(e);return(0,U.jsxs)(i,{value:e.key,children:[e.key,t&&` (${t})`]},e.key)}),c.length>0&&(0,U.jsx)(G,{children:`Text`}),c.map(e=>{let t=Z(e);return(0,U.jsxs)(i,{value:e.key,children:[e.key,t&&` (${t})`]},e.key)})]})]}),(0,U.jsxs)(t,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,U.jsx)(n,{children:`Op`}),(0,U.jsx)(r,{value:o.operator,label:`Op`,onChange:e=>{l({...o,operator:e.target.value})},children:m.map(e=>(0,U.jsx)(i,{value:e.value,children:e.label},e.value))})]}),(0,U.jsx)(a,{size:`small`,label:`Value`,type:p?`number`:`text`,value:o.value,onChange:e=>{l({...o,value:e.target.value})},slotProps:p?{htmlInput:{step:`any`}}:void 0,sx:{flex:2}}),(0,U.jsx)(d,{title:`Remove rule`,children:(0,U.jsx)(F,{size:`small`,onClick:u,color:`error`,children:(0,U.jsx)(ae,{fontSize:`small`})})})]})}var De=1;function Q(){return{id:String(De++),tagKey:``,operator:`=`,value:``}}function $(e,t){let n=e.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`),r=t===`all`?` AND `:` OR `;return n.join(r)}function Oe({rules:t,logic:n,numericTags:r,stringTags:i,onRulesChange:a,onLogicChange:o}){let s=()=>{a([...t,Q()])},c=(e,n)=>{let r=[...t];r[e]=n,a(r)},l=e=>{a(t.filter((t,n)=>n!==e))};return(0,U.jsxs)(e,{spacing:1.5,children:[(0,U.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,children:`Match`}),(0,U.jsxs)(_e,{value:n,exclusive:!0,onChange:(e,t)=>{t&&o(t)},size:`small`,children:[(0,U.jsx)(Y,{value:`all`,children:`ALL rules`}),(0,U.jsx)(Y,{value:`any`,children:`ANY rule`})]})]}),t.map((e,t)=>(0,U.jsx)(Ee,{rule:e,numericTags:r,stringTags:i,onChange:e=>c(t,e),onRemove:()=>l(t)},e.id)),(0,U.jsx)(I,{startIcon:(0,U.jsx)(ve,{}),onClick:s,size:`small`,sx:{alignSelf:`flex-start`},children:`Add Rule`})]})}var ke=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function Ae(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function je({value:a,onChange:o}){let{column:s,descending:c}=Ae(a);return(0,U.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,U.jsxs)(t,{size:`small`,sx:{minWidth:140},children:[(0,U.jsx)(n,{children:`Sort by`}),(0,U.jsx)(r,{value:s,label:`Sort by`,onChange:e=>{let t=e.target.value;o(c?`-${t}`:t)},children:ke.map(e=>(0,U.jsx)(i,{value:e.value,children:e.label},e.value))})]}),s!==`random`&&(0,U.jsx)(d,{title:c?`Descending`:`Ascending`,children:(0,U.jsx)(F,{size:`small`,onClick:()=>{o(c?s:`-${s}`)},children:c?(0,U.jsx)(ye,{}):(0,U.jsx)(be,{})})})]})}function Me({rules:t,logic:n,name:r,comment:i,limit:o,sort:s,preview:c,content:l,loading:u,error:d,onRulesChange:f,onLogicChange:p,onNameChange:m,onCommentChange:h,onLimitChange:g,onSortChange:_,onPreview:v,onGenerate:y}){let{numericTags:b,stringTags:S,loading:C}=Se(),w=$(t,n),T=w.length>0;return(0,U.jsxs)(e,{spacing:2.5,children:[(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Smart Playlist Generator`}),(0,U.jsxs)(e,{spacing:2,children:[(0,U.jsx)(Oe,{rules:t,logic:n,numericTags:b,stringTags:S,onRulesChange:f,onLogicChange:p}),C&&(0,U.jsx)(M,{variant:`caption`,color:`text.secondary`,children:`Loading tag metadata…`}),w&&(0,U.jsx)(a,{value:w,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,U.jsxs)(j,{children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,U.jsx)(a,{value:r,onChange:e=>m(e.target.value),disabled:u,required:!0,fullWidth:!0,size:`small`})]}),(0,U.jsxs)(j,{children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,U.jsx)(a,{value:i,onChange:e=>h(e.target.value),disabled:u,fullWidth:!0,size:`small`})]}),(0,U.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,U.jsxs)(j,{children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,U.jsx)(je,{value:s,onChange:_})]}),(0,U.jsxs)(j,{children:[(0,U.jsx)(M,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,U.jsx)(a,{type:`number`,value:o??``,onChange:e=>g(e.target.value?parseInt(e.target.value):void 0),disabled:u,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,U.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,U.jsx)(I,{variant:`contained`,disabled:u||!T,onClick:v,fullWidth:!0,children:u?`Loading…`:`Preview Query`}),(0,U.jsx)(I,{variant:`contained`,disabled:u||!T,onClick:y,fullWidth:!0,children:u?`Generating…`:`Generate .nsp`})]})]}),d&&(0,U.jsxs)(x,{children:[`Error: `,d]})]}),c&&(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Query Preview`}),(0,U.jsx)(Ce,{data:c})]}),l&&(0,U.jsxs)(R,{children:[(0,U.jsx)(N,{title:`Generated Playlist (.nsp)`}),(0,U.jsx)(a,{multiline:!0,rows:15,value:l,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,U.jsx)(I,{onClick:()=>{if(l){let e=new Blob([l],{type:`text/plain`}),t=URL.createObjectURL(e),n=document.createElement(`a`);n.href=t,n.download=`${r}.nsp`,n.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Ne(){let{showError:e}=V(),[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(null),[a,o]=(0,H.useState)(!1),[s,c]=(0,H.useState)(null),[l,u]=(0,H.useState)([Q()]),[d,f]=(0,H.useState)(`all`),[p,m]=(0,H.useState)(`My Playlist`),[h,g]=(0,H.useState)(``),[_,v]=(0,H.useState)(void 0),[y,b]=(0,H.useState)(``),[x,S]=(0,H.useState)(null),[C,w]=(0,H.useState)(null),[T,E]=(0,H.useState)(!1),[D,k]=(0,H.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRules:l,playlistLogic:d,playlistName:p,playlistComment:h,playlistLimit:_,playlistSort:y,playlistPreview:x,playlistContent:C,playlistLoading:T,playlistError:D,loadConfigPreview:async()=>{try{o(!0),c(null),n((await ie()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await re()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=$(l,d);if(!t.trim()){e(`Add at least one complete rule`);return}try{E(!0),k(null),S(await O(t,10))}catch(e){k(e instanceof Error?e.message:`Failed to preview playlist`)}finally{E(!1)}},generatePlaylist:async()=>{let t=$(l,d);if(!t.trim()){e(`Add at least one complete rule`);return}if(!p.trim()){e(`Playlist name is required`);return}try{E(!0),k(null),w((await L({query:t,playlist_name:p,comment:h,limit:_,sort:y||void 0})).content)}catch(e){k(e instanceof Error?e.message:`Failed to generate playlist`)}finally{E(!1)}},setPlaylistRules:u,setPlaylistLogic:f,setPlaylistName:m,setPlaylistComment:g,setPlaylistLimit:v,setPlaylistSort:b}}function Pe(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRules:a,playlistLogic:u,playlistName:d,playlistComment:f,playlistLimit:p,playlistSort:m,playlistPreview:h,playlistContent:g,playlistLoading:_,playlistError:v,loadConfigPreview:y,generateConfig:b,previewPlaylist:x,generatePlaylist:S,setPlaylistRules:C,setPlaylistLogic:w,setPlaylistName:T,setPlaylistComment:D,setPlaylistLimit:O,setPlaylistSort:k}=Ne();return(0,U.jsx)(E,{title:`Navidrome`,children:(0,U.jsxs)(e,{spacing:2,children:[(0,U.jsxs)(o,{defaultExpanded:!0,disableGutters:!0,children:[(0,U.jsx)(s,{expandIcon:(0,U.jsx)(l,{}),children:(0,U.jsx)(M,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,U.jsx)(c,{children:(0,U.jsx)(xe,{preview:t,configText:n,loading:r,error:i,onLoadPreview:y,onGenerateConfig:b})})]}),(0,U.jsxs)(o,{disableGutters:!0,children:[(0,U.jsx)(s,{expandIcon:(0,U.jsx)(l,{}),children:(0,U.jsx)(M,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,U.jsx)(c,{children:(0,U.jsx)(Me,{rules:a,logic:u,name:d,comment:f,limit:p,sort:m,preview:h,content:g,loading:_,error:v,onRulesChange:C,onLogicChange:w,onNameChange:T,onCommentChange:D,onLimitChange:O,onSortChange:k,onPreview:x,onGenerate:S})})]})]})})}export{Pe as NavidromePage};