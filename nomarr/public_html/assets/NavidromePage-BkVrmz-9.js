import{t as e}from"./Stack-BxZspPnU.js";import"./listItemTextClasses-ENR1_cxX.js";import{a as t,c as n,i as r,l as i,n as a,o,r as s,s as c,t as l,u}from"./TextField-Q82J_Gyh.js";import{n as d}from"./useControlled-CQLb1l0o.js";import{i as f,n as p,r as m,t as h}from"./ExpandMore-BwedZZep.js";import{t as g}from"./Popper-CZ65LEmg.js";import{t as _}from"./Chip-DbZUJDWD.js";import{t as ee}from"./Tooltip-x88mSfZ9.js";import{a as v,i as y,n as b,r as x,t as S}from"./TableRow-_mn0WSvB.js";import{t as C}from"./TableContainer-D4PaUvBb.js";import{Ct as te,Et as ne,Fn as re,Kt as ie,Ln as ae,Ot as w,Q as oe,St as se,Tt as ce,Wt as le,Xt as T,Yt as ue,Z as de,Zt as fe,a as pe,bn as E,ct as D,dt as me,en as he,gt as O,hn as k,ht as A,i as ge,it as j,kt as M,ln as _e,lt as ve,n as N,nn as P,o as ye,r as F,rt as be,st as I,t as xe,un as Se,ut as L,vn as R,wn as Ce,yn as we,yt as z}from"./index-xv6GugTr.js";import{t as Te}from"./Close-BMEzhelR.js";import{t as Ee}from"./useNotification-BaYX-3YW.js";var B=ae(re());function De(e){let t=B.useRef({});return B.useEffect(()=>{t.current=e}),t.current}var Oe=De;function ke({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function Ae(e){return e.normalize(`NFD`).replace(/[\u0300-\u036f]/g,``)}function je(e={}){let{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i=`any`,stringify:a,trim:o=!1}=e;return(e,{inputValue:s,getOptionLabel:c})=>{let l=o?s.trim():s;n&&(l=l.toLowerCase()),t&&(l=Ae(l));let u=l?e.filter(e=>{let r=(a||c)(e);return n&&(r=r.toLowerCase()),t&&(r=Ae(r)),i===`start`?r.startsWith(l):r.includes(l)}):e;return typeof r==`number`?u.slice(0,r):u}}var Me=je(),Ne=5,Pe=e=>e.current!==null&&e.current.parentElement?.contains(document.activeElement),Fe=[];function Ie(e,t,n,r){if(t||e==null||r)return``;let i=n(e);return typeof i==`string`?i:``}function V(e){let{unstable_isActiveElementInListbox:t=Pe,unstable_classNamePrefix:n=`Mui`,autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:o=!1,clearOnBlur:s=!e.freeSolo,clearOnEscape:c=!1,componentName:l=`useAutocomplete`,defaultValue:u=e.multiple?Fe:null,disableClearable:f=!1,disableCloseOnSelect:p=!1,disabled:m,disabledItemsFocusable:h=!1,disableListWrap:g=!1,filterOptions:_=Me,filterSelectedOptions:ee=!1,freeSolo:v=!1,getOptionDisabled:y,getOptionKey:b,getOptionLabel:x=e=>e.label??e,groupBy:S,handleHomeEndKeys:C=!e.freeSolo,id:te,includeInputInList:ne=!1,inputValue:re,isOptionEqualToValue:ae=(e,t)=>e===t,multiple:w=!1,onChange:oe,onClose:se,onHighlightChange:ce,onInputChange:T,onOpen:ue,open:de,openOnFocus:fe=!1,options:pe,readOnly:E=!1,renderValue:D,selectOnFocus:me=!e.freeSolo,value:he}=e,O=Se(te),k=x;k=e=>{let t=x(e);return typeof t==`string`?t:String(t)};let A=B.useRef(!1),ge=B.useRef(!0),j=B.useRef(null),M=B.useRef(null),[_e,ve]=B.useState(null),[N,P]=B.useState(-1),ye=i?0:-1,F=B.useRef(ye),be=B.useRef(Ie(u??he,w,k)).current,[I,xe]=d({controlled:he,default:u,name:l}),[L,R]=d({controlled:re,default:be,name:l,state:`inputValue`}),[Ce,we]=B.useState(!1),z=B.useCallback((e,t,n)=>{if(!(w?I.length<t.length:t!==null)&&!s)return;let r=Ie(t,w,k,D);L!==r&&(R(r),T&&T(e,r,n))},[k,L,w,T,R,s,I,D]),[Te,Ee]=d({controlled:de,default:!1,name:l,state:`open`}),[De,Ae]=B.useState(!0),je=!w&&I!=null&&L===k(I),V=Te&&!E,H=V?_(pe.filter(e=>!(ee&&(w?I:[I]).some(t=>t!==null&&ae(e,t)))),{inputValue:je&&De?``:L,getOptionLabel:k}):[],U=Oe({filteredOptions:H,value:I,inputValue:L});B.useEffect(()=>{let e=I!==U.value;Ce&&!e||v&&!e||z(null,I,`reset`)},[I,z,Ce,U.value,v]);let W=Te&&H.length>0&&!E,Le=le(e=>{if(e===-1)j.current.focus();else{let t=D?`data-item-index`:`data-tag-index`;_e.querySelector(`[${t}="${e}"]`).focus()}});B.useEffect(()=>{w&&N>I.length-1&&(P(-1),Le(-1))},[I,w,N,Le]);function Re(e,t){if(!M.current||e<0||e>=H.length)return-1;let n=e;for(;;){let r=M.current.querySelector(`[data-option-index="${n}"]`),i=h?!1:!r||r.disabled||r.getAttribute(`aria-disabled`)===`true`;if(r&&r.hasAttribute(`tabindex`)&&!i)return n;if(n=t===`next`?(n+1)%H.length:(n-1+H.length)%H.length,n===e)return-1}}let G=le(({event:e,index:t,reason:r})=>{if(F.current=t,t===-1?j.current.removeAttribute(`aria-activedescendant`):j.current.setAttribute(`aria-activedescendant`,`${O}-option-${t}`),ce&&[`mouse`,`keyboard`,`touch`].includes(r)&&ce(e,t===-1?null:H[t],r),!M.current)return;let i=M.current.querySelector(`[role="option"].${n}-focused`);i&&(i.classList.remove(`${n}-focused`),i.classList.remove(`${n}-focusVisible`));let a=M.current;if(M.current.getAttribute(`role`)!==`listbox`&&(a=M.current.parentElement.querySelector(`[role="listbox"]`)),!a)return;if(t===-1){a.scrollTop=0;return}let o=M.current.querySelector(`[data-option-index="${t}"]`);if(o&&(o.classList.add(`${n}-focused`),r===`keyboard`&&o.classList.add(`${n}-focusVisible`),a.scrollHeight>a.clientHeight&&r!==`mouse`&&r!==`touch`)){let e=o,t=a.clientHeight+a.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?a.scrollTop=n-a.clientHeight:e.offsetTop-e.offsetHeight*(S?1.3:0)<a.scrollTop&&(a.scrollTop=e.offsetTop-e.offsetHeight*(S?1.3:0))}}),K=le(({event:e,diff:t,direction:n=`next`,reason:i})=>{if(!V)return;let a=Re((()=>{let e=H.length-1;if(t===`reset`)return ye;if(t===`start`)return 0;if(t===`end`)return e;let n=F.current+t;return n<0?n===-1&&ne?-1:g&&F.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&ne?-1:g||Math.abs(t)>1?e:0:n})(),n);if(G({index:a,reason:i,event:e}),r&&t!==`reset`)if(a===-1)j.current.value=L;else{let e=k(H[a]);j.current.value=e,e.toLowerCase().indexOf(L.toLowerCase())===0&&L.length>0&&j.current.setSelectionRange(L.length,e.length)}}),ze=!ke({array1:U.filteredOptions,array2:H,parser:k}),q=()=>{if(F.current!==-1&&!ke({array1:U.filteredOptions,array2:H,parser:k})&&U.inputValue===L&&(w?I.length===U.value.length&&U.value.every((e,t)=>k(I[t])===k(e)):((e,t)=>(e?k(e):``)===(t?k(t):``))(U.value,I))){let e=U.filteredOptions[F.current];if(e)return H.findIndex(t=>k(t)===k(e))}return-1},Be=B.useCallback(()=>{if(!V)return;let e=q();if(e!==-1){F.current=e;return}let t=w?I[0]:I;if(H.length===0||t==null){K({diff:`reset`});return}if(M.current){if(t!=null){let e=H[F.current];if(w&&e&&I.findIndex(t=>ae(e,t))!==-1)return;let n=H.findIndex(e=>ae(e,t));n===-1?K({diff:`reset`}):G({index:n});return}if(F.current>=H.length-1){G({index:H.length-1});return}G({index:F.current})}},[H.length,w?!1:I,K,G,V,L,w]),Ve=le(e=>{ie(M,e),e&&Be()});B.useEffect(()=>{(ze||V)&&Be()},[Be,ze,V]);let He=e=>{Te||(Ee(!0),Ae(!0),ue&&ue(e))},Ue=(e,t)=>{Te&&(Ee(!1),se&&se(e,t))},J=(e,t,n,r)=>{if(w){if(I.length===t.length&&I.every((e,n)=>e===t[n]))return}else if(I===t)return;oe&&oe(e,t,n,r),xe(t)},We=B.useRef(!1),Ge=(e,t,n=`selectOption`,r=`options`)=>{let i=n,a=t;if(w){a=Array.isArray(I)?I.slice():[];let e=a.findIndex(e=>ae(t,e));e===-1?a.push(t):r!==`freeSolo`&&(a.splice(e,1),i=`removeOption`)}z(e,a,i),J(e,a,i,{option:t}),!p&&(!e||!e.ctrlKey&&!e.metaKey)&&Ue(e,i),(o===!0||o===`touch`&&We.current||o===`mouse`&&!We.current)&&j.current.blur()};function Ke(e,t){if(e===-1)return-1;let n=e;for(;;){if(t===`next`&&n===I.length||t===`previous`&&n===-1)return-1;let e=D?`data-item-index`:`data-tag-index`,r=_e.querySelector(`[${e}="${n}"]`);if(!r||!r.hasAttribute(`tabindex`)||r.disabled||r.getAttribute(`aria-disabled`)===`true`)n+=t===`next`?1:-1;else return n}}let qe=(e,t)=>{if(!w)return;L===``&&Ue(e,`toggleInput`);let n=N;N===-1&&t===`previous`?(n=I.length-1,v&&L!==``&&(R(``),T&&T(e,``,`reset`))):(n+=t===`next`?1:-1,n<0&&(n=0),n===I.length&&(n=-1)),n=Ke(n,t),P(n),Le(n)},Je=e=>{A.current=!0,R(``),T&&T(e,``,`clear`),J(e,w?[]:null,`clear`)},Ye=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(N!==-1&&![`ArrowLeft`,`ArrowRight`].includes(t.key)&&(P(-1),Le(-1)),t.which!==229))switch(t.key){case`Home`:V&&C&&(t.preventDefault(),K({diff:`start`,direction:`next`,reason:`keyboard`,event:t}));break;case`End`:V&&C&&(t.preventDefault(),K({diff:`end`,direction:`previous`,reason:`keyboard`,event:t}));break;case`PageUp`:t.preventDefault(),K({diff:-Ne,direction:`previous`,reason:`keyboard`,event:t}),He(t);break;case`PageDown`:t.preventDefault(),K({diff:Ne,direction:`next`,reason:`keyboard`,event:t}),He(t);break;case`ArrowDown`:t.preventDefault(),K({diff:1,direction:`next`,reason:`keyboard`,event:t}),He(t);break;case`ArrowUp`:t.preventDefault(),K({diff:-1,direction:`previous`,reason:`keyboard`,event:t}),He(t);break;case`ArrowLeft`:{let e=j.current;if(!(e&&e.selectionStart===0&&e.selectionEnd===0))return;!w&&D&&I!=null?(v&&L!==``&&(R(``),T&&T(t,``,`reset`)),P(0),Le(0)):qe(t,`previous`);break}case`ArrowRight`:!w&&D?(P(-1),Le(-1)):qe(t,`next`);break;case`Enter`:if(F.current!==-1&&V){let e=H[F.current],n=y?y(e):!1;if(t.preventDefault(),n)return;Ge(t,e,`selectOption`),r&&j.current.setSelectionRange(j.current.value.length,j.current.value.length)}else v&&L!==``&&je===!1&&(w&&t.preventDefault(),Ge(t,L,`createOption`,`freeSolo`));break;case`Escape`:V?(t.preventDefault(),t.stopPropagation(),Ue(t,`escape`)):c&&(L!==``||w&&I.length>0||D)&&(t.preventDefault(),t.stopPropagation(),Je(t));break;case`Backspace`:if(w&&!E&&L===``&&I.length>0){let e=N===-1?I.length-1:N,n=I.slice();n.splice(e,1),J(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&J(t,null,`removeOption`,{option:I});break;case`Delete`:if(w&&!E&&L===``&&I.length>0&&N!==-1){let e=N,n=I.slice();n.splice(e,1),J(t,n,`removeOption`,{option:I[e]})}!w&&D&&!E&&L===``&&J(t,null,`removeOption`,{option:I});break;default:}},Xe=e=>{we(!0),N!==-1&&(P(-1),Le(-1)),fe&&!A.current&&He(e)},Ze=e=>{if(t(M)){j.current.focus();return}we(!1),ge.current=!0,A.current=!1,a&&F.current!==-1&&V?Ge(e,H[F.current],`blur`):a&&v&&L!==``?Ge(e,L,`blur`,`freeSolo`):s&&z(e,I,`blur`),Ue(e,`blur`)},Qe=e=>{let t=e.target.value;L!==t&&(R(t),Ae(!1),T&&T(e,t,`input`)),t===``?!f&&!w&&!D&&J(e,null,`clear`):He(e)},$e=e=>{let t=Number(e.currentTarget.getAttribute(`data-option-index`));F.current!==t&&G({event:e,index:t,reason:`mouse`})},et=e=>{G({event:e,index:Number(e.currentTarget.getAttribute(`data-option-index`)),reason:`touch`}),We.current=!0},tt=e=>{Ge(e,H[Number(e.currentTarget.getAttribute(`data-option-index`))],`selectOption`),We.current=!1},Y=e=>t=>{let n=I.slice();n.splice(e,1),J(t,n,`removeOption`,{option:I[e]})},nt=e=>{J(e,null,`removeOption`,{option:I})},rt=e=>{Te?Ue(e,`toggleInput`):He(e)},it=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute(`id`)!==O&&e.preventDefault()},at=e=>{e.currentTarget.contains(e.target)&&(j.current.focus(),me&&ge.current&&j.current.selectionEnd-j.current.selectionStart===0&&j.current.select(),ge.current=!1)},ot=e=>{!m&&(L===``||!Te)&&rt(e)},st=v&&L.length>0;st||=w?I.length>0:I!==null;let ct=H;return S&&(ct=H.reduce((e,t,n)=>{let r=S(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),m&&Ce&&Ze(),{getRootProps:(e={})=>({...e,onKeyDown:Ye(e),onMouseDown:it,onClick:at}),getInputLabelProps:()=>({id:`${O}-label`,htmlFor:O}),getInputProps:()=>({id:O,value:L,onBlur:Ze,onFocus:Xe,onChange:Qe,onMouseDown:ot,"aria-activedescendant":V?``:null,"aria-autocomplete":r?`both`:`list`,"aria-controls":W?`${O}-listbox`:void 0,"aria-expanded":W,autoComplete:`off`,ref:j,autoCapitalize:`none`,spellCheck:`false`,role:`combobox`,disabled:m}),getClearProps:()=>({tabIndex:-1,type:`button`,onClick:Je}),getItemProps:({index:e=0}={})=>({...w&&{key:e},...D?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!E&&{onDelete:w?Y(e):nt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:`button`,onClick:rt}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!E&&{onDelete:Y(e)}}),getListboxProps:()=>({role:`listbox`,id:`${O}-listbox`,"aria-labelledby":`${O}-label`,ref:Ve,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{let n=(w?I:[I]).some(e=>e!=null&&ae(t,e)),r=y?y(t):!1;return{key:b?.(t)??k(t),tabIndex:-1,role:`option`,id:`${O}-option-${e}`,onMouseMove:$e,onClick:tt,onTouchStart:et,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:O,inputValue:L,value:I,dirty:st,expanded:V&&_e,popupOpen:V,focused:Ce||N!==-1,anchorEl:_e,setAnchorEl:ve,focusedItem:N,focusedTag:N,groupedOptions:ct}}var H=V;function U(e){return we(`MuiListSubheader`,e)}R(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var W=ae(Ce()),Le=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return _e({root:[`root`,n!==`default`&&`color${fe(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},U,t)},Re=P(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${fe(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(T(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),G=B.forwardRef(function(e,t){let n=he({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,W.jsx)(Re,{as:a,className:E(Le(u).root,r),ref:t,ownerState:u,...l})});G&&(G.muiSkipListHighlight=!0);var K=G;function ze(e){return we(`MuiAutocomplete`,e)}var q=R(`MuiAutocomplete`,`root.expanded.fullWidth.focused.focusVisible.tag.tagSizeSmall.tagSizeMedium.hasPopupIcon.hasClearIcon.inputRoot.input.inputFocused.endAdornment.clearIndicator.popupIndicator.popupIndicatorOpen.popper.popperDisablePortal.paper.listbox.loading.noOptions.option.groupLabel.groupUl`.split(`.`)),Be,Ve,He=e=>{let{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:a,hasClearIcon:o,hasPopupIcon:s,inputFocused:c,popupOpen:l,size:u}=e;return _e({root:[`root`,r&&`expanded`,i&&`focused`,a&&`fullWidth`,o&&`hasClearIcon`,s&&`hasPopupIcon`],inputRoot:[`inputRoot`],input:[`input`,c&&`inputFocused`],tag:[`tag`,`tagSize${fe(u)}`],endAdornment:[`endAdornment`],clearIndicator:[`clearIndicator`],popupIndicator:[`popupIndicator`,l&&`popupIndicatorOpen`],popper:[`popper`,n&&`popperDisablePortal`],paper:[`paper`],listbox:[`listbox`],loading:[`loading`],noOptions:[`noOptions`],option:[`option`],groupLabel:[`groupLabel`],groupUl:[`groupUl`]},ze,t)},Ue=P(`div`,{name:`MuiAutocomplete`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:a,inputFocused:o,size:s}=n;return[{[`& .${q.tag}`]:t.tag},{[`& .${q.tag}`]:t[`tagSize${fe(s)}`]},{[`& .${q.inputRoot}`]:t.inputRoot},{[`& .${q.input}`]:t.input},{[`& .${q.input}`]:o&&t.inputFocused},t.root,r&&t.fullWidth,a&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${q.focused} .${q.clearIndicator}`]:{visibility:`visible`},"@media (pointer: fine)":{[`&:hover .${q.clearIndicator}`]:{visibility:`visible`}},[`& .${q.tag}`]:{margin:3,maxWidth:`calc(100% - 6px)`},[`& .${q.inputRoot}`]:{[`.${q.hasPopupIcon}&, .${q.hasClearIcon}&`]:{paddingRight:30},[`.${q.hasPopupIcon}.${q.hasClearIcon}&`]:{paddingRight:56},[`& .${q.input}`]:{width:0,minWidth:30}},[`& .${i.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:`4px 4px 4px 0px`}},[`& .${i.root}.${u.sizeSmall}`]:{[`& .${i.input}`]:{padding:`2px 4px 3px 0`}},[`& .${n.root}`]:{padding:9,[`.${q.hasPopupIcon}&, .${q.hasClearIcon}&`]:{paddingRight:39},[`.${q.hasPopupIcon}.${q.hasClearIcon}&`]:{paddingRight:65},[`& .${q.input}`]:{padding:`7.5px 4px 7.5px 5px`},[`& .${q.endAdornment}`]:{right:9}},[`& .${n.root}.${u.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${q.input}`]:{padding:`2.5px 4px 2.5px 8px`}},[`& .${c.root}`]:{paddingTop:19,paddingLeft:8,[`.${q.hasPopupIcon}&, .${q.hasClearIcon}&`]:{paddingRight:39},[`.${q.hasPopupIcon}.${q.hasClearIcon}&`]:{paddingRight:65},[`& .${c.input}`]:{padding:`7px 4px`},[`& .${q.endAdornment}`]:{right:9}},[`& .${c.root}.${u.sizeSmall}`]:{paddingBottom:1,[`& .${c.input}`]:{padding:`2.5px 4px`}},[`& .${u.hiddenLabel}`]:{paddingTop:8},[`& .${c.root}.${u.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${q.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${c.root}.${u.hiddenLabel}.${u.sizeSmall}`]:{[`& .${q.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${q.input}`]:{flexGrow:1,textOverflow:`ellipsis`,opacity:0},variants:[{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{[`& .${q.tag}`]:{margin:2,maxWidth:`calc(100% - 4px)`}}},{props:{inputFocused:!0},style:{[`& .${q.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${q.inputRoot}`]:{flexWrap:`wrap`}}}]}),J=P(`div`,{name:`MuiAutocomplete`,slot:`EndAdornment`})({position:`absolute`,right:0,top:`50%`,transform:`translate(0, -50%)`}),We=P(te,{name:`MuiAutocomplete`,slot:`ClearIndicator`})({marginRight:-2,padding:4,visibility:`hidden`}),Ge=P(te,{name:`MuiAutocomplete`,slot:`PopupIndicator`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:`rotate(180deg)`}}]}),Ke=P(g,{name:`MuiAutocomplete`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${q.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(T(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:`absolute`}}]}))),qe=P(w,{name:`MuiAutocomplete`,slot:`Paper`})(T(({theme:e})=>({...e.typography.body1,overflow:`auto`}))),Je=P(`div`,{name:`MuiAutocomplete`,slot:`Loading`})(T(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Ye=P(`div`,{name:`MuiAutocomplete`,slot:`NoOptions`})(T(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Xe=P(`ul`,{name:`MuiAutocomplete`,slot:`Listbox`})(T(({theme:e})=>({listStyle:`none`,margin:0,padding:`8px 0`,maxHeight:`40vh`,overflow:`auto`,position:`relative`,[`& .${q.option}`]:{minHeight:48,display:`flex`,overflow:`hidden`,justifyContent:`flex-start`,alignItems:`center`,cursor:`pointer`,paddingTop:6,boxSizing:`border-box`,outline:`0`,WebkitTapHighlightColor:`transparent`,paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up(`sm`)]:{minHeight:`auto`},[`&.${q.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:`none`},[`&.${q.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${q.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${q.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Ze=P(K,{name:`MuiAutocomplete`,slot:`GroupLabel`})(T(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),Qe=P(`ul`,{name:`MuiAutocomplete`,slot:`GroupUl`})({padding:0,[`& .${q.option}`]:{paddingLeft:24}}),$e=B.forwardRef(function(e,t){let n=he({props:e,name:`MuiAutocomplete`}),{autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:s=!1,ChipProps:c,className:l,clearIcon:u=Be||=(0,W.jsx)(se,{fontSize:`small`}),clearOnBlur:d=!n.freeSolo,clearOnEscape:f=!1,clearText:p=`Clear`,closeText:m=`Close`,componentsProps:h,defaultValue:ee=n.multiple?[]:null,disableClearable:v=!1,disableCloseOnSelect:y=!1,disabled:b=!1,disabledItemsFocusable:x=!1,disableListWrap:S=!1,disablePortal:C=!1,filterOptions:te,filterSelectedOptions:ne=!1,forcePopupIcon:re=`auto`,freeSolo:ie=!1,fullWidth:ae=!1,getLimitTagsText:oe=e=>`+${e}`,getOptionDisabled:ce,getOptionKey:le,getOptionLabel:T,isOptionEqualToValue:ue,groupBy:de,handleHomeEndKeys:fe=!n.freeSolo,id:pe,includeInputInList:D=!1,inputValue:me,limitTags:O=-1,ListboxComponent:k,ListboxProps:A,loading:ge=!1,loadingText:j=`Loading…`,multiple:_e=!1,noOptionsText:ve=`No options`,onChange:N,onClose:P,onHighlightChange:ye,onInputChange:F,onOpen:be,open:I,openOnFocus:xe=!1,openText:Se=`Open`,options:L,PaperComponent:R,PopperComponent:Ce,popupIcon:we=Ve||=(0,W.jsx)(o,{}),readOnly:z=!1,renderGroup:Te,renderInput:Ee,renderOption:De,renderTags:Oe,renderValue:ke,selectOnFocus:Ae=!n.freeSolo,size:je=`medium`,slots:Me={},slotProps:Ne={},value:Pe,...Fe}=n,{getRootProps:Ie,getInputProps:V,getInputLabelProps:U,getPopupIndicatorProps:Le,getClearProps:Re,getItemProps:G,getListboxProps:K,getOptionProps:ze,value:q,dirty:$e,expanded:et,id:tt,popupOpen:Y,focused:nt,focusedItem:rt,anchorEl:it,setAnchorEl:at,inputValue:ot,groupedOptions:st}=H({...n,componentName:`Autocomplete`}),ct=!v&&!b&&$e&&!z,X=(!ie||re===!0)&&re!==!1,{onMouseDown:lt}=V(),{ref:ut,...dt}=K(),ft=T||(e=>e.label??e),Z={...n,disablePortal:C,expanded:et,focused:nt,fullWidth:ae,getOptionLabel:ft,hasClearIcon:ct,hasPopupIcon:X,inputFocused:rt===-1,popupOpen:Y,size:je},Q=He(Z),pt={slots:{paper:R,popper:Ce,...Me},slotProps:{chip:c,listbox:A,...h,...Ne}},[mt,ht]=M(`listbox`,{elementType:Xe,externalForwardedProps:pt,ownerState:Z,className:Q.listbox,additionalProps:dt,ref:ut}),[gt,_t]=M(`paper`,{elementType:w,externalForwardedProps:pt,ownerState:Z,className:Q.paper}),[vt,yt]=M(`popper`,{elementType:g,externalForwardedProps:pt,ownerState:Z,className:Q.popper,additionalProps:{disablePortal:C,style:{width:it?it.clientWidth:null},role:`presentation`,anchorEl:it,open:Y}}),$,bt=e=>({className:Q.tag,disabled:b,...G(e)});if(_e?q.length>0&&($=Oe?Oe(q,bt,Z):ke?ke(q,bt,Z):q.map((e,t)=>{let{key:n,...r}=bt({index:t});return(0,W.jsx)(_,{label:ft(e),size:je,...r,...pt.slotProps.chip},n)})):ke&&q!=null&&($=ke(q,bt,Z)),O>-1&&Array.isArray($)){let e=$.length-O;!nt&&e>0&&($=$.splice(0,O),$.push((0,W.jsx)(`span`,{className:Q.tag,children:oe(e)},$.length)))}let xt=Te||(e=>(0,W.jsxs)(`li`,{children:[(0,W.jsx)(Ze,{className:Q.groupLabel,ownerState:Z,component:`div`,children:e.group}),(0,W.jsx)(Qe,{className:Q.groupUl,ownerState:Z,children:e.children})]},e.key)),St=De||((e,t)=>{let{key:n,...r}=e;return(0,W.jsx)(`li`,{...r,children:ft(t)},n)}),Ct=(e,t)=>{let n=ze({option:e,index:t});return St({...n,className:Q.option},e,{selected:n[`aria-selected`],index:t,inputValue:ot},Z)},wt=pt.slotProps.clearIndicator,Tt=pt.slotProps.popupIndicator;return(0,W.jsxs)(B.Fragment,{children:[(0,W.jsx)(Ue,{ref:t,className:E(Q.root,l),ownerState:Z,...Ie(Fe),children:Ee({id:tt,disabled:b,fullWidth:!0,size:je===`small`?`small`:void 0,InputLabelProps:U(),InputProps:{ref:at,className:Q.inputRoot,startAdornment:$,onMouseDown:e=>{e.target===e.currentTarget&&lt(e)},...(ct||X)&&{endAdornment:(0,W.jsxs)(J,{className:Q.endAdornment,ownerState:Z,children:[ct?(0,W.jsx)(We,{...Re(),"aria-label":p,title:p,ownerState:Z,...wt,className:E(Q.clearIndicator,wt?.className),children:u}):null,X?(0,W.jsx)(Ge,{...Le(),disabled:b,"aria-label":Y?m:Se,title:Y?m:Se,ownerState:Z,...Tt,className:E(Q.popupIndicator,Tt?.className),children:we}):null]})}},inputProps:{className:Q.input,disabled:b,readOnly:z,...V()}})}),it?(0,W.jsx)(Ke,{as:vt,...yt,children:(0,W.jsxs)(qe,{as:gt,..._t,children:[ge&&st.length===0?(0,W.jsx)(Je,{className:Q.loading,ownerState:Z,children:j}):null,st.length===0&&!ie&&!ge?(0,W.jsx)(Ye,{className:Q.noOptions,ownerState:Z,role:`presentation`,onMouseDown:e=>{e.preventDefault()},children:ve}):null,st.length>0?(0,W.jsx)(mt,{as:k,...ht,children:st.map((e,t)=>de?xt({key:e.key,group:e.group,children:e.options.map((t,n)=>Ct(t,e.index+n))}):Ct(e,t))}):null]})}):null]})});function et(e){return B.Children.toArray(e).filter(e=>B.isValidElement(e))}function tt(e){return we(`MuiToggleButton`,e)}var Y=R(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),nt=B.createContext({}),rt=B.createContext(void 0);function it(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var at=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return _e({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${fe(a)}`,o]},tt,t)},ot=P(ne,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${fe(n.size)}`]]}})(T(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${Y.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${Y.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(ce()).map(([t])=>({props:{color:t},style:{[`&.${Y.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),st=B.forwardRef(function(e,t){let{value:n,...r}=B.useContext(nt),i=B.useContext(rt),a=he({props:k({...r,selected:it(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,ee={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},v=at(ee),y=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},b=i||``;return(0,W.jsx)(ot,{className:E(r.className,v.root,s,b),disabled:l,focusRipple:!u,ref:t,onClick:y,onChange:f,value:g,ownerState:ee,"aria-pressed":m,..._,children:o})});function ct(e){return we(`MuiToggleButtonGroup`,e)}var X=R(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),lt=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return _e({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${fe(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},ct,t)},ut=P(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${fe(n.orientation)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(T(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderTop:0,marginTop:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${X.lastButton}.${Y.disabled},& .${X.middleButton}.${Y.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${X.lastButton}.${Y.disabled},& .${X.middleButton}.${Y.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),dt=B.forwardRef(function(e,t){let n=he({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=lt(m),g=B.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=B.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),ee=B.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),v=et(r),y=v.length,b=e=>{let t=e===0,n=e===y-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,W.jsx)(ut,{role:`group`,className:E(h.root,i),ref:t,ownerState:m,...p,children:(0,W.jsx)(nt.Provider,{value:ee,children:v.map((e,t)=>(0,W.jsx)(rt.Provider,{value:b(t),children:e},t))})})}),ft=ue((0,W.jsx)(`path`,{d:`M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z`}),`Add`),Z=ue((0,W.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),Q=ue((0,W.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`),pt=ue((0,W.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z`}),`Delete`);function mt({preview:t,configText:n,loading:r,error:i,onLoadPreview:a,onGenerateConfig:o}){let{showSuccess:s}=Ee();return(0,W.jsxs)(e,{spacing:2.5,children:[(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Navidrome TOML Configuration`}),(0,W.jsxs)(e,{spacing:1.25,children:[(0,W.jsx)(A,{onClick:a,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,W.jsx)(A,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,W.jsxs)(de,{children:[`Error: `,i]})]}),t&&(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Tag Preview`}),(0,W.jsx)(O,{sx:{overflowX:`auto`},children:(0,W.jsxs)(v,{children:[(0,W.jsx)(b,{children:(0,W.jsxs)(S,{children:[(0,W.jsx)(x,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,W.jsx)(x,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,W.jsx)(x,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,W.jsx)(x,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,W.jsx)(x,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,W.jsx)(y,{children:t.map(e=>(0,W.jsxs)(S,{children:[(0,W.jsx)(x,{sx:{borderColor:`divider`},children:e.tag_key}),(0,W.jsx)(x,{sx:{borderColor:`divider`},children:e.type}),(0,W.jsx)(x,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,W.jsx)(x,{sx:{borderColor:`divider`},children:e.total_count}),(0,W.jsx)(x,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Generated Config`}),(0,W.jsx)(l,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,W.jsx)(A,{onClick:()=>{n&&(navigator.clipboard.writeText(n),s(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}var ht=new Set([`artist`,`artists`,`album`,`album_artist`,`genre`,`year`,`date`,`bpm`,`composer`,`label`,`publisher`,`title`,`lyricist`,`tracknumber`,`track_number`,`discnumber`]),gt=new Set([`year`,`bpm`,`tracknumber`,`track_number`,`discnumber`]),_t={artist:`Artist`,artists:`Artists`,album:`Album`,album_artist:`Album Artist`,genre:`Genre`,year:`Year`,date:`Date`,bpm:`BPM`,composer:`Composer`,label:`Label`,publisher:`Publisher`,title:`Title`,lyricist:`Lyricist`,tracknumber:`Track #`,track_number:`Track #`,discnumber:`Disc #`,"nom:mood-loose":`Mood (Loose)`,"nom:mood-regular":`Mood (Regular)`,"nom:mood-strict":`Mood (Strict)`};function vt(e){return ht.has(e)||e.startsWith(`nom:mood-`)}function yt(){let[e,t]=(0,B.useState)([]),[n,r]=(0,B.useState)(!1),[i,a]=(0,B.useState)(null),o=(0,B.useCallback)(async()=>{try{r(!0),a(null),t(await ge())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);(0,B.useEffect)(()=>{o()},[o]);let s=(0,B.useMemo)(()=>e.filter(e=>vt(e.key)).map(e=>({...e,type:gt.has(e.key)?`integer`:e.type,label:_t[e.key]??e.key})).sort((e,t)=>e.label.localeCompare(t.label)),[e]);return{tags:s,numericTags:(0,B.useMemo)(()=>s.filter(e=>e.type===`float`||e.type===`integer`),[s]),stringTags:(0,B.useMemo)(()=>s.filter(e=>e.type===`string`),[s]),loading:n,error:i,reload:o}}function $({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,W.jsxs)(e,{spacing:1.5,children:[(0,W.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,W.jsx)(_,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,W.jsx)(C,{children:(0,W.jsxs)(v,{size:`small`,children:[(0,W.jsx)(b,{children:(0,W.jsxs)(S,{children:[(0,W.jsx)(x,{children:`Title`}),(0,W.jsx)(x,{children:`Artist`}),(0,W.jsx)(x,{children:`Album`})]})}),(0,W.jsx)(y,{children:r.map((e,t)=>(0,W.jsxs)(S,{children:[(0,W.jsx)(x,{children:e.title??`—`}),(0,W.jsx)(x,{children:e.artist??`—`}),(0,W.jsx)(x,{children:e.album??`—`})]},t))})]})}):(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,W.jsxs)(z,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var bt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`},{value:`>=`,label:`≥`},{value:`<=`,label:`≤`}],xt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`contains`,label:`contains`}];function St({rule:n,numericTags:i,stringTags:o,onChange:c,onRemove:u}){let d=[...i,...o],f=d.find(e=>e.key===n.tagKey),p=f?.type===`float`||f?.type===`integer`,m=p?bt:xt,[h,g]=(0,B.useState)([]),[_,v]=(0,B.useState)(!1),y=(0,B.useCallback)(async e=>{if(!e){g([]);return}try{v(!0),g(await pe(e))}catch{g([])}finally{v(!1)}},[]);return(0,B.useEffect)(()=>{y(n.tagKey)},[n.tagKey,y]),(0,W.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,W.jsxs)(t,{size:`small`,sx:{minWidth:180,flex:2},children:[(0,W.jsx)(r,{children:`Tag`}),(0,W.jsxs)(a,{value:n.tagKey,label:`Tag`,onChange:e=>{let t=e.target.value,r=d.find(e=>e.key===t),i=p,a=r?.type===`float`||r?.type===`integer`,o=i===a&&m.some(e=>e.value===n.operator);c({...n,tagKey:t,operator:o?n.operator:`=`,value:i===a?n.value:``})},children:[i.length>0&&(0,W.jsx)(K,{children:`Numeric`}),i.map(e=>(0,W.jsx)(s,{value:e.key,children:e.label},e.key)),o.length>0&&(0,W.jsx)(K,{children:`Text`}),o.map(e=>(0,W.jsx)(s,{value:e.key,children:e.label},e.key))]})]}),(0,W.jsxs)(t,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,W.jsx)(r,{children:`Op`}),(0,W.jsx)(a,{value:n.operator,label:`Op`,onChange:e=>{c({...n,operator:e.target.value})},children:m.map(e=>(0,W.jsx)(s,{value:e.value,children:e.label},e.value))})]}),(0,W.jsx)($e,{size:`small`,freeSolo:!0,options:h,loading:_,value:n.value||null,inputValue:n.value,onInputChange:(e,t)=>{c({...n,value:t})},onChange:(e,t)=>{c({...n,value:t??``})},renderInput:e=>(0,W.jsx)(l,{...e,label:`Value`,type:p?`number`:`text`,inputProps:{...e.inputProps,...p?{step:`any`}:{}}}),sx:{flex:2,minWidth:160}}),(0,W.jsx)(ee,{title:`Remove rule`,children:(0,W.jsx)(te,{size:`small`,onClick:u,color:`error`,children:(0,W.jsx)(Te,{fontSize:`small`})})})]})}var Ct=1;function wt(){return{id:String(Ct++),tagKey:``,operator:`=`,value:``}}function Tt(e=`all`){return{id:String(Ct++),logic:e,rules:[],groups:[]}}function Et(e){let t=[],n=e.rules.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`);t.push(...n);for(let n of e.groups){let e=Et(n);e&&t.push(`(${e})`)}let r=e.logic===`all`?` AND `:` OR `;return t.join(r)}function Dt({group:t,numericTags:n,stringTags:r,depth:i=0,onGroupChange:a,onRemove:o}){let s=i===0,[c,l]=(0,B.useState)(!1),u=t.rules.length>0||t.groups.length>0,d=()=>{a({...t,rules:[...t.rules,wt()]})},f=(e,n)=>{a({...t,rules:t.rules.map((t,r)=>r===e?n:t)})},p=e=>{a({...t,rules:t.rules.filter((t,n)=>n!==e)})},m=(e,n)=>{n&&a({...t,logic:n})},h=(e,n)=>{a({...t,groups:t.groups.map((t,r)=>r===e?n:t)})},g=e=>{a({...t,groups:t.groups.filter((t,n)=>n!==e)})},_=()=>{let e=Tt(t.logic);a({...t,groups:[...t.groups,e]})},v=()=>{u?l(!0):o&&o()},y=()=>{l(!1),o&&o()},b=()=>{l(!1)};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(O,{sx:s?{}:{border:1,borderColor:`divider`,borderRadius:1,p:2,ml:2},children:(0,W.jsxs)(e,{spacing:1.5,children:[(0,W.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,children:s?`Match`:`Group match`}),(0,W.jsxs)(dt,{value:t.logic,exclusive:!0,onChange:m,size:`small`,children:[(0,W.jsx)(st,{value:`all`,children:`ALL`}),(0,W.jsx)(st,{value:`any`,children:`ANY`})]}),!s&&o&&(0,W.jsx)(ee,{title:`Remove group`,children:(0,W.jsx)(te,{size:`small`,onClick:v,color:`error`,sx:{ml:`auto`},children:(0,W.jsx)(pt,{fontSize:`small`})})})]}),t.rules.map((e,t)=>(0,W.jsx)(St,{rule:e,numericTags:n,stringTags:r,onChange:e=>f(t,e),onRemove:()=>p(t)},e.id)),t.groups.map((e,t)=>(0,W.jsx)(Dt,{group:e,numericTags:n,stringTags:r,depth:i+1,onGroupChange:e=>h(t,e),onRemove:()=>g(t)},e.id)),(0,W.jsxs)(e,{direction:`row`,spacing:1,children:[(0,W.jsx)(A,{startIcon:(0,W.jsx)(ft,{}),onClick:d,variant:`outlined`,size:`small`,children:`Add Rule`}),(0,W.jsx)(A,{startIcon:(0,W.jsx)(ft,{}),onClick:_,variant:`outlined`,size:`small`,children:`Add Group`})]})]})}),(0,W.jsxs)(me,{open:c,onClose:b,children:[(0,W.jsx)(I,{children:`Remove Group?`}),(0,W.jsx)(ve,{children:(0,W.jsxs)(D,{children:[`This group contains `,t.rules.length,` rule(s) and`,` `,t.groups.length,` nested group(s). Are you sure you want to remove it?`]})}),(0,W.jsxs)(L,{children:[(0,W.jsx)(A,{onClick:b,children:`Cancel`}),(0,W.jsx)(A,{onClick:y,color:`error`,autoFocus:!0,children:`Remove`})]})]})]})}function Ot({rootGroup:t,numericTags:n,stringTags:r,onGroupChange:i}){return(0,W.jsx)(e,{spacing:1.5,children:(0,W.jsx)(Dt,{group:t,numericTags:n,stringTags:r,depth:0,onGroupChange:i})})}var kt=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function At(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function jt({value:n,onChange:i}){let{column:o,descending:c}=At(n);return(0,W.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,W.jsxs)(t,{size:`small`,sx:{minWidth:140},children:[(0,W.jsx)(r,{children:`Sort by`}),(0,W.jsx)(a,{value:o,label:`Sort by`,onChange:e=>{let t=e.target.value;i(c?`-${t}`:t)},children:kt.map(e=>(0,W.jsx)(s,{value:e.value,children:e.label},e.value))})]}),o!==`random`&&(0,W.jsx)(ee,{title:c?`Descending`:`Ascending`,children:(0,W.jsx)(te,{size:`small`,onClick:()=>{i(c?o:`-${o}`)},children:c?(0,W.jsx)(Z,{}):(0,W.jsx)(Q,{})})})]})}function Mt({rootGroup:t,name:n,comment:r,limit:i,sort:a,preview:o,content:s,loading:c,error:u,onGroupChange:d,onNameChange:f,onCommentChange:p,onLimitChange:m,onSortChange:h,onPreview:g,onGenerate:_}){let{numericTags:ee,stringTags:v,loading:y}=yt(),b=Et(t),x=b.length>0;return(0,W.jsxs)(e,{spacing:2.5,children:[(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Smart Playlist Generator`}),(0,W.jsxs)(e,{spacing:2,children:[(0,W.jsx)(Ot,{rootGroup:t,numericTags:ee,stringTags:v,onGroupChange:d}),y&&(0,W.jsx)(z,{variant:`caption`,color:`text.secondary`,children:`Loading tag metadata…`}),b&&(0,W.jsx)(l,{value:b,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,W.jsxs)(O,{children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,W.jsx)(l,{value:n,onChange:e=>f(e.target.value),disabled:c,required:!0,fullWidth:!0,size:`small`})]}),(0,W.jsxs)(O,{children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,W.jsx)(l,{value:r,onChange:e=>p(e.target.value),disabled:c,fullWidth:!0,size:`small`})]}),(0,W.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,W.jsxs)(O,{children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,W.jsx)(jt,{value:a,onChange:h})]}),(0,W.jsxs)(O,{children:[(0,W.jsx)(z,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,W.jsx)(l,{type:`number`,value:i??``,onChange:e=>m(e.target.value?parseInt(e.target.value):void 0),disabled:c,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,W.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,W.jsx)(A,{variant:`contained`,disabled:c||!x,onClick:g,fullWidth:!0,children:c?`Loading…`:`Preview Query`}),(0,W.jsx)(A,{variant:`contained`,disabled:c||!x,onClick:_,fullWidth:!0,children:c?`Generating…`:`Generate .nsp`})]})]}),u&&(0,W.jsxs)(de,{children:[`Error: `,u]})]}),o&&(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Query Preview`}),(0,W.jsx)($,{data:o})]}),s&&(0,W.jsxs)(j,{children:[(0,W.jsx)(be,{title:`Generated Playlist (.nsp)`}),(0,W.jsx)(l,{multiline:!0,rows:15,value:s,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,W.jsx)(A,{onClick:()=>{if(s){let e=new Blob([s],{type:`text/plain`}),t=URL.createObjectURL(e),r=document.createElement(`a`);r.href=t,r.download=`${n}.nsp`,r.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Nt(){let{showError:e}=Ee(),[t,n]=(0,B.useState)(null),[r,i]=(0,B.useState)(null),[a,o]=(0,B.useState)(!1),[s,c]=(0,B.useState)(null),[l,u]=(0,B.useState)(()=>{let e=Tt(`all`);return e.rules=[wt()],e}),[d,f]=(0,B.useState)(`My Playlist`),[p,m]=(0,B.useState)(``),[h,g]=(0,B.useState)(void 0),[_,ee]=(0,B.useState)(``),[v,y]=(0,B.useState)(null),[b,x]=(0,B.useState)(null),[S,C]=(0,B.useState)(!1),[te,ne]=(0,B.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRootGroup:l,playlistName:d,playlistComment:p,playlistLimit:h,playlistSort:_,playlistPreview:v,playlistContent:b,playlistLoading:S,playlistError:te,loadConfigPreview:async()=>{try{o(!0),c(null),n((await F()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await N()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=Et(l);if(!t.trim()){e(`Add at least one complete rule`);return}try{C(!0),ne(null),y(await ye(t,10))}catch(e){ne(e instanceof Error?e.message:`Failed to preview playlist`)}finally{C(!1)}},generatePlaylist:async()=>{let t=Et(l);if(!t.trim()){e(`Add at least one complete rule`);return}if(!d.trim()){e(`Playlist name is required`);return}try{C(!0),ne(null),x((await xe({query:t,playlist_name:d,comment:p,limit:h,sort:_||void 0})).content)}catch(e){ne(e instanceof Error?e.message:`Failed to generate playlist`)}finally{C(!1)}},setPlaylistRootGroup:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:g,setPlaylistSort:ee}}function Pt(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRootGroup:a,playlistName:o,playlistComment:s,playlistLimit:c,playlistSort:l,playlistPreview:u,playlistContent:d,playlistLoading:g,playlistError:_,loadConfigPreview:ee,generateConfig:v,previewPlaylist:y,generatePlaylist:b,setPlaylistRootGroup:x,setPlaylistName:S,setPlaylistComment:C,setPlaylistLimit:te,setPlaylistSort:ne}=Nt();return(0,W.jsx)(oe,{title:`Navidrome`,children:(0,W.jsxs)(e,{spacing:2,children:[(0,W.jsxs)(f,{defaultExpanded:!0,disableGutters:!0,children:[(0,W.jsx)(p,{expandIcon:(0,W.jsx)(h,{}),children:(0,W.jsx)(z,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,W.jsx)(m,{children:(0,W.jsx)(mt,{preview:t,configText:n,loading:r,error:i,onLoadPreview:ee,onGenerateConfig:v})})]}),(0,W.jsxs)(f,{disableGutters:!0,children:[(0,W.jsx)(p,{expandIcon:(0,W.jsx)(h,{}),children:(0,W.jsx)(z,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,W.jsx)(m,{children:(0,W.jsx)(Mt,{rootGroup:a,name:o,comment:s,limit:c,sort:l,preview:u,content:d,loading:g,error:_,onGroupChange:x,onNameChange:S,onCommentChange:C,onLimitChange:te,onSortChange:ne,onPreview:y,onGenerate:b})})]})]})})}export{Pt as NavidromePage};