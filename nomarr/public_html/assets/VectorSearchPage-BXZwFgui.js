import{c as e,t}from"./Stack-C1Q7NCGH.js";import{i as n,o as r,r as i,t as a,v as o}from"./Select-D82qstJP.js";import{t as s}from"./Autocomplete-CC8R1ZPl.js";import"./Popper-Bn5-l5C7.js";import"./Chip-BGwQu1ac.js";import{t as c}from"./TextField-i9-XGgc2.js";import{a as l,i as u,n as d,r as f,t as p}from"./TableRow-DtgsSp99.js";import{At as ee,Bt as m,Cn as h,Dn as g,Dt as _,E as te,Kn as v,Lt as y,Nn as b,Nt as ne,O as x,On as S,Pt as re,Q as C,Sn as w,St as T,Tt as E,Wn as D,Yt as ie,Zt as O,_n as ae,cn as k,f as A,fn as j,in as M,it as N,jt as P,kn as F,l as oe,lt as I,on as L,rn as R,tn as z,un as B,ut as se,w as ce,xt as le,yn as ue}from"./index-Cn9WoKM-.js";var de={border:0,clip:`rect(0 0 0 0)`,height:`1px`,margin:`-1px`,overflow:`hidden`,padding:0,position:`absolute`,whiteSpace:`nowrap`,width:`1px`};function V(e,t,n=(e,t)=>e===t){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}var H=V,U=v(D()),fe=2;function W(e,t,n,r,i){return n===1?Math.min(e+t,i):Math.max(e-t,r)}function G(e,t){return e-t}function pe(e,t){let{index:n}=e.reduce((e,n,r)=>{let i=Math.abs(t-n);return e===null||i<e.distance||i===e.distance?{distance:i,index:r}:e},null)??{};return n}function K(e,t){if(t.current!==void 0&&e.changedTouches){let n=e;for(let e=0;e<n.changedTouches.length;e+=1){let r=n.changedTouches[e];if(r.identifier===t.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function me(e,t,n){return(e-t)*100/(n-t)}function he(e,t,n){return(n-t)*e+t}function q(e){if(Math.abs(e)<1){let t=e.toExponential().split(`e-`),n=t[0].split(`.`)[1];return(n?n.length:0)+parseInt(t[1],10)}let t=e.toString().split(`.`)[1];return t?t.length:0}function ge(e,t,n){let r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(q(t)))}function _e({values:e,newValue:t,index:n}){let r=e.slice();return r[n]=t,r.sort(G)}function J({sliderRef:e,activeIndex:t,setActive:n}){let r=z(e.current);(!e.current?.contains(r.activeElement)||Number(r?.activeElement?.getAttribute(`data-index`))!==t)&&e.current?.querySelector(`[type="range"][data-index="${t}"]`).focus(),n&&n(t)}function ve(e,t){return typeof e==`number`&&typeof t==`number`?e===t:typeof e==`object`&&typeof t==`object`?H(e,t):!1}var ye={horizontal:{offset:e=>({left:`${e}%`}),leap:e=>({width:`${e}%`})},"horizontal-reverse":{offset:e=>({right:`${e}%`}),leap:e=>({width:`${e}%`})},vertical:{offset:e=>({bottom:`${e}%`}),leap:e=>({height:`${e}%`})}};const be=e=>e;var Y;function xe(){return Y===void 0&&(Y=typeof CSS<`u`&&typeof CSS.supports==`function`?CSS.supports(`touch-action`,`none`):!0),Y}function X(e){let{"aria-labelledby":t,defaultValue:n,disabled:r=!1,disableSwap:i=!1,isRtl:a=!1,marks:s=!1,max:c=100,min:l=0,name:u,onChange:d,onChangeCommitted:f,orientation:p=`horizontal`,rootRef:ee,scale:m=be,step:g=1,shiftStep:_=10,tabIndex:te,value:v}=e,b=U.useRef(void 0),[x,S]=U.useState(-1),[re,C]=U.useState(-1),[T,E]=U.useState(!1),D=U.useRef(0),ae=U.useRef(null),[k,A]=o({controlled:v,default:n??l,name:`Slider`}),j=d&&((e,t,n)=>{let r=e.nativeEvent||e,i=new r.constructor(r.type,r);Object.defineProperty(i,`target`,{writable:!0,value:{value:t,name:u}}),ae.current=t,d(i,t,n)}),M=Array.isArray(k),N=M?k.slice().sort(G):[k];N=N.map(e=>e==null?l:w(e,l,c));let P=s===!0&&g!==null?[...Array(Math.floor((c-l)/g)+1)].map((e,t)=>({value:l+g*t})):s||[],F=P.map(e=>e.value),[oe,I]=U.useState(-1),L=U.useRef(null),R=ie(ee,L),B=e=>t=>{let n=Number(t.currentTarget.getAttribute(`data-index`));ne(t.target)&&I(n),C(n),e?.onFocus?.(t)},se=e=>t=>{ne(t.target)||I(-1),C(-1),e?.onBlur?.(t)},ce=(e,t)=>{let n=Number(e.currentTarget.getAttribute(`data-index`)),r=N[n],a=F.indexOf(r),o=t;if(P&&g==null){let e=F[F.length-1];o=o>=e?e:o<=F[0]?F[0]:o<r?F[a-1]:F[a+1]}if(o=w(o,l,c),M){i&&(o=w(o,N[n-1]||-1/0,N[n+1]||1/0));let e=o;o=_e({values:N,newValue:o,index:n});let t=n;i||(t=o.indexOf(e)),J({sliderRef:L,activeIndex:t})}A(o),I(n),j&&!ve(o,k)&&j(e,o,n),f&&f(e,ae.current??o)},le=e=>t=>{if([`ArrowUp`,`ArrowDown`,`ArrowLeft`,`ArrowRight`,`PageUp`,`PageDown`,`Home`,`End`].includes(t.key)){t.preventDefault();let e=Number(t.currentTarget.getAttribute(`data-index`)),n=N[e],r=null;if(g!=null){let e=t.shiftKey?_:g;switch(t.key){case`ArrowUp`:r=W(n,e,1,l,c);break;case`ArrowRight`:r=W(n,e,a?-1:1,l,c);break;case`ArrowDown`:r=W(n,e,-1,l,c);break;case`ArrowLeft`:r=W(n,e,a?1:-1,l,c);break;case`PageUp`:r=W(n,_,1,l,c);break;case`PageDown`:r=W(n,_,-1,l,c);break;case`Home`:r=l;break;case`End`:r=c;break;default:break}}else if(P){let e=F[F.length-1],i=F.indexOf(n),o=[a?`ArrowRight`:`ArrowLeft`,`ArrowDown`,`PageDown`,`Home`],s=[a?`ArrowLeft`:`ArrowRight`,`ArrowUp`,`PageUp`,`End`];o.includes(t.key)?r=i===0?F[0]:F[i-1]:s.includes(t.key)&&(r=i===F.length-1?e:F[i+1])}r!=null&&ce(t,r)}e?.onKeyDown?.(t)};h(()=>{r&&L.current.contains(document.activeElement)&&document.activeElement?.blur()},[r]),r&&x!==-1&&S(-1),r&&oe!==-1&&I(-1);let ue=e=>t=>{e.onChange?.(t),ce(t,t.target.valueAsNumber)},V=U.useRef(void 0),H=p;a&&p===`horizontal`&&(H+=`-reverse`);let q=({finger:e,move:t=!1})=>{let{current:n}=L,{width:r,height:a,bottom:o,left:s}=n.getBoundingClientRect(),u;u=H.startsWith(`vertical`)?(o-e.y)/a:(e.x-s)/r,H.includes(`-reverse`)&&(u=1-u);let d;d=he(u,l,c),d=g?ge(d,g,l):F[pe(F,d)],d=w(d,l,c);let f=0;if(M){f=t?V.current:pe(N,d),i&&(d=w(d,N[f-1]||-1/0,N[f+1]||1/0));let e=d;d=_e({values:N,newValue:d,index:f}),i&&t||(f=d.indexOf(e),V.current=f)}return{newValue:d,activeIndex:f}},Y=O(e=>{let t=K(e,b);if(!t)return;if(D.current+=1,e.type===`mousemove`&&e.buttons===0){X(e);return}let{newValue:n,activeIndex:r}=q({finger:t,move:!0});J({sliderRef:L,activeIndex:r,setActive:S}),A(n),!T&&D.current>fe&&E(!0),j&&!ve(n,k)&&j(e,n,r)}),X=O(e=>{let t=K(e,b);if(E(!1),!t)return;let{newValue:n}=q({finger:t,move:!0});S(-1),e.type===`touchend`&&C(-1),f&&f(e,ae.current??n),b.current=void 0,Z()}),Se=O(e=>{if(r)return;xe()||e.preventDefault();let t=e.changedTouches[0];t!=null&&(b.current=t.identifier);let n=K(e,b);if(n!==!1){let{newValue:t,activeIndex:r}=q({finger:n});J({sliderRef:L,activeIndex:r,setActive:S}),A(t),j&&!ve(t,k)&&j(e,t,r)}D.current=0;let i=z(L.current);i.addEventListener(`touchmove`,Y,{passive:!0}),i.addEventListener(`touchend`,X,{passive:!0})}),Z=U.useCallback(()=>{let e=z(L.current);e.removeEventListener(`mousemove`,Y),e.removeEventListener(`mouseup`,X),e.removeEventListener(`touchmove`,Y),e.removeEventListener(`touchend`,X)},[X,Y]);U.useEffect(()=>{let{current:e}=L;return e.addEventListener(`touchstart`,Se,{passive:xe()}),()=>{e.removeEventListener(`touchstart`,Se),Z()}},[Z,Se]),U.useEffect(()=>{r&&Z()},[r,Z]);let Q=e=>t=>{if(e.onMouseDown?.(t),r||t.defaultPrevented||t.button!==0)return;t.preventDefault();let n=K(t,b);if(n!==!1){let{newValue:e,activeIndex:r}=q({finger:n});J({sliderRef:L,activeIndex:r,setActive:S}),A(e),j&&!ve(e,k)&&j(t,e,r)}D.current=0;let i=z(L.current);i.addEventListener(`mousemove`,Y,{passive:!0}),i.addEventListener(`mouseup`,X)},$=me(M?N[0]:l,l,c),Ce=me(N[N.length-1],l,c)-$,we=(e={})=>{let t=y(e),n={onMouseDown:Q(t||{})},r={...t,...n};return{...e,ref:R,...r}},Te=e=>t=>{e.onMouseOver?.(t),C(Number(t.currentTarget.getAttribute(`data-index`)))},Ee=e=>t=>{e.onMouseLeave?.(t),C(-1)},De=(e={})=>{let t=y(e),n={onMouseOver:Te(t||{}),onMouseLeave:Ee(t||{})};return{...e,...t,...n}},Oe=e=>({pointerEvents:x!==-1&&x!==e?`none`:void 0}),ke;return p===`vertical`&&(ke=a?`vertical-rl`:`vertical-lr`),{active:x,axis:H,axisProps:ye,dragging:T,focusedThumbIndex:oe,getHiddenInputProps:(n={})=>{let i=y(n),o={onChange:ue(i||{}),onFocus:B(i||{}),onBlur:se(i||{}),onKeyDown:le(i||{})},s={...i,...o};return{tabIndex:te,"aria-labelledby":t,"aria-orientation":p,"aria-valuemax":m(c),"aria-valuemin":m(l),name:u,type:`range`,min:e.min,max:e.max,step:e.step===null&&e.marks?`any`:e.step??void 0,disabled:r,...n,...s,style:{...de,direction:a?`rtl`:`ltr`,width:`100%`,height:`100%`,writingMode:ke}}},getRootProps:we,getThumbProps:De,marks:P,open:re,range:M,rootRef:R,trackLeap:Ce,trackOffset:$,values:N,getThumbStyle:Oe}}var Se=e=>!e||!m(e);function Z(e){return S(`MuiSlider`,e)}var Q=g(`MuiSlider`,`root.active.colorPrimary.colorSecondary.colorError.colorInfo.colorSuccess.colorWarning.disabled.dragging.focusVisible.mark.markActive.marked.markLabel.markLabelActive.rail.sizeSmall.thumb.thumbColorPrimary.thumbColorSecondary.thumbColorError.thumbColorSuccess.thumbColorInfo.thumbColorWarning.track.trackInverted.trackFalse.thumbSizeSmall.valueLabel.valueLabelOpen.valueLabelCircle.valueLabelLabel.vertical`.split(`.`)),$=v(b()),Ce=e=>{let{open:t}=e;return{offset:F(t&&Q.valueLabelOpen),circle:Q.valueLabelCircle,label:Q.valueLabelLabel}};function we(e){let{children:t,className:n,value:r}=e,i=Ce(e);return t?U.cloneElement(t,{className:t.props.className},(0,$.jsxs)(U.Fragment,{children:[t.props.children,(0,$.jsx)(`span`,{className:F(i.offset,n),"aria-hidden":!0,children:(0,$.jsx)(`span`,{className:i.circle,children:(0,$.jsx)(`span`,{className:i.label,children:r})})})]})):null}function Te(e){return e}const Ee=B(`span`,{name:`MuiSlider`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`color${M(n.color)}`],n.size!==`medium`&&t[`size${M(n.size)}`],n.marked&&t.marked,n.orientation===`vertical`&&t.vertical,n.track===`inverted`&&t.trackInverted,n.track===!1&&t.trackFalse]}})(R(({theme:e})=>({borderRadius:12,boxSizing:`content-box`,display:`inline-block`,position:`relative`,cursor:`pointer`,touchAction:`none`,WebkitTapHighlightColor:`transparent`,"@media print":{colorAdjust:`exact`},[`&.${Q.disabled}`]:{pointerEvents:`none`,cursor:`default`,color:(e.vars||e).palette.grey[400]},[`&.${Q.dragging}`]:{[`& .${Q.thumb}, & .${Q.track}`]:{transition:`none`}},variants:[...Object.entries(e.palette).filter(P()).map(([t])=>({props:{color:t},style:{color:(e.vars||e).palette[t].main}})),{props:{orientation:`horizontal`},style:{height:4,width:`100%`,padding:`13px 0`,"@media (pointer: coarse)":{padding:`20px 0`}}},{props:{orientation:`horizontal`,size:`small`},style:{height:2}},{props:{orientation:`horizontal`,marked:!0},style:{marginBottom:20}},{props:{orientation:`vertical`},style:{height:`100%`,width:4,padding:`0 13px`,"@media (pointer: coarse)":{padding:`0 20px`}}},{props:{orientation:`vertical`,size:`small`},style:{width:2}},{props:{orientation:`vertical`,marked:!0},style:{marginRight:44}}]}))),De=B(`span`,{name:`MuiSlider`,slot:`Rail`})({display:`block`,position:`absolute`,borderRadius:`inherit`,backgroundColor:`currentColor`,opacity:.38,variants:[{props:{orientation:`horizontal`},style:{width:`100%`,height:`inherit`,top:`50%`,transform:`translateY(-50%)`}},{props:{orientation:`vertical`},style:{height:`100%`,width:`inherit`,left:`50%`,transform:`translateX(-50%)`}},{props:{track:`inverted`},style:{opacity:1}}]}),Oe=B(`span`,{name:`MuiSlider`,slot:`Track`})(R(({theme:e})=>({display:`block`,position:`absolute`,borderRadius:`inherit`,border:`1px solid currentColor`,backgroundColor:`currentColor`,transition:e.transitions.create([`left`,`width`,`bottom`,`height`],{duration:e.transitions.duration.shortest}),variants:[{props:{size:`small`},style:{border:`none`}},{props:{orientation:`horizontal`},style:{height:`inherit`,top:`50%`,transform:`translateY(-50%)`}},{props:{orientation:`vertical`},style:{width:`inherit`,left:`50%`,transform:`translateX(-50%)`}},{props:{track:!1},style:{display:`none`}},...Object.entries(e.palette).filter(P()).map(([t])=>({props:{color:t,track:`inverted`},style:{...e.vars?{backgroundColor:e.vars.palette.Slider[`${t}Track`],borderColor:e.vars.palette.Slider[`${t}Track`]}:{backgroundColor:e.lighten(e.palette[t].main,.62),borderColor:e.lighten(e.palette[t].main,.62),...e.applyStyles(`dark`,{backgroundColor:e.darken(e.palette[t].main,.5)}),...e.applyStyles(`dark`,{borderColor:e.darken(e.palette[t].main,.5)})}}}))]}))),ke=B(`span`,{name:`MuiSlider`,slot:`Thumb`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.thumb,t[`thumbColor${M(n.color)}`],n.size!==`medium`&&t[`thumbSize${M(n.size)}`]]}})(R(({theme:e})=>({position:`absolute`,width:20,height:20,boxSizing:`border-box`,borderRadius:`50%`,outline:0,backgroundColor:`currentColor`,display:`flex`,alignItems:`center`,justifyContent:`center`,transition:e.transitions.create([`box-shadow`,`left`,`bottom`],{duration:e.transitions.duration.shortest}),"&::before":{position:`absolute`,content:`""`,borderRadius:`inherit`,width:`100%`,height:`100%`,boxShadow:(e.vars||e).shadows[2]},"&::after":{position:`absolute`,content:`""`,borderRadius:`50%`,width:42,height:42,top:`50%`,left:`50%`,transform:`translate(-50%, -50%)`},[`&.${Q.disabled}`]:{"&:hover":{boxShadow:`none`}},variants:[{props:{size:`small`},style:{width:12,height:12,"&::before":{boxShadow:`none`}}},{props:{orientation:`horizontal`},style:{top:`50%`,transform:`translate(-50%, -50%)`}},{props:{orientation:`vertical`},style:{left:`50%`,transform:`translate(-50%, 50%)`}},...Object.entries(e.palette).filter(P()).map(([t])=>({props:{color:t},style:{[`&:hover, &.${Q.focusVisible}`]:{boxShadow:`0px 0px 0px 8px ${e.alpha((e.vars||e).palette[t].main,.16)}`,"@media (hover: none)":{boxShadow:`none`}},[`&.${Q.active}`]:{boxShadow:`0px 0px 0px 14px ${e.alpha((e.vars||e).palette[t].main,.16)}`}}}))]})));var Ae=B(we,{name:`MuiSlider`,slot:`ValueLabel`})(R(({theme:e})=>({zIndex:1,whiteSpace:`nowrap`,...e.typography.body2,fontWeight:500,transition:e.transitions.create([`transform`],{duration:e.transitions.duration.shortest}),position:`absolute`,backgroundColor:(e.vars||e).palette.grey[600],borderRadius:2,color:(e.vars||e).palette.common.white,display:`flex`,alignItems:`center`,justifyContent:`center`,padding:`0.25rem 0.75rem`,variants:[{props:{orientation:`horizontal`},style:{transform:`translateY(-100%) scale(0)`,top:`-10px`,transformOrigin:`bottom center`,"&::before":{position:`absolute`,content:`""`,width:8,height:8,transform:`translate(-50%, 50%) rotate(45deg)`,backgroundColor:`inherit`,bottom:0,left:`50%`},[`&.${Q.valueLabelOpen}`]:{transform:`translateY(-100%) scale(1)`}}},{props:{orientation:`vertical`},style:{transform:`translateY(-50%) scale(0)`,right:`30px`,top:`50%`,transformOrigin:`right center`,"&::before":{position:`absolute`,content:`""`,width:8,height:8,transform:`translate(-50%, -50%) rotate(45deg)`,backgroundColor:`inherit`,right:-8,top:`50%`},[`&.${Q.valueLabelOpen}`]:{transform:`translateY(-50%) scale(1)`}}},{props:{size:`small`},style:{fontSize:e.typography.pxToRem(12),padding:`0.25rem 0.5rem`}},{props:{orientation:`vertical`,size:`small`},style:{right:`20px`}}]})));const je=B(`span`,{name:`MuiSlider`,slot:`Mark`,shouldForwardProp:e=>j(e)&&e!==`markActive`,overridesResolver:(e,t)=>{let{markActive:n}=e;return[t.mark,n&&t.markActive]}})(R(({theme:e})=>({position:`absolute`,width:2,height:2,borderRadius:1,backgroundColor:`currentColor`,variants:[{props:{orientation:`horizontal`},style:{top:`50%`,transform:`translate(-1px, -50%)`}},{props:{orientation:`vertical`},style:{left:`50%`,transform:`translate(-50%, 1px)`}},{props:{markActive:!0},style:{backgroundColor:(e.vars||e).palette.background.paper,opacity:.8}}]}))),Me=B(`span`,{name:`MuiSlider`,slot:`MarkLabel`,shouldForwardProp:e=>j(e)&&e!==`markLabelActive`})(R(({theme:e})=>({...e.typography.body2,color:(e.vars||e).palette.text.secondary,position:`absolute`,whiteSpace:`nowrap`,variants:[{props:{orientation:`horizontal`},style:{top:30,transform:`translateX(-50%)`,"@media (pointer: coarse)":{top:40}}},{props:{orientation:`vertical`},style:{left:36,transform:`translateY(50%)`,"@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(e.vars||e).palette.text.primary}}]})));var Ne=e=>{let{disabled:t,dragging:n,marked:r,orientation:i,track:a,classes:o,color:s,size:c}=e;return ae({root:[`root`,t&&`disabled`,n&&`dragging`,r&&`marked`,i===`vertical`&&`vertical`,a===`inverted`&&`trackInverted`,a===!1&&`trackFalse`,s&&`color${M(s)}`,c&&`size${M(c)}`],rail:[`rail`],track:[`track`],mark:[`mark`],markActive:[`markActive`],markLabel:[`markLabel`],markLabelActive:[`markLabelActive`],valueLabel:[`valueLabel`],thumb:[`thumb`,t&&`disabled`,c&&`thumbSize${M(c)}`,s&&`thumbColor${M(s)}`],active:[`active`],disabled:[`disabled`],focusVisible:[`focusVisible`]},Z,o)},Pe=({children:e})=>e,Fe=U.forwardRef(function(t,n){let r=k({props:t,name:`MuiSlider`}),i=ue(),{"aria-label":a,"aria-valuetext":o,"aria-labelledby":s,component:c=`span`,components:l={},componentsProps:u={},color:d=`primary`,classes:f,className:p,disableSwap:ee=!1,disabled:h=!1,getAriaLabel:g,getAriaValueText:_,marks:te=!1,max:v=100,min:y=0,name:b,onChange:ne,onChangeCommitted:x,orientation:S=`horizontal`,shiftStep:re=10,size:C=`medium`,step:w=1,scale:T=Te,slotProps:E,slots:D,tabIndex:ie,track:O=`normal`,value:ae,valueLabelDisplay:A=`off`,valueLabelFormat:j=Te,...M}=r,N={...r,isRtl:i,max:v,min:y,classes:f,disabled:h,disableSwap:ee,orientation:S,marks:te,color:d,size:C,step:w,shiftStep:re,scale:T,track:O,valueLabelDisplay:A,valueLabelFormat:j},{axisProps:P,getRootProps:oe,getHiddenInputProps:I,getThumbProps:L,open:R,active:z,axis:B,focusedThumbIndex:se,range:ce,dragging:le,marks:de,values:V,trackOffset:H,trackLeap:fe,getThumbStyle:W}=X({...N,rootRef:n});N.marked=de.length>0&&de.some(e=>e.label),N.dragging=le,N.focusedThumbIndex=se;let G=Ne(N),pe=D?.root??l.Root??Ee,K=D?.rail??l.Rail??De,he=D?.track??l.Track??Oe,q=D?.thumb??l.Thumb??ke,ge=D?.valueLabel??l.ValueLabel??Ae,_e=D?.mark??l.Mark??je,J=D?.markLabel??l.MarkLabel??Me,ve=D?.input??l.Input??`input`,ye=E?.root??u.root,be=E?.rail??u.rail,Y=E?.track??u.track,xe=E?.thumb??u.thumb,Z=E?.valueLabel??u.valueLabel,Q=E?.mark??u.mark,Ce=E?.markLabel??u.markLabel,we=E?.input??u.input,Fe=e({elementType:pe,getSlotProps:oe,externalSlotProps:ye,externalForwardedProps:M,additionalProps:{...Se(pe)&&{as:c}},ownerState:{...N,...ye?.ownerState},className:[G.root,p]}),Ie=e({elementType:K,externalSlotProps:be,ownerState:N,className:G.rail}),Le=e({elementType:he,externalSlotProps:Y,additionalProps:{style:{...P[B].offset(H),...P[B].leap(fe)}},ownerState:{...N,...Y?.ownerState},className:G.track}),Re=e({elementType:q,getSlotProps:L,externalSlotProps:xe,ownerState:{...N,...xe?.ownerState},className:G.thumb}),ze=e({elementType:ge,externalSlotProps:Z,ownerState:{...N,...Z?.ownerState},className:G.valueLabel}),Be=e({elementType:_e,externalSlotProps:Q,ownerState:N,className:G.mark}),Ve=e({elementType:J,externalSlotProps:Ce,ownerState:N,className:G.markLabel}),He=e({elementType:ve,getSlotProps:I,externalSlotProps:we,ownerState:N});return(0,$.jsxs)(pe,{...Fe,children:[(0,$.jsx)(K,{...Ie}),(0,$.jsx)(he,{...Le}),de.filter(e=>e.value>=y&&e.value<=v).map((e,t)=>{let n=me(e.value,y,v),r=P[B].offset(n),i;return i=O===!1?V.includes(e.value):O===`normal`&&(ce?e.value>=V[0]&&e.value<=V[V.length-1]:e.value<=V[0])||O===`inverted`&&(ce?e.value<=V[0]||e.value>=V[V.length-1]:e.value>=V[0]),(0,$.jsxs)(U.Fragment,{children:[(0,$.jsx)(_e,{"data-index":t,...Be,...!m(_e)&&{markActive:i},style:{...r,...Be.style},className:F(Be.className,i&&G.markActive)}),e.label==null?null:(0,$.jsx)(J,{"aria-hidden":!0,"data-index":t,...Ve,...!m(J)&&{markLabelActive:i},style:{...r,...Ve.style},className:F(G.markLabel,Ve.className,i&&G.markLabelActive),children:e.label})]},t)}),V.map((e,t)=>{let n=me(e,y,v),r=P[B].offset(n),i=A===`off`?Pe:ge;return(0,$.jsx)(i,{...!m(i)&&{valueLabelFormat:j,valueLabelDisplay:A,value:typeof j==`function`?j(T(e),t):j,index:t,open:R===t||z===t||A===`on`,disabled:h},...ze,children:(0,$.jsx)(q,{"data-index":t,...Re,className:F(G.thumb,Re.className,z===t&&G.active,se===t&&G.focusVisible),style:{...r,...W(t),...Re.style},children:(0,$.jsx)(ve,{"data-index":t,"aria-label":g?g(t):a,"aria-valuenow":T(e),"aria-labelledby":s,"aria-valuetext":_?_(T(e),t):o,value:V[t],...He})})},t)})]})});function Ie(){let[e,t]=(0,U.useState)(!1),[n,r]=(0,U.useState)(null),[i,a]=(0,U.useState)(null);return{loading:e,error:n,results:i,searchByFileId:(0,U.useCallback)(async(e,n,i=10,o=0)=>{t(!0),r(null),a(null);try{a((await x(e,(await ce(e,n)).vector,i,o)).results)}catch(t){t instanceof C?t.status===404?r(`No vector found for this track with backbone "${e}". The track may not have been processed yet.`):t.status===503?r(`Vector search not available: no vector index exists. Run promote & rebuild from the admin panel first.`):r(`API Error (${t.status}): ${t.message}`):t instanceof Error?r(t.message):r(`Unknown error occurred`)}finally{t(!1)}},[]),searchByVector:(0,U.useCallback)(async(e,n,i=10,o=0)=>{t(!0),r(null),a(null);try{a((await x(e,n,i,o)).results)}catch(e){e instanceof C?e.status===503?r(`Vector search not available: no vector index exists. Run promote & rebuild from the admin panel first.`):r(`API Error (${e.status}): ${e.message}`):e instanceof Error?r(e.message):r(`Unknown error occurred`)}finally{t(!1)}},[])}}function Le({onTrackSelect:e,helperText:t=`Search by artist, album, or title`,...n}){let[r,i]=(0,U.useState)(``),[a,o]=(0,U.useState)([]),[l,u]=(0,U.useState)(!1),[d,f]=(0,U.useState)(null),p=(0,U.useCallback)(async e=>{if(!e.trim()){o([]);return}u(!0);try{o((await A({q:e.trim()})).files||[])}catch(e){console.error(`Failed to search tracks:`,e),o([])}finally{u(!1)}},[]),m=(0,U.useMemo)(()=>{let e;return t=>{if(clearTimeout(e),!t.trim()){o([]);return}e=setTimeout(()=>{p(t)},300)}},[p]),h=(0,U.useCallback)((e,t)=>{i(t),m(t)},[m]),g=(0,U.useCallback)((t,n)=>{f(n),e?.(n)},[e]),_=e=>[e.artist||`Unknown Artist`,e.album||`Unknown Album`,e.title||`Unknown Title`].filter(Boolean).join(` - `);return(0,$.jsx)(s,{options:a,loading:l,inputValue:r,onInputChange:h,value:d,onChange:g,getOptionLabel:_,isOptionEqualToValue:(e,t)=>e.file_id===t.file_id,renderOption:(e,t)=>(0,$.jsx)(T,{component:`li`,...e,children:(0,$.jsxs)(T,{sx:{display:`flex`,flexDirection:`column`,width:`100%`},children:[(0,$.jsx)(E,{variant:`body2`,sx:{fontWeight:500},children:_(t)}),(0,$.jsx)(E,{variant:`caption`,sx:{color:`text.secondary`},children:t.path})]})}),renderInput:e=>(0,$.jsx)(c,{...e,label:`Track Search`,placeholder:`Search by artist, album, or title...`,size:`small`,helperText:t,slotProps:{input:{...e.InputProps,endAdornment:(0,$.jsxs)($.Fragment,{children:[l?(0,$.jsx)(ee,{color:`inherit`,size:20}):null,e.InputProps.endAdornment]})}}}),noOptionsText:`No tracks found`,...n})}function Re(){let[e]=L(),[o,s]=(0,U.useState)([]),[c,m]=(0,U.useState)(``),[h,g]=(0,U.useState)(null),[v,y]=(0,U.useState)(10),[b,ne]=(0,U.useState)(0);(0,U.useEffect)(()=>{(async()=>{try{let e=await te();s(e.backbones),e.backbones.length>0&&m(t=>t||e.backbones[0])}catch(e){console.error(`Failed to fetch backbones:`,e)}})()},[]),(0,U.useEffect)(()=>{let t=e.get(`fileId`);t&&!h&&(async()=>{try{let e=await oe([t]);e.files&&e.files.length>0&&g(e.files[0])}catch(e){console.error(`Failed to load track from fileId:`,e)}})()},[e,h]);let{loading:x,error:S,results:C,searchByFileId:w}=Ie(),D=(0,U.useCallback)(async()=>{h&&await w(c,h.file_id,v,b)},[c,h,v,b,w]);return(0,$.jsx)(N,{title:`Vector Search`,children:(0,$.jsxs)(t,{spacing:3,children:[(0,$.jsxs)(se,{children:[(0,$.jsx)(I,{title:`Search Parameters`}),(0,$.jsxs)(t,{spacing:2,children:[(0,$.jsxs)(r,{fullWidth:!0,size:`small`,children:[(0,$.jsx)(n,{children:`Backbone`}),(0,$.jsx)(a,{value:c,label:`Backbone`,onChange:e=>m(e.target.value),children:o.map(e=>(0,$.jsx)(i,{value:e,children:e},e))})]}),(0,$.jsx)(Le,{onTrackSelect:g,helperText:`Search by artist, album, or title to find a track`}),(0,$.jsxs)(T,{children:[(0,$.jsxs)(E,{variant:`body2`,gutterBottom:!0,children:[`Limit: `,v]}),(0,$.jsx)(Fe,{value:v,onChange:(e,t)=>y(t),min:1,max:100,valueLabelDisplay:`auto`})]}),(0,$.jsxs)(T,{children:[(0,$.jsxs)(E,{variant:`body2`,gutterBottom:!0,children:[`Min Score: `,b.toFixed(2)]}),(0,$.jsx)(Fe,{value:b,onChange:(e,t)=>ne(t),min:0,max:1,step:.01,valueLabelDisplay:`auto`})]}),(0,$.jsx)(le,{variant:`contained`,onClick:D,disabled:x||!h,children:x?(0,$.jsx)(ee,{size:24}):`Search`})]})]}),S&&(0,$.jsx)(_,{severity:`error`,children:S}),C&&C.length>0&&(0,$.jsxs)(se,{children:[(0,$.jsx)(I,{title:`Results (${C.length})`}),(0,$.jsx)(re,{variant:`outlined`,children:(0,$.jsxs)(l,{size:`small`,children:[(0,$.jsx)(d,{children:(0,$.jsxs)(p,{children:[(0,$.jsx)(f,{children:`File ID`}),(0,$.jsx)(f,{align:`right`,children:`Score`})]})}),(0,$.jsx)(u,{children:C.map((e,t)=>(0,$.jsxs)(p,{children:[(0,$.jsx)(f,{children:(0,$.jsx)(E,{component:`a`,href:`#/browse?file=${encodeURIComponent(e.file_id)}`,sx:{textDecoration:`none`,color:`primary.main`},children:e.file_id})}),(0,$.jsx)(f,{align:`right`,children:e.score.toFixed(4)})]},t))})]})})]}),C&&C.length===0&&(0,$.jsx)(_,{severity:`info`,children:`No similar tracks found. Try adjusting the search parameters.`})]})})}export{Re as VectorSearchPage};