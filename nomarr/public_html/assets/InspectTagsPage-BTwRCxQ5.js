import{t as e}from"./Stack-BtQgkU3W.js";import{t}from"./TextField-DY6xt5mA.js";import"./Portal-D6vP4qC-.js";import{t as n}from"./TableCell-DLlPaPyE.js";import{i as r,n as i,r as a,t as o}from"./TableRow-7PnFDy7l.js";import{Ft as s,Lt as c,_ as l,a as u,d,f,g as p,i as m,n as h,xt as g,y as _}from"./index-DjY4hVv8.js";import{t as v}from"./ServerFilePicker-BRTDDFbS.js";var y=c(s(),1),b=c(g(),1);function x(){let[s,c]=(0,y.useState)(``),[g,x]=(0,y.useState)(null),[S,C]=(0,y.useState)(!1),[w,T]=(0,y.useState)(null),[E,D]=(0,y.useState)(!1),[O,k]=(0,y.useState)(!1),[A,j]=(0,y.useState)(null),M=async e=>{if(e.preventDefault(),s.trim())try{C(!0),T(null),j(null),x(await h.tags.showTags(s))}catch(e){T(e instanceof Error?e.message:`Failed to load tags`),x(null),console.error(`[Inspect] Load error:`,e)}finally{C(!1)}},N=async()=>{if(s.trim()&&confirm(`Remove all tags from ${s}?\n\nThis cannot be undone!`))try{k(!0),T(null),j(null);let e=await h.tags.removeTags(s);j(`Removed ${e.removed} tag(s) from ${e.path}`),x(await h.tags.showTags(s))}catch(e){T(e instanceof Error?e.message:`Failed to remove tags`),console.error(`[Inspect] Remove error:`,e)}finally{k(!1)}},P=e=>Array.isArray(e)?e.join(`, `):String(e);return(0,b.jsxs)(u,{title:`Inspect Tags`,children:[(0,b.jsxs)(f,{children:[(0,b.jsx)(d,{title:`File Path`}),(0,b.jsx)(l,{component:`form`,onSubmit:M,children:(0,b.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,b.jsx)(t,{value:s,onChange:e=>c(e.target.value),placeholder:`Enter relative path to audio file`,disabled:S,fullWidth:!0}),(0,b.jsx)(p,{onClick:()=>D(!E),variant:`outlined`,disabled:S,sx:{minWidth:100},children:E?`Hide`:`Browse...`}),(0,b.jsx)(p,{type:`submit`,variant:`contained`,disabled:S||!s.trim(),sx:{minWidth:100},children:S?`Loading...`:`Inspect`})]})}),E&&(0,b.jsx)(l,{sx:{mt:2},children:(0,b.jsx)(v,{value:s,onChange:e=>{c(e),D(!1)},mode:`file`,label:`Select Audio File`})})]}),w&&(0,b.jsx)(f,{children:(0,b.jsxs)(m,{children:[`Error: `,w]})}),A&&(0,b.jsx)(f,{children:(0,b.jsx)(_,{color:`primary`,children:A})}),g&&(0,b.jsxs)(e,{spacing:2.5,children:[(0,b.jsxs)(f,{children:[(0,b.jsx)(d,{title:`File Metadata`,action:g.count>0?(0,b.jsx)(p,{onClick:N,disabled:O,variant:`contained`,color:`error`,size:`small`,title:`Remove all tags from this file`,children:O?`Removing...`:`Remove All Tags`}):void 0}),(0,b.jsxs)(e,{spacing:1.25,children:[(0,b.jsxs)(l,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Path:`}),(0,b.jsx)(_,{component:`span`,children:g.path})]}),(0,b.jsxs)(l,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Namespace:`}),(0,b.jsx)(_,{component:`span`,children:g.namespace})]}),(0,b.jsxs)(l,{children:[(0,b.jsx)(_,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Tag Count:`}),(0,b.jsx)(_,{component:`span`,children:g.count})]})]})]}),(0,b.jsxs)(f,{children:[(0,b.jsx)(d,{title:`Tags`}),g.count===0?(0,b.jsx)(_,{color:`text.secondary`,fontStyle:`italic`,children:`No tags found in this file.`}):(0,b.jsx)(l,{sx:{overflowX:`auto`},children:(0,b.jsxs)(r,{children:[(0,b.jsx)(i,{children:(0,b.jsxs)(o,{children:[(0,b.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag Key`}),(0,b.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Value`})]})}),(0,b.jsx)(a,{children:Object.entries(g.tags).map(([e,t])=>(0,b.jsxs)(o,{children:[(0,b.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:e}),(0,b.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:P(t)})]},e))})]})})]})]}),!g&&!w&&(0,b.jsx)(f,{children:(0,b.jsx)(_,{color:`text.secondary`,fontStyle:`italic`,children:`Enter a file path above to inspect its tags.`})})]})}export{x as InspectTagsPage};