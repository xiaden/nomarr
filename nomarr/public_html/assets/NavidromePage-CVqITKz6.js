import{t as e}from"./Stack-CkUmHJEx.js";import{a as t,b as n,d as r,f as i,i as a,l as o,n as s,p as c,s as l,t as u,u as d}from"./ExpandMore-CL1N8Z9X.js";import{n as f,r as p,t as m}from"./AccordionSummary-CLlb4YLa.js";import{t as h}from"./Popper-prfTDglz.js";import{t as g}from"./Chip-JO0uinvj.js";import{t as _}from"./TextField-BcvKNzOW.js";import{t as v}from"./Tooltip-xuqxYAWd.js";import{a as y,i as b,n as x,r as S,t as C}from"./TableRow-FDqLkAiy.js";import{t as w}from"./TableContainer-BuM30CGB.js";import{$t as ee,Cn as te,Ct as ne,Dt as re,Gt as ie,In as T,Jt as ae,Ot as oe,Pn as se,St as E,Tt as ce,Ut as le,X as ue,Xt as D,Yt as O,Z as de,_n as k,a as fe,cn as pe,ct as A,ht as j,i as me,ln as he,lt as ge,mn as M,mt as N,n as _e,nt as ve,o as P,ot as ye,r as be,rt as F,st as xe,t as I,tn as L,ut as R,vn as z,vt as B,wt as Se,xt as Ce,yn as V}from"./index-DT4CdTek.js";import{t as we}from"./Add-CnffWsuO.js";import{t as Te}from"./Close-BA8FSoPC.js";import{t as Ee}from"./useNotification-BFDlXKyZ.js";var H=T(se());function De(e){let t=H.useRef({});return H.useEffect(()=>{t.current=e}),t.current}var Oe=De;function ke({array1:e,array2:t,parser:n=e=>e}){return e&&t&&e.length===t.length&&e.every((e,r)=>n(e)===n(t[r]))}function U(e){return e.normalize(`NFD`).replace(/[\u0300-\u036f]/g,``)}function W(e={}){let{ignoreAccents:t=!0,ignoreCase:n=!0,limit:r,matchFrom:i=`any`,stringify:a,trim:o=!1}=e;return(e,{inputValue:s,getOptionLabel:c})=>{let l=o?s.trim():s;n&&(l=l.toLowerCase()),t&&(l=U(l));let u=l?e.filter(e=>{let r=(a||c)(e);return n&&(r=r.toLowerCase()),t&&(r=U(r)),i===`start`?r.startsWith(l):r.includes(l)}):e;return typeof r==`number`?u.slice(0,r):u}}var Ae=W(),je=5,Me=e=>e.current!==null&&e.current.parentElement?.contains(document.activeElement),Ne=[];function Pe(e,t,n,r){if(t||e==null||r)return``;let i=n(e);return typeof i==`string`?i:``}function G(e){let{unstable_isActiveElementInListbox:t=Me,unstable_classNamePrefix:r=`Mui`,autoComplete:i=!1,autoHighlight:a=!1,autoSelect:o=!1,blurOnSelect:s=!1,clearOnBlur:c=!e.freeSolo,clearOnEscape:l=!1,componentName:u=`useAutocomplete`,defaultValue:d=e.multiple?Ne:null,disableClearable:f=!1,disableCloseOnSelect:p=!1,disabled:m,disabledItemsFocusable:h=!1,disableListWrap:g=!1,filterOptions:_=Ae,filterSelectedOptions:v=!1,freeSolo:y=!1,getOptionDisabled:b,getOptionKey:x,getOptionLabel:S=e=>e.label??e,groupBy:C,handleHomeEndKeys:w=!e.freeSolo,id:ee,includeInputInList:te=!1,inputValue:ne,isOptionEqualToValue:re=(e,t)=>e===t,multiple:T=!1,onChange:ae,onClose:oe,onHighlightChange:se,onInputChange:E,onOpen:ce,open:ue,openOnFocus:D=!1,options:O,readOnly:de=!1,renderValue:k,selectOnFocus:fe=!e.freeSolo,value:pe}=e,A=he(ee),j=S;j=e=>{let t=S(e);return typeof t==`string`?t:String(t)};let me=H.useRef(!1),ge=H.useRef(!0),M=H.useRef(null),N=H.useRef(null),[_e,ve]=H.useState(null),[P,ye]=H.useState(-1),be=a?0:-1,F=H.useRef(be),xe=H.useRef(Pe(d??pe,T,j)).current,[I,L]=n({controlled:pe,default:d,name:u}),[R,z]=n({controlled:ne,default:xe,name:u,state:`inputValue`}),[B,Se]=H.useState(!1),Ce=H.useCallback((e,t,n)=>{if(!(T?I.length<t.length:t!==null)&&!c)return;let r=Pe(t,T,j,k);R!==r&&(z(r),E&&E(e,r,n))},[j,R,T,E,z,c,I,k]),[V,we]=n({controlled:ue,default:!1,name:u,state:`open`}),[Te,Ee]=H.useState(!0),De=!T&&I!=null&&R===j(I),U=V&&!de,W=U?_(O.filter(e=>!(v&&(T?I:[I]).some(t=>t!==null&&re(e,t)))),{inputValue:De&&Te?``:R,getOptionLabel:j}):[],G=Oe({filteredOptions:W,value:I,inputValue:R});H.useEffect(()=>{let e=I!==G.value;B&&!e||y&&!e||Ce(null,I,`reset`)},[I,Ce,B,G.value,y]);let Fe=V&&W.length>0&&!de,Ie=le(e=>{if(e===-1)M.current.focus();else{let t=k?`data-item-index`:`data-tag-index`;_e.querySelector(`[${t}="${e}"]`).focus()}});H.useEffect(()=>{T&&P>I.length-1&&(ye(-1),Ie(-1))},[I,T,P,Ie]);function K(e,t){if(!N.current||e<0||e>=W.length)return-1;let n=e;for(;;){let r=N.current.querySelector(`[data-option-index="${n}"]`),i=h?!1:!r||r.disabled||r.getAttribute(`aria-disabled`)===`true`;if(r&&r.hasAttribute(`tabindex`)&&!i)return n;if(n=t===`next`?(n+1)%W.length:(n-1+W.length)%W.length,n===e)return-1}}let Le=le(({event:e,index:t,reason:n})=>{if(F.current=t,t===-1?M.current.removeAttribute(`aria-activedescendant`):M.current.setAttribute(`aria-activedescendant`,`${A}-option-${t}`),se&&[`mouse`,`keyboard`,`touch`].includes(n)&&se(e,t===-1?null:W[t],n),!N.current)return;let i=N.current.querySelector(`[role="option"].${r}-focused`);i&&(i.classList.remove(`${r}-focused`),i.classList.remove(`${r}-focusVisible`));let a=N.current;if(N.current.getAttribute(`role`)!==`listbox`&&(a=N.current.parentElement.querySelector(`[role="listbox"]`)),!a)return;if(t===-1){a.scrollTop=0;return}let o=N.current.querySelector(`[data-option-index="${t}"]`);if(o&&(o.classList.add(`${r}-focused`),n===`keyboard`&&o.classList.add(`${r}-focusVisible`),a.scrollHeight>a.clientHeight&&n!==`mouse`&&n!==`touch`)){let e=o,t=a.clientHeight+a.scrollTop,n=e.offsetTop+e.offsetHeight;n>t?a.scrollTop=n-a.clientHeight:e.offsetTop-e.offsetHeight*(C?1.3:0)<a.scrollTop&&(a.scrollTop=e.offsetTop-e.offsetHeight*(C?1.3:0))}}),q=le(({event:e,diff:t,direction:n=`next`,reason:r})=>{if(!U)return;let a=K((()=>{let e=W.length-1;if(t===`reset`)return be;if(t===`start`)return 0;if(t===`end`)return e;let n=F.current+t;return n<0?n===-1&&te?-1:g&&F.current!==-1||Math.abs(t)>1?0:e:n>e?n===e+1&&te?-1:g||Math.abs(t)>1?e:0:n})(),n);if(Le({index:a,reason:r,event:e}),i&&t!==`reset`)if(a===-1)M.current.value=R;else{let e=j(W[a]);M.current.value=e,e.toLowerCase().indexOf(R.toLowerCase())===0&&R.length>0&&M.current.setSelectionRange(R.length,e.length)}}),Re=!ke({array1:G.filteredOptions,array2:W,parser:j}),J=()=>{if(F.current!==-1&&!ke({array1:G.filteredOptions,array2:W,parser:j})&&G.inputValue===R&&(T?I.length===G.value.length&&G.value.every((e,t)=>j(I[t])===j(e)):((e,t)=>(e?j(e):``)===(t?j(t):``))(G.value,I))){let e=G.filteredOptions[F.current];if(e)return W.findIndex(t=>j(t)===j(e))}return-1},ze=H.useCallback(()=>{if(!U)return;let e=J();if(e!==-1){F.current=e;return}let t=T?I[0]:I;if(W.length===0||t==null){q({diff:`reset`});return}if(N.current){if(t!=null){let e=W[F.current];if(T&&e&&I.findIndex(t=>re(e,t))!==-1)return;let n=W.findIndex(e=>re(e,t));n===-1?q({diff:`reset`}):Le({index:n});return}if(F.current>=W.length-1){Le({index:W.length-1});return}Le({index:F.current})}},[W.length,T?!1:I,q,Le,U,R,T]),Y=le(e=>{ie(N,e),e&&ze()});H.useEffect(()=>{(Re||U)&&ze()},[ze,Re,U]);let Be=e=>{V||(we(!0),Ee(!0),ce&&ce(e))},Ve=(e,t)=>{V&&(we(!1),oe&&oe(e,t))},He=(e,t,n,r)=>{if(T){if(I.length===t.length&&I.every((e,n)=>e===t[n]))return}else if(I===t)return;ae&&ae(e,t,n,r),L(t)},Ue=H.useRef(!1),We=(e,t,n=`selectOption`,r=`options`)=>{let i=n,a=t;if(T){a=Array.isArray(I)?I.slice():[];let e=a.findIndex(e=>re(t,e));e===-1?a.push(t):r!==`freeSolo`&&(a.splice(e,1),i=`removeOption`)}Ce(e,a,i),He(e,a,i,{option:t}),!p&&(!e||!e.ctrlKey&&!e.metaKey)&&Ve(e,i),(s===!0||s===`touch`&&Ue.current||s===`mouse`&&!Ue.current)&&M.current.blur()};function Ge(e,t){if(e===-1)return-1;let n=e;for(;;){if(t===`next`&&n===I.length||t===`previous`&&n===-1)return-1;let e=k?`data-item-index`:`data-tag-index`,r=_e.querySelector(`[${e}="${n}"]`);if(!r||!r.hasAttribute(`tabindex`)||r.disabled||r.getAttribute(`aria-disabled`)===`true`)n+=t===`next`?1:-1;else return n}}let Ke=(e,t)=>{if(!T)return;R===``&&Ve(e,`toggleInput`);let n=P;P===-1&&t===`previous`?(n=I.length-1,y&&R!==``&&(z(``),E&&E(e,``,`reset`))):(n+=t===`next`?1:-1,n<0&&(n=0),n===I.length&&(n=-1)),n=Ge(n,t),ye(n),Ie(n)},qe=e=>{me.current=!0,z(``),E&&E(e,``,`clear`),He(e,T?[]:null,`clear`)},Je=e=>t=>{if(e.onKeyDown&&e.onKeyDown(t),!t.defaultMuiPrevented&&(P!==-1&&![`ArrowLeft`,`ArrowRight`].includes(t.key)&&(ye(-1),Ie(-1)),t.which!==229))switch(t.key){case`Home`:U&&w&&(t.preventDefault(),q({diff:`start`,direction:`next`,reason:`keyboard`,event:t}));break;case`End`:U&&w&&(t.preventDefault(),q({diff:`end`,direction:`previous`,reason:`keyboard`,event:t}));break;case`PageUp`:t.preventDefault(),q({diff:-je,direction:`previous`,reason:`keyboard`,event:t}),Be(t);break;case`PageDown`:t.preventDefault(),q({diff:je,direction:`next`,reason:`keyboard`,event:t}),Be(t);break;case`ArrowDown`:t.preventDefault(),q({diff:1,direction:`next`,reason:`keyboard`,event:t}),Be(t);break;case`ArrowUp`:t.preventDefault(),q({diff:-1,direction:`previous`,reason:`keyboard`,event:t}),Be(t);break;case`ArrowLeft`:{let e=M.current;if(!(e&&e.selectionStart===0&&e.selectionEnd===0))return;!T&&k&&I!=null?(y&&R!==``&&(z(``),E&&E(t,``,`reset`)),ye(0),Ie(0)):Ke(t,`previous`);break}case`ArrowRight`:!T&&k?(ye(-1),Ie(-1)):Ke(t,`next`);break;case`Enter`:if(F.current!==-1&&U){let e=W[F.current],n=b?b(e):!1;if(t.preventDefault(),n)return;We(t,e,`selectOption`),i&&M.current.setSelectionRange(M.current.value.length,M.current.value.length)}else y&&R!==``&&De===!1&&(T&&t.preventDefault(),We(t,R,`createOption`,`freeSolo`));break;case`Escape`:U?(t.preventDefault(),t.stopPropagation(),Ve(t,`escape`)):l&&(R!==``||T&&I.length>0||k)&&(t.preventDefault(),t.stopPropagation(),qe(t));break;case`Backspace`:if(T&&!de&&R===``&&I.length>0){let e=P===-1?I.length-1:P,n=I.slice();n.splice(e,1),He(t,n,`removeOption`,{option:I[e]})}!T&&k&&!de&&R===``&&He(t,null,`removeOption`,{option:I});break;case`Delete`:if(T&&!de&&R===``&&I.length>0&&P!==-1){let e=P,n=I.slice();n.splice(e,1),He(t,n,`removeOption`,{option:I[e]})}!T&&k&&!de&&R===``&&He(t,null,`removeOption`,{option:I});break;default:}},Ye=e=>{Se(!0),P!==-1&&(ye(-1),Ie(-1)),D&&!me.current&&Be(e)},Xe=e=>{if(t(N)){M.current.focus();return}Se(!1),ge.current=!0,me.current=!1,o&&F.current!==-1&&U?We(e,W[F.current],`blur`):o&&y&&R!==``?We(e,R,`blur`,`freeSolo`):c&&Ce(e,I,`blur`),Ve(e,`blur`)},Ze=e=>{let t=e.target.value;R!==t&&(z(t),Ee(!1),E&&E(e,t,`input`)),t===``?!f&&!T&&!k&&He(e,null,`clear`):Be(e)},Qe=e=>{let t=Number(e.currentTarget.getAttribute(`data-option-index`));F.current!==t&&Le({event:e,index:t,reason:`mouse`})},$e=e=>{Le({event:e,index:Number(e.currentTarget.getAttribute(`data-option-index`)),reason:`touch`}),Ue.current=!0},et=e=>{We(e,W[Number(e.currentTarget.getAttribute(`data-option-index`))],`selectOption`),Ue.current=!1},tt=e=>t=>{let n=I.slice();n.splice(e,1),He(t,n,`removeOption`,{option:I[e]})},nt=e=>{He(e,null,`removeOption`,{option:I})},rt=e=>{V?Ve(e,`toggleInput`):Be(e)},it=e=>{e.currentTarget.contains(e.target)&&e.target.getAttribute(`id`)!==A&&e.preventDefault()},at=e=>{e.currentTarget.contains(e.target)&&(M.current.focus(),fe&&ge.current&&M.current.selectionEnd-M.current.selectionStart===0&&M.current.select(),ge.current=!1)},ot=e=>{!m&&(R===``||!V)&&rt(e)},st=y&&R.length>0;st||=T?I.length>0:I!==null;let ct=W;return C&&(ct=W.reduce((e,t,n)=>{let r=C(t);return e.length>0&&e[e.length-1].group===r?e[e.length-1].options.push(t):e.push({key:n,index:n,group:r,options:[t]}),e},[])),m&&B&&Xe(),{getRootProps:(e={})=>({...e,onKeyDown:Je(e),onMouseDown:it,onClick:at}),getInputLabelProps:()=>({id:`${A}-label`,htmlFor:A}),getInputProps:()=>({id:A,value:R,onBlur:Xe,onFocus:Ye,onChange:Ze,onMouseDown:ot,"aria-activedescendant":U?``:null,"aria-autocomplete":i?`both`:`list`,"aria-controls":Fe?`${A}-listbox`:void 0,"aria-expanded":Fe,autoComplete:`off`,ref:M,autoCapitalize:`none`,spellCheck:`false`,role:`combobox`,disabled:m}),getClearProps:()=>({tabIndex:-1,type:`button`,onClick:qe}),getItemProps:({index:e=0}={})=>({...T&&{key:e},...k?{"data-item-index":e}:{"data-tag-index":e},tabIndex:-1,...!de&&{onDelete:T?tt(e):nt}}),getPopupIndicatorProps:()=>({tabIndex:-1,type:`button`,onClick:rt}),getTagProps:({index:e})=>({key:e,"data-tag-index":e,tabIndex:-1,...!de&&{onDelete:tt(e)}}),getListboxProps:()=>({role:`listbox`,id:`${A}-listbox`,"aria-labelledby":`${A}-label`,ref:Y,onMouseDown:e=>{e.preventDefault()}}),getOptionProps:({index:e,option:t})=>{let n=(T?I:[I]).some(e=>e!=null&&re(t,e)),r=b?b(t):!1;return{key:x?.(t)??j(t),tabIndex:-1,role:`option`,id:`${A}-option-${e}`,onMouseMove:Qe,onClick:et,onTouchStart:$e,"data-option-index":e,"aria-disabled":r,"aria-selected":n}},id:A,inputValue:R,value:I,dirty:st,expanded:U&&_e,popupOpen:U,focused:B||P!==-1,anchorEl:_e,setAnchorEl:ve,focusedItem:P,focusedTag:P,groupedOptions:ct}}var Fe=G;function Ie(e){return z(`MuiListSubheader`,e)}k(`MuiListSubheader`,[`root`,`colorPrimary`,`colorInherit`,`gutters`,`inset`,`sticky`]);var K=T(te()),Le=e=>{let{classes:t,color:n,disableGutters:r,inset:i,disableSticky:a}=e;return pe({root:[`root`,n!==`default`&&`color${D(n)}`,!r&&`gutters`,i&&`inset`,!a&&`sticky`]},Ie,t)},q=L(`li`,{name:`MuiListSubheader`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,n.color!==`default`&&t[`color${D(n.color)}`],!n.disableGutters&&t.gutters,n.inset&&t.inset,!n.disableSticky&&t.sticky]}})(O(({theme:e})=>({boxSizing:`border-box`,lineHeight:`48px`,listStyle:`none`,color:(e.vars||e).palette.text.secondary,fontFamily:e.typography.fontFamily,fontWeight:e.typography.fontWeightMedium,fontSize:e.typography.pxToRem(14),variants:[{props:{color:`primary`},style:{color:(e.vars||e).palette.primary.main}},{props:{color:`inherit`},style:{color:`inherit`}},{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.inset,style:{paddingLeft:72}},{props:({ownerState:e})=>!e.disableSticky,style:{position:`sticky`,top:0,zIndex:1,backgroundColor:(e.vars||e).palette.background.paper}}]}))),Re=H.forwardRef(function(e,t){let n=ee({props:e,name:`MuiListSubheader`}),{className:r,color:i=`default`,component:a=`li`,disableGutters:o=!1,disableSticky:s=!1,inset:c=!1,...l}=n,u={...n,color:i,component:a,disableGutters:o,disableSticky:s,inset:c};return(0,K.jsx)(q,{as:a,className:V(Le(u).root,r),ref:t,ownerState:u,...l})});Re&&(Re.muiSkipListHighlight=!0);var J=Re;function ze(e){return z(`MuiAutocomplete`,e)}var Y=k(`MuiAutocomplete`,`root.expanded.fullWidth.focused.focusVisible.tag.tagSizeSmall.tagSizeMedium.hasPopupIcon.hasClearIcon.inputRoot.input.inputFocused.endAdornment.clearIndicator.popupIndicator.popupIndicatorOpen.popper.popperDisablePortal.paper.listbox.loading.noOptions.option.groupLabel.groupUl`.split(`.`)),Be,Ve,He=e=>{let{classes:t,disablePortal:n,expanded:r,focused:i,fullWidth:a,hasClearIcon:o,hasPopupIcon:s,inputFocused:c,popupOpen:l,size:u}=e;return pe({root:[`root`,r&&`expanded`,i&&`focused`,a&&`fullWidth`,o&&`hasClearIcon`,s&&`hasPopupIcon`],inputRoot:[`inputRoot`],input:[`input`,c&&`inputFocused`],tag:[`tag`,`tagSize${D(u)}`],endAdornment:[`endAdornment`],clearIndicator:[`clearIndicator`],popupIndicator:[`popupIndicator`,l&&`popupIndicatorOpen`],popper:[`popper`,n&&`popperDisablePortal`],paper:[`paper`],listbox:[`listbox`],loading:[`loading`],noOptions:[`noOptions`],option:[`option`],groupLabel:[`groupLabel`],groupUl:[`groupUl`]},ze,t)},Ue=L(`div`,{name:`MuiAutocomplete`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e,{fullWidth:r,hasClearIcon:i,hasPopupIcon:a,inputFocused:o,size:s}=n;return[{[`& .${Y.tag}`]:t.tag},{[`& .${Y.tag}`]:t[`tagSize${D(s)}`]},{[`& .${Y.inputRoot}`]:t.inputRoot},{[`& .${Y.input}`]:t.input},{[`& .${Y.input}`]:o&&t.inputFocused},t.root,r&&t.fullWidth,a&&t.hasPopupIcon,i&&t.hasClearIcon]}})({[`&.${Y.focused} .${Y.clearIndicator}`]:{visibility:`visible`},"@media (pointer: fine)":{[`&:hover .${Y.clearIndicator}`]:{visibility:`visible`}},[`& .${Y.tag}`]:{margin:3,maxWidth:`calc(100% - 6px)`},[`& .${Y.inputRoot}`]:{[`.${Y.hasPopupIcon}&, .${Y.hasClearIcon}&`]:{paddingRight:30},[`.${Y.hasPopupIcon}.${Y.hasClearIcon}&`]:{paddingRight:56},[`& .${Y.input}`]:{width:0,minWidth:30}},[`& .${i.root}`]:{paddingBottom:1,"& .MuiInput-input":{padding:`4px 4px 4px 0px`}},[`& .${i.root}.${c.sizeSmall}`]:{[`& .${i.input}`]:{padding:`2px 4px 3px 0`}},[`& .${r.root}`]:{padding:9,[`.${Y.hasPopupIcon}&, .${Y.hasClearIcon}&`]:{paddingRight:39},[`.${Y.hasPopupIcon}.${Y.hasClearIcon}&`]:{paddingRight:65},[`& .${Y.input}`]:{padding:`7.5px 4px 7.5px 5px`},[`& .${Y.endAdornment}`]:{right:9}},[`& .${r.root}.${c.sizeSmall}`]:{paddingTop:6,paddingBottom:6,paddingLeft:6,[`& .${Y.input}`]:{padding:`2.5px 4px 2.5px 8px`}},[`& .${d.root}`]:{paddingTop:19,paddingLeft:8,[`.${Y.hasPopupIcon}&, .${Y.hasClearIcon}&`]:{paddingRight:39},[`.${Y.hasPopupIcon}.${Y.hasClearIcon}&`]:{paddingRight:65},[`& .${d.input}`]:{padding:`7px 4px`},[`& .${Y.endAdornment}`]:{right:9}},[`& .${d.root}.${c.sizeSmall}`]:{paddingBottom:1,[`& .${d.input}`]:{padding:`2.5px 4px`}},[`& .${c.hiddenLabel}`]:{paddingTop:8},[`& .${d.root}.${c.hiddenLabel}`]:{paddingTop:0,paddingBottom:0,[`& .${Y.input}`]:{paddingTop:16,paddingBottom:17}},[`& .${d.root}.${c.hiddenLabel}.${c.sizeSmall}`]:{[`& .${Y.input}`]:{paddingTop:8,paddingBottom:9}},[`& .${Y.input}`]:{flexGrow:1,textOverflow:`ellipsis`,opacity:0},variants:[{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{[`& .${Y.tag}`]:{margin:2,maxWidth:`calc(100% - 4px)`}}},{props:{inputFocused:!0},style:{[`& .${Y.input}`]:{opacity:1}}},{props:{multiple:!0},style:{[`& .${Y.inputRoot}`]:{flexWrap:`wrap`}}}]}),We=L(`div`,{name:`MuiAutocomplete`,slot:`EndAdornment`})({position:`absolute`,right:0,top:`50%`,transform:`translate(0, -50%)`}),Ge=L(E,{name:`MuiAutocomplete`,slot:`ClearIndicator`})({marginRight:-2,padding:4,visibility:`hidden`}),Ke=L(E,{name:`MuiAutocomplete`,slot:`PopupIndicator`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.popupIndicator,n.popupOpen&&t.popupIndicatorOpen]}})({padding:2,marginRight:-2,variants:[{props:{popupOpen:!0},style:{transform:`rotate(180deg)`}}]}),qe=L(h,{name:`MuiAutocomplete`,slot:`Popper`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${Y.option}`]:t.option},t.popper,n.disablePortal&&t.popperDisablePortal]}})(O(({theme:e})=>({zIndex:(e.vars||e).zIndex.modal,variants:[{props:{disablePortal:!0},style:{position:`absolute`}}]}))),Je=L(re,{name:`MuiAutocomplete`,slot:`Paper`})(O(({theme:e})=>({...e.typography.body1,overflow:`auto`}))),Ye=L(`div`,{name:`MuiAutocomplete`,slot:`Loading`})(O(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Xe=L(`div`,{name:`MuiAutocomplete`,slot:`NoOptions`})(O(({theme:e})=>({color:(e.vars||e).palette.text.secondary,padding:`14px 16px`}))),Ze=L(`ul`,{name:`MuiAutocomplete`,slot:`Listbox`})(O(({theme:e})=>({listStyle:`none`,margin:0,padding:`8px 0`,maxHeight:`40vh`,overflow:`auto`,position:`relative`,[`& .${Y.option}`]:{minHeight:48,display:`flex`,overflow:`hidden`,justifyContent:`flex-start`,alignItems:`center`,cursor:`pointer`,paddingTop:6,boxSizing:`border-box`,outline:`0`,WebkitTapHighlightColor:`transparent`,paddingBottom:6,paddingLeft:16,paddingRight:16,[e.breakpoints.up(`sm`)]:{minHeight:`auto`},[`&.${Y.focused}`]:{backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:`transparent`}},'&[aria-disabled="true"]':{opacity:(e.vars||e).palette.action.disabledOpacity,pointerEvents:`none`},[`&.${Y.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},'&[aria-selected="true"]':{backgroundColor:e.alpha((e.vars||e).palette.primary.main,(e.vars||e).palette.action.selectedOpacity),[`&.${Y.focused}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:(e.vars||e).palette.action.selected}},[`&.${Y.focusVisible}`]:{backgroundColor:e.alpha((e.vars||e).palette.primary.main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.focusOpacity}`)}}}}))),Qe=L(J,{name:`MuiAutocomplete`,slot:`GroupLabel`})(O(({theme:e})=>({backgroundColor:(e.vars||e).palette.background.paper,top:-8}))),$e=L(`ul`,{name:`MuiAutocomplete`,slot:`GroupUl`})({padding:0,[`& .${Y.option}`]:{paddingLeft:24}}),et=H.forwardRef(function(e,t){let n=ee({props:e,name:`MuiAutocomplete`}),{autoComplete:r=!1,autoHighlight:i=!1,autoSelect:a=!1,blurOnSelect:s=!1,ChipProps:c,className:l,clearIcon:u=Be||=(0,K.jsx)(Ce,{fontSize:`small`}),clearOnBlur:d=!n.freeSolo,clearOnEscape:f=!1,clearText:p=`Clear`,closeText:m=`Close`,componentsProps:_,defaultValue:v=n.multiple?[]:null,disableClearable:y=!1,disableCloseOnSelect:b=!1,disabled:x=!1,disabledItemsFocusable:S=!1,disableListWrap:C=!1,disablePortal:w=!1,filterOptions:te,filterSelectedOptions:ne=!1,forcePopupIcon:ie=`auto`,freeSolo:T=!1,fullWidth:ae=!1,getLimitTagsText:se=e=>`+${e}`,getOptionDisabled:E,getOptionKey:ce,getOptionLabel:le,isOptionEqualToValue:ue,groupBy:D,handleHomeEndKeys:O=!n.freeSolo,id:de,includeInputInList:k=!1,inputValue:fe,limitTags:pe=-1,ListboxComponent:A,ListboxProps:j,loading:me=!1,loadingText:he=`Loading…`,multiple:ge=!1,noOptionsText:M=`No options`,onChange:N,onClose:_e,onHighlightChange:ve,onInputChange:P,onOpen:ye,open:be,openOnFocus:F=!1,openText:xe=`Open`,options:I,PaperComponent:L,PopperComponent:R,popupIcon:z=Ve||=(0,K.jsx)(o,{}),readOnly:B=!1,renderGroup:Se,renderInput:we,renderOption:Te,renderTags:Ee,renderValue:De,selectOnFocus:Oe=!n.freeSolo,size:ke=`medium`,slots:U={},slotProps:W={},value:Ae,...je}=n,{getRootProps:Me,getInputProps:Ne,getInputLabelProps:Pe,getPopupIndicatorProps:G,getClearProps:Ie,getItemProps:Le,getListboxProps:q,getOptionProps:Re,value:J,dirty:ze,expanded:Y,id:et,popupOpen:tt,focused:nt,focusedItem:rt,anchorEl:it,setAnchorEl:at,inputValue:ot,groupedOptions:st}=Fe({...n,componentName:`Autocomplete`}),ct=!y&&!x&&ze&&!B,lt=(!T||ie===!0)&&ie!==!1,{onMouseDown:ut}=Ne(),{ref:X,...dt}=q(),ft=le||(e=>e.label??e),Z={...n,disablePortal:w,expanded:Y,focused:nt,fullWidth:ae,getOptionLabel:ft,hasClearIcon:ct,hasPopupIcon:lt,inputFocused:rt===-1,popupOpen:tt,size:ke},Q=He(Z),pt={slots:{paper:L,popper:R,...U},slotProps:{chip:c,listbox:j,..._,...W}},[mt,ht]=oe(`listbox`,{elementType:Ze,externalForwardedProps:pt,ownerState:Z,className:Q.listbox,additionalProps:dt,ref:X}),[gt,_t]=oe(`paper`,{elementType:re,externalForwardedProps:pt,ownerState:Z,className:Q.paper}),[vt,yt]=oe(`popper`,{elementType:h,externalForwardedProps:pt,ownerState:Z,className:Q.popper,additionalProps:{disablePortal:w,style:{width:it?it.clientWidth:null},role:`presentation`,anchorEl:it,open:tt}}),$,bt=e=>({className:Q.tag,disabled:x,...Le(e)});if(ge?J.length>0&&($=Ee?Ee(J,bt,Z):De?De(J,bt,Z):J.map((e,t)=>{let{key:n,...r}=bt({index:t});return(0,K.jsx)(g,{label:ft(e),size:ke,...r,...pt.slotProps.chip},n)})):De&&J!=null&&($=De(J,bt,Z)),pe>-1&&Array.isArray($)){let e=$.length-pe;!nt&&e>0&&($=$.splice(0,pe),$.push((0,K.jsx)(`span`,{className:Q.tag,children:se(e)},$.length)))}let xt=Se||(e=>(0,K.jsxs)(`li`,{children:[(0,K.jsx)(Qe,{className:Q.groupLabel,ownerState:Z,component:`div`,children:e.group}),(0,K.jsx)($e,{className:Q.groupUl,ownerState:Z,children:e.children})]},e.key)),St=Te||((e,t)=>{let{key:n,...r}=e;return(0,K.jsx)(`li`,{...r,children:ft(t)},n)}),Ct=(e,t)=>{let n=Re({option:e,index:t});return St({...n,className:Q.option},e,{selected:n[`aria-selected`],index:t,inputValue:ot},Z)},wt=pt.slotProps.clearIndicator,Tt=pt.slotProps.popupIndicator;return(0,K.jsxs)(H.Fragment,{children:[(0,K.jsx)(Ue,{ref:t,className:V(Q.root,l),ownerState:Z,...Me(je),children:we({id:et,disabled:x,fullWidth:!0,size:ke===`small`?`small`:void 0,InputLabelProps:Pe(),InputProps:{ref:at,className:Q.inputRoot,startAdornment:$,onMouseDown:e=>{e.target===e.currentTarget&&ut(e)},...(ct||lt)&&{endAdornment:(0,K.jsxs)(We,{className:Q.endAdornment,ownerState:Z,children:[ct?(0,K.jsx)(Ge,{...Ie(),"aria-label":p,title:p,ownerState:Z,...wt,className:V(Q.clearIndicator,wt?.className),children:u}):null,lt?(0,K.jsx)(Ke,{...G(),disabled:x,"aria-label":tt?m:xe,title:tt?m:xe,ownerState:Z,...Tt,className:V(Q.popupIndicator,Tt?.className),children:z}):null]})}},inputProps:{className:Q.input,disabled:x,readOnly:B,...Ne()}})}),it?(0,K.jsx)(qe,{as:vt,...yt,children:(0,K.jsxs)(Je,{as:gt,..._t,children:[me&&st.length===0?(0,K.jsx)(Ye,{className:Q.loading,ownerState:Z,children:he}):null,st.length===0&&!T&&!me?(0,K.jsx)(Xe,{className:Q.noOptions,ownerState:Z,role:`presentation`,onMouseDown:e=>{e.preventDefault()},children:M}):null,st.length>0?(0,K.jsx)(mt,{as:A,...ht,children:st.map((e,t)=>D?xt({key:e.key,group:e.group,children:e.options.map((t,n)=>Ct(t,e.index+n))}):Ct(e,t))}):null]})}):null]})});function tt(e){return H.Children.toArray(e).filter(e=>H.isValidElement(e))}function nt(e){return z(`MuiToggleButton`,e)}var rt=k(`MuiToggleButton`,[`root`,`disabled`,`selected`,`standard`,`primary`,`secondary`,`sizeSmall`,`sizeMedium`,`sizeLarge`,`fullWidth`]),it=H.createContext({}),at=H.createContext(void 0);function ot(e,t){return t===void 0||e===void 0?!1:Array.isArray(t)?t.includes(e):e===t}var st=e=>{let{classes:t,fullWidth:n,selected:r,disabled:i,size:a,color:o}=e;return pe({root:[`root`,r&&`selected`,i&&`disabled`,n&&`fullWidth`,`size${D(a)}`,o]},nt,t)},ct=L(ce,{name:`MuiToggleButton`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[t.root,t[`size${D(n.size)}`]]}})(O(({theme:e})=>({...e.typography.button,borderRadius:(e.vars||e).shape.borderRadius,padding:11,border:`1px solid ${(e.vars||e).palette.divider}`,color:(e.vars||e).palette.action.active,[`&.${rt.disabled}`]:{color:(e.vars||e).palette.action.disabled,border:`1px solid ${(e.vars||e).palette.action.disabledBackground}`},"&:hover":{textDecoration:`none`,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:`transparent`}},variants:[{props:{color:`standard`},style:{[`&.${rt.selected}`]:{color:(e.vars||e).palette.text.primary,backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette.text.primary,(e.vars||e).palette.action.selectedOpacity)}}}}},...Object.entries(e.palette).filter(Se()).map(([t])=>({props:{color:t},style:{[`&.${rt.selected}`]:{color:(e.vars||e).palette[t].main,backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity),"&:hover":{backgroundColor:e.alpha((e.vars||e).palette[t].main,`${(e.vars||e).palette.action.selectedOpacity} + ${(e.vars||e).palette.action.hoverOpacity}`),"@media (hover: none)":{backgroundColor:e.alpha((e.vars||e).palette[t].main,(e.vars||e).palette.action.selectedOpacity)}}}}})),{props:{fullWidth:!0},style:{width:`100%`}},{props:{size:`small`},style:{padding:7,fontSize:e.typography.pxToRem(13)}},{props:{size:`large`},style:{padding:15,fontSize:e.typography.pxToRem(15)}}]}))),lt=H.forwardRef(function(e,t){let{value:n,...r}=H.useContext(it),i=H.useContext(at),a=ee({props:M({...r,selected:ot(e.value,n)},e),name:`MuiToggleButton`}),{children:o,className:s,color:c=`standard`,disabled:l=!1,disableFocusRipple:u=!1,fullWidth:d=!1,onChange:f,onClick:p,selected:m,size:h=`medium`,value:g,..._}=a,v={...a,color:c,disabled:l,disableFocusRipple:u,fullWidth:d,size:h},y=st(v),b=e=>{p&&(p(e,g),e.defaultPrevented)||f&&f(e,g)},x=i||``;return(0,K.jsx)(ct,{className:V(r.className,y.root,s,x),disabled:l,focusRipple:!u,ref:t,onClick:b,onChange:f,value:g,ownerState:v,"aria-pressed":m,..._,children:o})});function ut(e){return z(`MuiToggleButtonGroup`,e)}var X=k(`MuiToggleButtonGroup`,[`root`,`selected`,`horizontal`,`vertical`,`disabled`,`grouped`,`groupedHorizontal`,`groupedVertical`,`fullWidth`,`firstButton`,`lastButton`,`middleButton`]),dt=e=>{let{classes:t,orientation:n,fullWidth:r,disabled:i}=e;return pe({root:[`root`,n,r&&`fullWidth`],grouped:[`grouped`,`grouped${D(n)}`,i&&`disabled`],firstButton:[`firstButton`],lastButton:[`lastButton`],middleButton:[`middleButton`]},ut,t)},ft=L(`div`,{name:`MuiToggleButtonGroup`,slot:`Root`,overridesResolver:(e,t)=>{let{ownerState:n}=e;return[{[`& .${X.grouped}`]:t.grouped},{[`& .${X.grouped}`]:t[`grouped${D(n.orientation)}`]},{[`& .${X.firstButton}`]:t.firstButton},{[`& .${X.lastButton}`]:t.lastButton},{[`& .${X.middleButton}`]:t.middleButton},t.root,n.orientation===`vertical`&&t.vertical,n.fullWidth&&t.fullWidth]}})(O(({theme:e})=>({display:`inline-flex`,borderRadius:(e.vars||e).shape.borderRadius,variants:[{props:{orientation:`vertical`},style:{flexDirection:`column`,[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderTop:0,marginTop:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderBottomLeftRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginTop:-1,borderTop:`1px solid transparent`,borderTopLeftRadius:0,borderTopRightRadius:0},[`& .${X.lastButton}.${rt.disabled},& .${X.middleButton}.${rt.disabled}`]:{borderTop:`1px solid transparent`}}},{props:{fullWidth:!0},style:{width:`100%`}},{props:{orientation:`horizontal`},style:{[`& .${X.grouped}`]:{[`&.${X.selected} + .${X.grouped}.${X.selected}`]:{borderLeft:0,marginLeft:0}},[`& .${X.firstButton},& .${X.middleButton}`]:{borderTopRightRadius:0,borderBottomRightRadius:0},[`& .${X.lastButton},& .${X.middleButton}`]:{marginLeft:-1,borderLeft:`1px solid transparent`,borderTopLeftRadius:0,borderBottomLeftRadius:0},[`& .${X.lastButton}.${rt.disabled},& .${X.middleButton}.${rt.disabled}`]:{borderLeft:`1px solid transparent`}}}]}))),Z=H.forwardRef(function(e,t){let n=ee({props:e,name:`MuiToggleButtonGroup`}),{children:r,className:i,color:a=`standard`,disabled:o=!1,exclusive:s=!1,fullWidth:c=!1,onChange:l,orientation:u=`horizontal`,size:d=`medium`,value:f,...p}=n,m={...n,disabled:o,fullWidth:c,orientation:u,size:d},h=dt(m),g=H.useCallback((e,t)=>{if(!l)return;let n=f&&f.indexOf(t),r;f&&n>=0?(r=f.slice(),r.splice(n,1)):r=f?f.concat(t):[t],l(e,r)},[l,f]),_=H.useCallback((e,t)=>{l&&l(e,f===t?null:t)},[l,f]),v=H.useMemo(()=>({className:h.grouped,onChange:s?_:g,value:f,size:d,fullWidth:c,color:a,disabled:o}),[h.grouped,s,_,g,f,d,c,a,o]),y=tt(r),b=y.length,x=e=>{let t=e===0,n=e===b-1;return t&&n?``:t?h.firstButton:n?h.lastButton:h.middleButton};return(0,K.jsx)(ft,{role:`group`,className:V(h.root,i),ref:t,ownerState:m,...p,children:(0,K.jsx)(it.Provider,{value:v,children:y.map((e,t)=>(0,K.jsx)(at.Provider,{value:x(t),children:e},t))})})}),Q=ae((0,K.jsx)(`path`,{d:`m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8z`}),`ArrowDownward`),pt=ae((0,K.jsx)(`path`,{d:`m4 12 1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8z`}),`ArrowUpward`),mt=ae((0,K.jsx)(`path`,{d:`M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z`}),`Delete`);function ht({preview:t,configText:n,loading:r,error:i,onLoadPreview:a,onGenerateConfig:o}){let{showSuccess:s}=Ee();return(0,K.jsxs)(e,{spacing:2.5,children:[(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Navidrome TOML Configuration`}),(0,K.jsxs)(e,{spacing:1.25,children:[(0,K.jsx)(N,{onClick:a,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Loading...`:`Load Tag Preview`}),(0,K.jsx)(N,{onClick:o,disabled:r,variant:`contained`,fullWidth:!0,children:r?`Generating...`:`Generate Config`})]}),i&&(0,K.jsxs)(ue,{children:[`Error: `,i]})]}),t&&(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Tag Preview`}),(0,K.jsx)(j,{sx:{overflowX:`auto`},children:(0,K.jsxs)(y,{children:[(0,K.jsx)(x,{children:(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Type`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Multivalue`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Count`}),(0,K.jsx)(S,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Summary`})]})}),(0,K.jsx)(b,{children:t.map(e=>(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{sx:{borderColor:`divider`},title:e.tag_key,children:e.short_name}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.type}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.is_multivalue?`Yes`:`No`}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.total_count}),(0,K.jsx)(S,{sx:{borderColor:`divider`},children:e.summary})]},e.tag_key))})]})})]}),n&&(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Generated Config`}),(0,K.jsx)(_,{multiline:!0,rows:20,value:n,fullWidth:!0,InputProps:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}),(0,K.jsx)(N,{onClick:()=>{n&&(navigator.clipboard.writeText(n),s(`Copied to clipboard!`))},variant:`contained`,sx:{mt:1.25},children:`Copy to Clipboard`})]})]})}var gt=new Set([`artist`,`artists`,`album`,`album_artist`,`genre`,`year`,`date`,`bpm`,`composer`,`label`,`publisher`,`title`,`lyricist`]),_t=new Set([`year`,`bpm`]),vt={artist:`Artist`,artists:`Artists`,album:`Album`,album_artist:`Album Artist`,genre:`Genre`,year:`Year`,date:`Date`,bpm:`BPM`,composer:`Composer`,label:`Label`,publisher:`Publisher`,title:`Title`,lyricist:`Lyricist`,"nom:mood-loose":`Mood (Loose)`,"nom:mood-regular":`Mood (Regular)`,"nom:mood-strict":`Mood (Strict)`};function yt(e){return gt.has(e)||e.startsWith(`nom:`)}function $(){let[e,t]=(0,H.useState)([]),[n,r]=(0,H.useState)(!1),[i,a]=(0,H.useState)(null),o=(0,H.useCallback)(async()=>{try{r(!0),a(null),t(await me())}catch(e){a(e instanceof Error?e.message:`Failed to load tag metadata`)}finally{r(!1)}},[]);(0,H.useEffect)(()=>{o()},[o]);let s=(0,H.useMemo)(()=>e.filter(e=>yt(e.key)).map(e=>({...e,type:_t.has(e.key)?`integer`:e.type,label:vt[e.key]??e.short_name??e.key})).sort((e,t)=>e.label.localeCompare(t.label)),[e]);return{tags:s,numericTags:(0,H.useMemo)(()=>s.filter(e=>e.type===`float`||e.type===`integer`),[s]),stringTags:(0,H.useMemo)(()=>s.filter(e=>e.type===`string`),[s]),loading:n,error:i,reload:o}}function bt({data:t}){let{total_count:n,sample_tracks:r}=t;return(0,K.jsxs)(e,{spacing:1.5,children:[(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`Matching tracks`}),(0,K.jsx)(g,{label:n,size:`small`,color:`primary`})]}),r.length>0?(0,K.jsx)(w,{children:(0,K.jsxs)(y,{size:`small`,children:[(0,K.jsx)(x,{children:(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{children:`Title`}),(0,K.jsx)(S,{children:`Artist`}),(0,K.jsx)(S,{children:`Album`})]})}),(0,K.jsx)(b,{children:r.map((e,t)=>(0,K.jsxs)(C,{children:[(0,K.jsx)(S,{children:e.title??`—`}),(0,K.jsx)(S,{children:e.artist??`—`}),(0,K.jsx)(S,{children:e.album??`—`})]},t))})]})}):(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`No tracks match the current rules.`}),r.length>0&&r.length<n&&(0,K.jsxs)(B,{variant:`caption`,color:`text.secondary`,children:[`Showing `,r.length,` of `,n,` matches`]})]})}var xt=[{value:`=`,label:`=`},{value:`!=`,label:`≠`},{value:`>`,label:`>`},{value:`<`,label:`<`}],St=[{value:`contains`,label:`contains`},{value:`notcontains`,label:`not contains`},{value:`=`,label:`=`},{value:`!=`,label:`≠`}];function Ct({rule:n,numericTags:r,stringTags:i,onChange:o,onRemove:c}){let u=[...r,...i],d=u.find(e=>e.key===n.tagKey),f=d?.type===`float`||d?.type===`integer`,p=f?xt:St,[m,h]=(0,H.useState)([]),[g,y]=(0,H.useState)(!1),b=(0,H.useCallback)(async e=>{if(!e){h([]);return}try{y(!0),h(await fe(e))}catch{h([])}finally{y(!1)}},[]);return(0,H.useEffect)(()=>{b(n.tagKey)},[n.tagKey,b]),(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsxs)(l,{size:`small`,sx:{minWidth:180,flex:2},children:[(0,K.jsx)(t,{children:`Tag`}),(0,K.jsxs)(s,{value:n.tagKey,label:`Tag`,onChange:e=>{let t=e.target.value,r=u.find(e=>e.key===t),i=f,a=r?.type===`float`||r?.type===`integer`,s=i===a&&p.some(e=>e.value===n.operator),c=a?`=`:`contains`;o({...n,tagKey:t,operator:s?n.operator:c,value:i===a?n.value:``})},children:[r.length>0&&(0,K.jsx)(J,{children:`Numeric`}),r.map(e=>(0,K.jsx)(a,{value:e.key,children:e.label},e.key)),i.length>0&&(0,K.jsx)(J,{children:`Text`}),i.map(e=>(0,K.jsx)(a,{value:e.key,children:e.label},e.key))]})]}),(0,K.jsxs)(l,{size:`small`,sx:{minWidth:90,flex:0},children:[(0,K.jsx)(t,{children:`Op`}),(0,K.jsx)(s,{value:n.operator,label:`Op`,onChange:e=>{o({...n,operator:e.target.value})},children:p.map(e=>(0,K.jsx)(a,{value:e.value,children:e.label},e.value))})]}),(0,K.jsx)(et,{size:`small`,freeSolo:!0,options:m,loading:g,value:n.value||null,inputValue:n.value,onInputChange:(e,t)=>{o({...n,value:t})},onChange:(e,t)=>{o({...n,value:t??``})},renderInput:e=>(0,K.jsx)(_,{...e,label:`Value`,type:f?`number`:`text`,inputProps:{...e.inputProps,...f?{step:`any`}:{}}}),sx:{flex:2,minWidth:160}}),(0,K.jsx)(v,{title:`Remove rule`,children:(0,K.jsx)(E,{size:`small`,onClick:c,color:`error`,children:(0,K.jsx)(Te,{fontSize:`small`})})})]})}var wt=1;function Tt(){return{id:String(wt++),tagKey:``,operator:`=`,value:``}}function Et(e=`all`){return{id:String(wt++),logic:e,rules:[],groups:[]}}function Dt(e){let t=[],n=e.rules.filter(e=>e.tagKey&&e.value!==``).map(e=>`tag:${e.tagKey} ${e.operator} ${e.value}`);t.push(...n);for(let n of e.groups){let e=Dt(n);e&&t.push(`(${e})`)}let r=e.logic===`all`?` AND `:` OR `;return t.join(r)}function Ot({group:t,numericTags:n,stringTags:r,depth:i=0,onGroupChange:a,onRemove:o}){let s=i===0,[c,l]=(0,H.useState)(!1),u=t.rules.length>0||t.groups.length>0,d=()=>{a({...t,rules:[...t.rules,Tt()]})},f=(e,n)=>{a({...t,rules:t.rules.map((t,r)=>r===e?n:t)})},p=e=>{a({...t,rules:t.rules.filter((t,n)=>n!==e)})},m=(e,n)=>{n&&a({...t,logic:n})},h=(e,n)=>{a({...t,groups:t.groups.map((t,r)=>r===e?n:t)})},g=e=>{a({...t,groups:t.groups.filter((t,n)=>n!==e)})},_=()=>{let e=Et(t.logic);a({...t,groups:[...t.groups,e]})},y=()=>{u?l(!0):o&&o()},b=()=>{l(!1),o&&o()},x=()=>{l(!1)};return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(j,{sx:s?{}:{border:1,borderColor:`divider`,borderRadius:1,p:2,ml:2},children:(0,K.jsxs)(e,{spacing:1.5,children:[(0,K.jsxs)(e,{direction:`row`,spacing:2,alignItems:`center`,children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,children:s?`Match`:`Group match`}),(0,K.jsxs)(Z,{value:t.logic,exclusive:!0,onChange:m,size:`small`,children:[(0,K.jsx)(lt,{value:`all`,children:`ALL`}),(0,K.jsx)(lt,{value:`any`,children:`ANY`})]}),!s&&o&&(0,K.jsx)(v,{title:`Remove group`,children:(0,K.jsx)(E,{size:`small`,onClick:y,color:`error`,sx:{ml:`auto`},children:(0,K.jsx)(mt,{fontSize:`small`})})})]}),t.rules.map((e,t)=>(0,K.jsx)(Ct,{rule:e,numericTags:n,stringTags:r,onChange:e=>f(t,e),onRemove:()=>p(t)},e.id)),t.groups.map((e,t)=>(0,K.jsx)(Ot,{group:e,numericTags:n,stringTags:r,depth:i+1,onGroupChange:e=>h(t,e),onRemove:()=>g(t)},e.id)),(0,K.jsxs)(e,{direction:`row`,spacing:1,children:[(0,K.jsx)(N,{startIcon:(0,K.jsx)(we,{}),onClick:d,variant:`outlined`,size:`small`,children:`Add Rule`}),(0,K.jsx)(N,{startIcon:(0,K.jsx)(we,{}),onClick:_,variant:`outlined`,size:`small`,children:`Add Group`})]})]})}),(0,K.jsxs)(R,{open:c,onClose:x,children:[(0,K.jsx)(ye,{children:`Remove Group?`}),(0,K.jsx)(A,{children:(0,K.jsxs)(xe,{children:[`This group contains `,t.rules.length,` rule(s) and`,` `,t.groups.length,` nested group(s). Are you sure you want to remove it?`]})}),(0,K.jsxs)(ge,{children:[(0,K.jsx)(N,{onClick:x,children:`Cancel`}),(0,K.jsx)(N,{onClick:b,color:`error`,autoFocus:!0,children:`Remove`})]})]})]})}function kt({rootGroup:t,numericTags:n,stringTags:r,onGroupChange:i}){return(0,K.jsx)(e,{spacing:1.5,children:(0,K.jsx)(Ot,{group:t,numericTags:n,stringTags:r,depth:0,onGroupChange:i})})}var At=[{value:`title`,label:`Title`},{value:`artist`,label:`Artist`},{value:`album`,label:`Album`},{value:`path`,label:`Path`},{value:`random`,label:`Random`}];function jt(e){return e.startsWith(`-`)?{column:e.slice(1),descending:!0}:{column:e||`title`,descending:!1}}function Mt({value:n,onChange:r}){let{column:i,descending:o}=jt(n);return(0,K.jsxs)(e,{direction:`row`,spacing:1,alignItems:`center`,children:[(0,K.jsxs)(l,{size:`small`,sx:{minWidth:140},children:[(0,K.jsx)(t,{children:`Sort by`}),(0,K.jsx)(s,{value:i,label:`Sort by`,onChange:e=>{let t=e.target.value;r(o?`-${t}`:t)},children:At.map(e=>(0,K.jsx)(a,{value:e.value,children:e.label},e.value))})]}),i!==`random`&&(0,K.jsx)(v,{title:o?`Descending`:`Ascending`,children:(0,K.jsx)(E,{size:`small`,onClick:()=>{r(o?i:`-${i}`)},children:o?(0,K.jsx)(Q,{}):(0,K.jsx)(pt,{})})})]})}function Nt({rootGroup:t,name:n,comment:r,limit:i,sort:a,preview:o,content:s,loading:c,error:l,onGroupChange:u,onNameChange:d,onCommentChange:f,onLimitChange:p,onSortChange:m,onPreview:h,onGenerate:g}){let{numericTags:v,stringTags:y,loading:b}=$(),x=Dt(t),S=x.length>0;return(0,K.jsxs)(e,{spacing:2.5,children:[(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Smart Playlist Generator`}),(0,K.jsxs)(e,{spacing:2,children:[b?(0,K.jsxs)(j,{sx:{display:`flex`,flexDirection:`column`,alignItems:`center`,justifyContent:`center`,py:4,gap:2},children:[(0,K.jsx)(ne,{size:40}),(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,children:`Loading tag metadata…`})]}):(0,K.jsx)(kt,{rootGroup:t,numericTags:v,stringTags:y,onGroupChange:u}),x&&(0,K.jsx)(_,{value:x,label:`Generated query`,size:`small`,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.8rem`}}}}),(0,K.jsxs)(j,{children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Playlist Name *`}),(0,K.jsx)(_,{value:n,onChange:e=>d(e.target.value),disabled:c,required:!0,fullWidth:!0,size:`small`})]}),(0,K.jsxs)(j,{children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Comment`}),(0,K.jsx)(_,{value:r,onChange:e=>f(e.target.value),disabled:c,fullWidth:!0,size:`small`})]}),(0,K.jsxs)(e,{direction:`row`,spacing:2,alignItems:`flex-end`,children:[(0,K.jsxs)(j,{children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Sort`}),(0,K.jsx)(Mt,{value:a,onChange:m})]}),(0,K.jsxs)(j,{children:[(0,K.jsx)(B,{variant:`body2`,color:`text.secondary`,sx:{mb:.5,fontWeight:600},children:`Limit`}),(0,K.jsx)(_,{type:`number`,value:i??``,onChange:e=>p(e.target.value?parseInt(e.target.value):void 0),disabled:c,placeholder:`Optional`,size:`small`,sx:{width:120}})]})]}),(0,K.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,K.jsx)(N,{variant:`contained`,disabled:c||!S,onClick:h,fullWidth:!0,children:c?`Loading…`:`Preview Query`}),(0,K.jsx)(N,{variant:`contained`,disabled:c||!S,onClick:g,fullWidth:!0,children:c?`Generating…`:`Generate .nsp`})]})]}),l&&(0,K.jsxs)(ue,{children:[`Error: `,l]})]}),o&&(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Query Preview`}),(0,K.jsx)(bt,{data:o})]}),s&&(0,K.jsxs)(F,{children:[(0,K.jsx)(ve,{title:`Generated Playlist (.nsp)`}),(0,K.jsx)(_,{multiline:!0,rows:15,value:s,fullWidth:!0,slotProps:{input:{readOnly:!0,sx:{fontFamily:`monospace`,fontSize:`0.875rem`}}}}),(0,K.jsx)(N,{onClick:()=>{if(s){let e=new Blob([s],{type:`text/plain`}),t=URL.createObjectURL(e),r=document.createElement(`a`);r.href=t,r.download=`${n}.nsp`,r.click(),URL.revokeObjectURL(t)}},variant:`contained`,sx:{mt:1.25},children:`Download .nsp File`})]})]})}function Pt(){let{showError:e}=Ee(),[t,n]=(0,H.useState)(null),[r,i]=(0,H.useState)(null),[a,o]=(0,H.useState)(!1),[s,c]=(0,H.useState)(null),[l,u]=(0,H.useState)(()=>{let e=Et(`all`);return e.rules=[Tt()],e}),[d,f]=(0,H.useState)(`My Playlist`),[p,m]=(0,H.useState)(``),[h,g]=(0,H.useState)(void 0),[_,v]=(0,H.useState)(``),[y,b]=(0,H.useState)(null),[x,S]=(0,H.useState)(null),[C,w]=(0,H.useState)(!1),[ee,te]=(0,H.useState)(null);return{configPreview:t,configText:r,configLoading:a,configError:s,playlistRootGroup:l,playlistName:d,playlistComment:p,playlistLimit:h,playlistSort:_,playlistPreview:y,playlistContent:x,playlistLoading:C,playlistError:ee,loadConfigPreview:async()=>{try{o(!0),c(null),n((await be()).tags)}catch(e){c(e instanceof Error?e.message:`Failed to load preview`)}finally{o(!1)}},generateConfig:async()=>{try{o(!0),c(null),i((await _e()).config)}catch(e){c(e instanceof Error?e.message:`Failed to generate config`)}finally{o(!1)}},previewPlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}try{w(!0),te(null),b(await P(t,10))}catch(e){te(e instanceof Error?e.message:`Failed to preview playlist`)}finally{w(!1)}},generatePlaylist:async()=>{let t=Dt(l);if(!t.trim()){e(`Add at least one complete rule`);return}if(!d.trim()){e(`Playlist name is required`);return}try{w(!0),te(null),S((await I({query:t,playlist_name:d,comment:p,limit:h,sort:_||void 0})).content)}catch(e){te(e instanceof Error?e.message:`Failed to generate playlist`)}finally{w(!1)}},setPlaylistRootGroup:u,setPlaylistName:f,setPlaylistComment:m,setPlaylistLimit:g,setPlaylistSort:v}}function Ft(){let{configPreview:t,configText:n,configLoading:r,configError:i,playlistRootGroup:a,playlistName:o,playlistComment:s,playlistLimit:c,playlistSort:l,playlistPreview:d,playlistContent:h,playlistLoading:g,playlistError:_,loadConfigPreview:v,generateConfig:y,previewPlaylist:b,generatePlaylist:x,setPlaylistRootGroup:S,setPlaylistName:C,setPlaylistComment:w,setPlaylistLimit:ee,setPlaylistSort:te}=Pt();return(0,K.jsx)(de,{title:`Navidrome`,children:(0,K.jsxs)(e,{spacing:2,children:[(0,K.jsxs)(p,{defaultExpanded:!0,disableGutters:!0,children:[(0,K.jsx)(m,{expandIcon:(0,K.jsx)(u,{}),children:(0,K.jsx)(B,{variant:`h6`,sx:{fontWeight:600},children:`Generate Config`})}),(0,K.jsx)(f,{children:(0,K.jsx)(ht,{preview:t,configText:n,loading:r,error:i,onLoadPreview:v,onGenerateConfig:y})})]}),(0,K.jsxs)(p,{disableGutters:!0,children:[(0,K.jsx)(m,{expandIcon:(0,K.jsx)(u,{}),children:(0,K.jsx)(B,{variant:`h6`,sx:{fontWeight:600},children:`Playlist Maker`})}),(0,K.jsx)(f,{children:(0,K.jsx)(Nt,{rootGroup:a,name:o,comment:s,limit:c,sort:l,preview:d,content:h,loading:g,error:_,onGroupChange:S,onNameChange:C,onCommentChange:w,onLimitChange:ee,onSortChange:te,onPreview:b,onGenerate:x})})]})]})})}export{Ft as NavidromePage};