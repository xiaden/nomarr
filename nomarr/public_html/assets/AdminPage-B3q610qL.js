import{t as e}from"./Stack-DoLtnbcQ.js";import{i as t,o as n,r,t as i}from"./Select-B5bVQCV0.js";import{t as a}from"./TextField-Bs2H1HgS.js";import{a as o,i as s,n as c,r as l,t as u}from"./TableRow-tyIFvJAE.js";import{E as d,Et as f,Gn as p,Mn as m,Nt as h,T as g,Un as _,Z as v,bt as y,ct as b,et as x,kt as S,lt as C,rt as w,wt as T,xt as E}from"./index-D3CBCd4e.js";import"./useConfirmDialog-Bbgm_gYn.js";import"./ServerFilePicker-s29CDuSq.js";import{i as D,n as O,r as k,t as A}from"./useAdminActions-7vLuMe2-.js";import"./useNotification-BfaSfgIA.js";var j=p(_(),1),M=p(m(),1),N=[`discogs_effnet`,`discogs_musicnn`];function P(){let[p,m]=(0,j.useState)(null),[_,x]=(0,j.useState)(!1),[w,D]=(0,j.useState)(null),[O,k]=(0,j.useState)(N[0]),[A,P]=(0,j.useState)(``),[F,I]=(0,j.useState)(!1),[L,R]=(0,j.useState)(null),[z,B]=(0,j.useState)(null),V=(0,j.useCallback)(async()=>{x(!0),D(null);try{m((await g()).stats)}catch(e){e instanceof v?D(`API Error (${e.status}): ${e.message}`):e instanceof Error?D(e.message):D(`Unknown error`)}finally{x(!1)}},[]);(0,j.useEffect)(()=>{V()},[V]);let H=(0,j.useCallback)(async()=>{I(!0),B(null),R(null);try{R((await d(O,A?parseInt(A,10):null)).message),V()}catch(e){e instanceof v?B(`API Error (${e.status}): ${e.message}`):e instanceof Error?B(e.message):B(`Unknown error`)}finally{I(!1)}},[O,A,V]);return(0,M.jsxs)(C,{children:[(0,M.jsx)(b,{title:`Vector Store`}),(0,M.jsxs)(e,{spacing:3,children:[(0,M.jsxs)(E,{children:[(0,M.jsxs)(E,{sx:{display:`flex`,alignItems:`center`,justifyContent:`space-between`,mb:1},children:[(0,M.jsx)(T,{variant:`subtitle2`,children:`Hot/Cold Stats`}),(0,M.jsx)(y,{size:`small`,onClick:()=>void V(),disabled:_,children:_?(0,M.jsx)(S,{size:16}):`Refresh`})]}),w&&(0,M.jsx)(f,{severity:`error`,sx:{mb:1},children:w}),p&&(0,M.jsx)(h,{variant:`outlined`,children:(0,M.jsxs)(o,{size:`small`,children:[(0,M.jsx)(c,{children:(0,M.jsxs)(u,{children:[(0,M.jsx)(l,{children:`Backbone`}),(0,M.jsx)(l,{align:`right`,children:`Hot`}),(0,M.jsx)(l,{align:`right`,children:`Cold`})]})}),(0,M.jsx)(s,{children:p.map(e=>(0,M.jsxs)(u,{children:[(0,M.jsx)(l,{children:e.backbone_id}),(0,M.jsx)(l,{align:`right`,children:e.hot_count}),(0,M.jsx)(l,{align:`right`,children:e.cold_count})]},e.backbone_id))})]})})]}),(0,M.jsxs)(E,{children:[(0,M.jsx)(T,{variant:`subtitle2`,gutterBottom:!0,children:`Promote Vectors`}),(0,M.jsxs)(e,{spacing:1.5,children:[(0,M.jsxs)(n,{fullWidth:!0,size:`small`,children:[(0,M.jsx)(t,{children:`Backbone`}),(0,M.jsx)(i,{value:O,label:`Backbone`,onChange:e=>k(e.target.value),children:N.map(e=>(0,M.jsx)(r,{value:e,children:e},e))})]}),(0,M.jsx)(a,{label:`HNSW nlists (optional)`,placeholder:`Auto-calculated if empty`,value:A,onChange:e=>P(e.target.value),size:`small`,fullWidth:!0,type:`number`,inputProps:{min:1},helperText:`Number of HNSW graph lists. Leave empty for auto.`}),(0,M.jsx)(y,{variant:`contained`,onClick:()=>void H(),disabled:F,children:F?(0,M.jsx)(S,{size:24}):`Promote & Rebuild`}),z&&(0,M.jsx)(f,{severity:`error`,children:z}),L&&(0,M.jsx)(f,{severity:`success`,children:L})]})]})]})]})}function F(){let{actionLoading:t,handlePauseWorker:n,handleResumeWorker:r,handleRestart:i,dialogState:a}=A();return(0,M.jsxs)(w,{title:`Admin`,children:[(0,M.jsxs)(e,{spacing:2.5,children:[(0,M.jsx)(O,{onPause:n,onResume:r,actionLoading:t}),(0,M.jsx)(k,{onRestart:i,actionLoading:t}),(0,M.jsx)(P,{}),(0,M.jsx)(D,{})]}),(0,M.jsx)(x,{open:a.isOpen,title:a.options.title,message:a.options.message,confirmLabel:a.options.confirmLabel,cancelLabel:a.options.cancelLabel,severity:a.options.severity,onConfirm:a.handleConfirm,onCancel:a.handleCancel})]})}export{F as AdminPage};