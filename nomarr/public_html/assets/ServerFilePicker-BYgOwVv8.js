import{A as e,Yt as t,an as n,in as r}from"./index-C-W2loPz.js";var i=n(r(),1),a=n(t(),1);function o({value:t,onChange:n,mode:r=`directory`,label:o,libraryRoot:s}){let c=r??`directory`,[l,u]=(0,i.useState)(``),[d,f]=(0,i.useState)([]),[p,m]=(0,i.useState)(!1),[h,g]=(0,i.useState)(null),_=(0,i.useCallback)(async t=>{m(!0),g(null);try{f((await e(s?t?`${s}/${t}`:s:t||void 0)).entries)}catch(e){g(e instanceof Error?e.message:`Failed to load directory`),f([])}finally{m(!1)}},[s]);(0,i.useEffect)(()=>{_(l)},[l,_]);let v=e=>{u(l?`${l}/${e}`:e)},y=e=>{u(l.split(`/`).filter(e=>e).slice(0,e+1).join(`/`))},b=()=>{u(``)},x=e=>{e.is_dir?v(e.name):(c===`file`||c===`either`)&&n(l?`${l}/${e.name}`:e.name)},S=()=>{(c===`directory`||c===`either`)&&n(l)},C=e=>e.is_dir?!1:c===`file`||c===`either`,w=l.split(`/`).filter(e=>e);return(0,a.jsxs)(`div`,{className:`server-file-picker`,children:[o&&(0,a.jsx)(`label`,{className:`picker-label`,children:o}),(0,a.jsxs)(`div`,{className:`breadcrumbs`,children:[(0,a.jsx)(`button`,{type:`button`,className:`breadcrumb-item root`,onClick:b,children:`Library Root`}),w.map((e,t)=>(0,a.jsxs)(`span`,{children:[(0,a.jsx)(`span`,{className:`breadcrumb-separator`,children:`/`}),(0,a.jsx)(`button`,{type:`button`,className:`breadcrumb-item`,onClick:()=>y(t),children:e})]},t))]}),(0,a.jsxs)(`div`,{className:`current-path`,children:[(0,a.jsx)(`strong`,{children:`Current:`}),` /`,l||``]}),(c===`directory`||c===`either`)&&(0,a.jsx)(`div`,{className:`select-current`,children:(0,a.jsx)(`button`,{type:`button`,className:`btn-select-current`,onClick:S,children:`Select This Folder`})}),p&&(0,a.jsx)(`div`,{className:`loading`,children:`Loading...`}),h&&(0,a.jsx)(`div`,{className:`error`,children:h}),!p&&!h&&d.length===0&&(0,a.jsx)(`div`,{className:`empty`,children:`Empty directory`}),!p&&!h&&d.length>0&&(0,a.jsx)(`ul`,{className:`entries-list`,children:d.map((e,n)=>{let r=C(e),i=t&&t===(l?`${l}/${e.name}`:e.name);return(0,a.jsx)(`li`,{className:`entry-item`,children:(0,a.jsxs)(`button`,{type:`button`,className:`entry-button ${e.is_dir?`directory`:`file`} ${r?`selectable`:`non-selectable`} ${i?`selected`:``}`,onClick:()=>x(e),disabled:!e.is_dir&&!r,children:[(0,a.jsx)(`span`,{className:`entry-icon`,children:e.is_dir?`ğŸ“`:`ğŸµ`}),(0,a.jsx)(`span`,{className:`entry-name`,children:e.name})]})},n)})}),(0,a.jsxs)(`div`,{className:`selected-value`,children:[(0,a.jsx)(`strong`,{children:`Selected:`}),` `,t||`(none)`]})]})}export{o as t};