import{t as e}from"./Stack-Dim16oqk.js";import{t}from"./TextField-kQM7w0kf.js";import"./Portal-CrR8uJ5p.js";import{t as n}from"./TableCell-DGEM9WnX.js";import{i as r,n as i,r as a,t as o}from"./TableRow-DeZanKwc.js";import{It as s,Rt as c,St as l,_ as u,a as d,b as f,f as p,n as m,o as h,p as g,v as _}from"./index-CuL7d4Y7.js";import{t as v}from"./ServerFilePicker-BdUNtZff.js";var y=c(s(),1),b=c(l(),1);function x(){let[s,c]=(0,y.useState)(``),[l,x]=(0,y.useState)(null),[S,C]=(0,y.useState)(!1),[w,T]=(0,y.useState)(null),[E,D]=(0,y.useState)(!1),[O,k]=(0,y.useState)(!1),[A,j]=(0,y.useState)(null),M=async e=>{if(e.preventDefault(),s.trim())try{C(!0),T(null),j(null),x(await m.tags.showTags(s))}catch(e){T(e instanceof Error?e.message:`Failed to load tags`),x(null),console.error(`[Inspect] Load error:`,e)}finally{C(!1)}},N=async()=>{if(s.trim()&&confirm(`Remove all tags from ${s}?\n\nThis cannot be undone!`))try{k(!0),T(null),j(null);let e=await m.tags.removeTags(s);j(`Removed ${e.removed} tag(s) from ${e.path}`),x(await m.tags.showTags(s))}catch(e){T(e instanceof Error?e.message:`Failed to remove tags`),console.error(`[Inspect] Remove error:`,e)}finally{k(!1)}},P=e=>Array.isArray(e)?e.join(`, `):String(e);return(0,b.jsxs)(h,{title:`Inspect Tags`,children:[(0,b.jsxs)(g,{children:[(0,b.jsx)(p,{title:`File Path`}),(0,b.jsx)(_,{component:`form`,onSubmit:M,children:(0,b.jsxs)(e,{direction:`row`,spacing:1.25,children:[(0,b.jsx)(t,{value:s,onChange:e=>c(e.target.value),placeholder:`Enter relative path to audio file`,disabled:S,fullWidth:!0}),(0,b.jsx)(u,{onClick:()=>D(!E),variant:`outlined`,disabled:S,sx:{minWidth:100},children:E?`Hide`:`Browse...`}),(0,b.jsx)(u,{type:`submit`,variant:`contained`,disabled:S||!s.trim(),sx:{minWidth:100},children:S?`Loading...`:`Inspect`})]})}),E&&(0,b.jsx)(_,{sx:{mt:2},children:(0,b.jsx)(v,{value:s,onChange:e=>{c(e),D(!1)},mode:`file`,label:`Select Audio File`})})]}),w&&(0,b.jsx)(g,{children:(0,b.jsxs)(d,{children:[`Error: `,w]})}),A&&(0,b.jsx)(g,{children:(0,b.jsx)(f,{color:`primary`,children:A})}),l&&(0,b.jsxs)(e,{spacing:2.5,children:[(0,b.jsxs)(g,{children:[(0,b.jsx)(p,{title:`File Metadata`,action:l.count>0?(0,b.jsx)(u,{onClick:N,disabled:O,variant:`contained`,color:`error`,size:`small`,title:`Remove all tags from this file`,children:O?`Removing...`:`Remove All Tags`}):void 0}),(0,b.jsxs)(e,{spacing:1.25,children:[(0,b.jsxs)(_,{children:[(0,b.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Path:`}),(0,b.jsx)(f,{component:`span`,children:l.path})]}),(0,b.jsxs)(_,{children:[(0,b.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Namespace:`}),(0,b.jsx)(f,{component:`span`,children:l.namespace})]}),(0,b.jsxs)(_,{children:[(0,b.jsx)(f,{component:`span`,fontWeight:`bold`,color:`text.secondary`,sx:{mr:1.25},children:`Tag Count:`}),(0,b.jsx)(f,{component:`span`,children:l.count})]})]})]}),(0,b.jsxs)(g,{children:[(0,b.jsx)(p,{title:`Tags`}),l.count===0?(0,b.jsx)(f,{color:`text.secondary`,fontStyle:`italic`,children:`No tags found in this file.`}):(0,b.jsx)(_,{sx:{overflowX:`auto`},children:(0,b.jsxs)(r,{children:[(0,b.jsx)(i,{children:(0,b.jsxs)(o,{children:[(0,b.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Tag Key`}),(0,b.jsx)(n,{sx:{bgcolor:`background.default`,borderBottom:2},children:`Value`})]})}),(0,b.jsx)(a,{children:Object.entries(l.tags).map(([e,t])=>(0,b.jsxs)(o,{children:[(0,b.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:e}),(0,b.jsx)(n,{sx:{borderColor:`divider`,wordBreak:`break-word`},children:P(t)})]},e))})]})})]})]}),!l&&!w&&(0,b.jsx)(g,{children:(0,b.jsx)(f,{color:`text.secondary`,fontStyle:`italic`,children:`Enter a file path above to inspect its tags.`})})]})}export{x as InspectTagsPage};