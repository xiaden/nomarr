import{Dt as e,Et as t,_t as n,r}from"./index-BF2NrADo.js";async function i(e){let t=new URLSearchParams;e&&t.append(`path`,e);let n=t.toString();return r(n?`/api/web/fs/list?${n}`:`/api/web/fs/list`)}var a=e(t(),1),o=e(n(),1);function s({value:e,onChange:t,mode:n=`directory`,label:r,libraryRoot:s}){let c=n??`directory`,[l,u]=(0,a.useState)(``),[d,f]=(0,a.useState)([]),[p,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),_=(0,a.useCallback)(async e=>{m(!0),g(null);try{f((await i(s?e?`${s}/${e}`:s:e||void 0)).entries)}catch(e){g(e instanceof Error?e.message:`Failed to load directory`),f([])}finally{m(!1)}},[s]);(0,a.useEffect)(()=>{_(l)},[l,_]);let v=e=>{u(l?`${l}/${e}`:e)},y=e=>{u(l.split(`/`).filter(e=>e).slice(0,e+1).join(`/`))},b=()=>{u(``)},x=e=>{e.is_dir?v(e.name):(c===`file`||c===`either`)&&t(l?`${l}/${e.name}`:e.name)},S=()=>{(c===`directory`||c===`either`)&&t(l)},C=e=>e.is_dir?!1:c===`file`||c===`either`,w=l.split(`/`).filter(e=>e);return(0,o.jsxs)(`div`,{className:`server-file-picker`,children:[r&&(0,o.jsx)(`label`,{className:`picker-label`,children:r}),(0,o.jsxs)(`div`,{className:`breadcrumbs`,children:[(0,o.jsx)(`button`,{type:`button`,className:`breadcrumb-item root`,onClick:b,children:`Library Root`}),w.map((e,t)=>(0,o.jsxs)(`span`,{children:[(0,o.jsx)(`span`,{className:`breadcrumb-separator`,children:`/`}),(0,o.jsx)(`button`,{type:`button`,className:`breadcrumb-item`,onClick:()=>y(t),children:e})]},t))]}),(0,o.jsxs)(`div`,{className:`current-path`,children:[(0,o.jsx)(`strong`,{children:`Current:`}),` /`,l||``]}),(c===`directory`||c===`either`)&&(0,o.jsx)(`div`,{className:`select-current`,children:(0,o.jsx)(`button`,{type:`button`,className:`btn-select-current`,onClick:S,children:`Select This Folder`})}),p&&(0,o.jsx)(`div`,{className:`loading`,children:`Loading...`}),h&&(0,o.jsx)(`div`,{className:`error`,children:h}),!p&&!h&&d.length===0&&(0,o.jsx)(`div`,{className:`empty`,children:`Empty directory`}),!p&&!h&&d.length>0&&(0,o.jsx)(`ul`,{className:`entries-list`,children:d.map((t,n)=>{let r=C(t),i=e&&e===(l?`${l}/${t.name}`:t.name);return(0,o.jsx)(`li`,{className:`entry-item`,children:(0,o.jsxs)(`button`,{type:`button`,className:`entry-button ${t.is_dir?`directory`:`file`} ${r?`selectable`:`non-selectable`} ${i?`selected`:``}`,onClick:()=>x(t),disabled:!t.is_dir&&!r,children:[(0,o.jsx)(`span`,{className:`entry-icon`,children:t.is_dir?`ğŸ“`:`ğŸµ`}),(0,o.jsx)(`span`,{className:`entry-name`,children:t.name})]})},n)})}),(0,o.jsxs)(`div`,{className:`selected-value`,children:[(0,o.jsx)(`strong`,{children:`Selected:`}),` `,e||`(none)`]})]})}export{s as t};