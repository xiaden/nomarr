[importlinter]
root_package = nomarr
include_external_packages = False

# Enforce layered architecture
# Rule: Lower layers cannot import from higher layers
# Architecture stack (top to bottom):
#   interfaces -> workflows -> services -> persistence
#   ml (isolated namespace, can be imported by workflows/services)
#   tagging (tag logic, can be imported by workflows)
#   helpers (shared utilities, can be imported by any layer)

[importlinter:contract:1]
name = Services cannot import from interfaces
type = forbidden
source_modules =
    nomarr.services
forbidden_modules =
    nomarr.interfaces

[importlinter:contract:2]
name = Workflows cannot import from services or interfaces
type = forbidden
source_modules =
    nomarr.workflows
forbidden_modules =
    nomarr.services
    nomarr.interfaces

[importlinter:contract:3]
name = Persistence layer cannot import from workflows, services, or interfaces
type = forbidden
source_modules =
    nomarr.persistence
forbidden_modules =
    nomarr.workflows
    nomarr.services
    nomarr.interfaces

[importlinter:contract:4]
name = ML namespace isolation
type = forbidden
source_modules =
    nomarr.ml
forbidden_modules =
    nomarr.services
    nomarr.interfaces
    nomarr.workflows

[importlinter:contract:5]
name = Interfaces should be thin (no business logic imports)
type = forbidden
source_modules =
    nomarr.interfaces
forbidden_modules =
    nomarr.workflows
    nomarr.persistence
    nomarr.ml
    nomarr.tagging
